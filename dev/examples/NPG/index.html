<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Learning a Control Policy · Lyceum</title><link rel="canonical" href="https://docs.lyceum.ml/dev/examples/NPG/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../example_howto/"><img src="../../assets/logo.png" alt="Lyceum logo"/></a><div class="docs-package-name"><span class="docs-autofit">Lyceum</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../humanoid/">Creating a MuJoCo Environment</a></li><li class="is-active"><a class="tocitem" href>Learning a Control Policy</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#The-Code-1"><span>The Code</span></a></li></ul></li><li><a class="tocitem" href="../visualize/">Using the Visualizer</a></li></ul></li><li><span class="tocitem">LyceumBase</span><ul><li><a class="tocitem" href="../../lyceumbase/abstractenvironment/">AbstractEnvironment</a></li></ul></li><li><span class="tocitem">LyceumAI</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lyceumai/algorithms/naturalpolicygradient/">Natural Policy Gradient</a></li><li><a class="tocitem" href="../../lyceumai/algorithms/mppi/">MPPI</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lyceumai/models/policies/">Policies</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Learning a Control Policy</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Learning a Control Policy</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/docs/src/examples/NPG.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Running examples locally</header><div class="admonition-body"><p>This example and more are also available as Julia scripts and Jupyter notebooks.</p><p>See <a href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/example_howto.md">the how-to page</a> for more information.</p></div></div><h1 id="Learning-a-Control-Policy-1"><a class="docs-heading-anchor" href="#Learning-a-Control-Policy-1">Learning a Control Policy</a><a class="docs-heading-anchor-permalink" href="#Learning-a-Control-Policy-1" title="Permalink"></a></h1><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>In this example we walk through the process of setting up an experiment that runs <a href="https://papers.nips.cc/paper/2073-a-natural-policy-gradient.pdf">Natural Policy Gradient</a> (or more recently <a href="https://arxiv.org/pdf/1703.02660.pdf">in this work</a>). This is an on-policy reinforcement learning method that is comparable to TRPO, PPO, and other policy gradient methods. See the documentation for <code>NaturalPolicyGradient</code> for full implementation details.</p><h2 id="The-Code-1"><a class="docs-heading-anchor" href="#The-Code-1">The Code</a><a class="docs-heading-anchor-permalink" href="#The-Code-1" title="Permalink"></a></h2><p>First, let&#39;s go head and grab all the dependencies:</p><pre><code class="language-julia">using LinearAlgebra, Random, Statistics # From Stdlib
using LyceumAI                          # For the NPG controller
using LyceumMuJoCo                      # For the Hopper environment
using Flux                              # For our neural networks needs
using UniversalLogger                   # For logging experiment data
using Plots                             # For plotting the results
using LyceumBase.Tools                  # Miscellaneous utilities</code></pre><p>We first instantiate a <code>HopperV2</code> environment to grab useful environment-specific values, such as the size of the observation and action vectors:</p><pre><code class="language-julia">env = LyceumMuJoCo.HopperV2();
dobs, dact = length(obsspace(env)), length(actionspace(env));</code></pre><p>We&#39;ll also seed the per-thread global RNGs:</p><pre><code class="language-julia">seed_threadrngs!(1)</code></pre><pre><code class="language-none">1-element Array{Random.MersenneTwister,1}:
 Random.MersenneTwister(UInt32[0x00000001], Random.DSFMT.DSFMT_state(Int32[1749029653, 1072851681, 1610647787, 1072862326, 1841712345, 1073426746, -198061126, 1073322060, -156153802, 1073567984  …  1977574422, 1073209915, 278919868, 1072835605, 1290372147, 18858467, 1815133874, -1716870370, 382, 0]), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], UInt128[0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000  …  0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000], 1002, 0)</code></pre><h3 id="Policy-Gradient-Components-1"><a class="docs-heading-anchor" href="#Policy-Gradient-Components-1">Policy Gradient Components</a><a class="docs-heading-anchor-permalink" href="#Policy-Gradient-Components-1" title="Permalink"></a></h3><p>Policy Gradient methods require a policy: a function that takes in the state/observations of the agent, and outputs an action i.e. <code>action = π(obs)</code>. In much of Deep RL, the policy takes the form of a neural network which can be built on top of the <a href="https://github.com/FluxML/Flux.jl">Flux.jl</a> library. We utilize a stochastic policy in this example. Specifically, our policy is represented as a multivariate Gaussian distribution of the form:</p><div>\[\pi(a | o) = \mathcal{N}(\mu_{\theta_1}(o), \Sigma_{\theta_2})\]</div><p>where <span>$\mu_{\theta_1}$</span> is a neural network, parameterized by <span>$\theta_1$</span>, that maps an observation to a mean action and <span>$\Sigma_{\theta_2}$</span> is a diagonal covariance matrix parameterized by <span>$\theta_2$</span>, the diagonal entries of the matrix. For <span>$\mu_{\theta_1}$</span> we utilize a 2-layer neural network, where each layer has a &quot;width&quot; of 32. We use tanh activations for each hidden layer and initialize the network weights with Glorot Uniform initializations. Rather than tracking <span>$\Sigma_{\theta_2}$</span> directly, we track the log standard deviations, which are easier to learn. We initialize <span>$\log \text{diag}(\Sigma_{\theta_2})$</span> as <code>zeros(dact)</code>, i.e. a <code>Vector</code> of length <code>dact</code>, initialized to 0. Both <span>$\theta_1$</span> and <span>$\theta_2$</span> are learned in this example. Note that <span>$\mu_{\theta_1}$</span> is a <em>state-dependent</em> mean while <span>$\Sigma_{\theta_2}$</span> is a <em>global</em> covariance.</p><pre><code class="language-julia">const policy = DiagGaussianPolicy(
    multilayer_perceptron(
        dobs,
        32,
        32,
        dact;
        σ = tanh,
        initb = Flux.glorot_uniform,
        initb_final = Flux.glorot_uniform,
        dtype = Float32,
    ),
    zeros(Float32, dact),
);</code></pre><p>This NPG implementation uses <a href="https://arxiv.org/pdf/1506.02438.pdf">Generalized Advantaged Estimation</a>, which requires an estimate of the value function, <code>value(state)</code>, which we represent using a 2-layer, feedforward neural network where each layer has a width of 128 and uses the ReLU activation function. The model weights are initialized using Glorot Uniform initialization as above.</p><pre><code class="language-julia">const value = multilayer_perceptron(
    dobs,
    128,
    128,
    1;
    σ = Flux.relu,
    initb = Flux.glorot_uniform,
    initb_final = Flux.glorot_uniform,
    dtype = Float32,
);</code></pre><p>Next, we set up the optimization pipeline for <code>value</code>. We use a mini-batch size of 64 and the <a href="https://arxiv.org/pdf/1412.6980.pdf">ADAM</a> optimizer. <code>FluxTrainer</code> is an iterator that loops on the model provided, performing a single step of gradient descent at each iteration. The result at each loop is passed to <code>stopcb</code> below, so you can quit after a number of epochs, convergence, or other criteria; here it&#39;s capped at two epochs. See the documentation for <code>FluxTrainer</code> for more information.</p><pre><code class="language-julia">valueloss(bl, X, Y) = Flux.mse(vec(bl(X)), vec(Y))
stopcb(x) = x.nepochs &gt; 2
const valuetrainer = FluxTrainer(
    optimiser = ADAM(1e-3),
    szbatch = 64,
    lossfn = valueloss,
    stopcb = stopcb
);</code></pre><p>The <code>NaturalPolicyGradient</code> iterator is a type that pre-allocates all necesary data structures and performs one gradient update to <code>policy</code> at each iteration. We first pass in a constructor that given <code>n</code> returns <code>n</code> instances of <code>LyceumMuJoCo.HopperV2</code>, all sharing the same <code>jlModel</code>, to allow <code>NaturalPolicyGradient</code> to allocate per-thread environments and enable performant, parallel sampling from <code>policy</code>. We then pass in the <code>policy</code>, <code>value</code>, and <code>valuetrainer</code> instances constructed above and override a few of the default <code>NaturalPolicyGradient</code> parameters: <code>gamma</code>, <code>gaelambda</code>, and <code>norm_step_size</code>. Finally, we set the max trajectory length <code>Hmax</code> and total number of samples per iteration, <code>N</code>. Under the hood, <code>NaturalPolicyGradient</code> will use approximately <code>div(N, Hmax)</code> threads to perform the sampling.</p><pre><code class="language-julia">const npg = NaturalPolicyGradient(
    n -&gt; tconstruct(LyceumMuJoCo.HopperV2, n),
    policy,
    value,
    valuetrainer;
    gamma = 0.995,
    gaelambda = 0.97,
    norm_step_size = 0.05,
    Hmax = 1000,
    N = 10240,
);</code></pre><h3 id="Running-Experiments-1"><a class="docs-heading-anchor" href="#Running-Experiments-1">Running Experiments</a><a class="docs-heading-anchor-permalink" href="#Running-Experiments-1" title="Permalink"></a></h3><p>Finally, let&#39;s spin on our iterator 200 times, plotting every 20 iterations. This lets us break out of the loop if certain conditions are met, or re-start training manually if needed. We of course wish to track results, so we create a <code>ULogger</code> and <code>Experiment</code> to which we can save data. We also have useful timing information displayed every 20 iterations to better understand the performance of our algorithm and identify any potential bottlenecks. Rather than iterating on <code>npg</code> at the global scope, we&#39;ll do it inside of a function to avoid the performance issues associated with global variables as discussed in the <a href="https://docs.julialang.org/en/v1/manual/performance-tips/">Julia performance tips</a>. Note, to keep the Markdown version of this tutorial readable, we skip the plots and performance statistics. To enable them, simply call <code>hopper_NPG(npg, true)</code>.</p><pre><code class="language-julia">function hopper_NPG(npg::NaturalPolicyGradient, plot::Bool)
    exper = Experiment(&quot;/tmp/hopper_example.jlso&quot;, overwrite = true)
    # Walks, talks, and acts like a Julia logger. See the UniversalLogger.jl docs for more info.
    lg = ULogger()
    for (i, state) in enumerate(npg)
        if i &gt; 200
            # serialize some stuff and quit
            exper[:policy] = npg.policy
            exper[:value] = npg.value
            exper[:etype] = LyceumMuJoCo.HopperV2
            exper[:meanstates] = state.meanbatch
            exper[:stocstates] = state.stocbatch
            break
        end

        # log everything in `state` except meanbatch and stocbatch
        push!(lg, :algstate, filter_nt(state, exclude = (:meanbatch, :stocbatch)))

        if plot &amp;&amp; mod(i, 20) == 0
            x = lg[:algstate]
            # The following are helper functions for plotting to the terminal.
            # The first plot displays the `geteval` function for our stochastic
            # and mean policy rollouts.
            display(expplot(
                Line(x[:stocterminal_eval], &quot;StocLastE&quot;),
                Line(x[:meanterminal_eval], &quot;MeanLastE&quot;),
                title = &quot;Evaluation Score, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))
            # While the second one similarly plots `getreward`.
            display(expplot(
                Line(x[:stoctraj_reward], &quot;StocR&quot;),
                Line(x[:meantraj_reward], &quot;MeanR&quot;),
                title = &quot;Reward, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))

            # The following are timing values for various parts of the Natural Policy Gradient
            # algorithm at the last iteration, useful for finding performance bottlenecks
            # in the algorithm.
            println(&quot;elapsed_sampled  = &quot;, state.elapsed_sampled)
            println(&quot;elapsed_gradll   = &quot;, state.elapsed_gradll)
            println(&quot;elapsed_vpg      = &quot;, state.elapsed_vpg)
            println(&quot;elapsed_cg       = &quot;, state.elapsed_cg)
            println(&quot;elapsed_valuefit = &quot;, state.elapsed_valuefit)
        end
    end
    exper, lg
end
exper, lg = hopper_NPG(npg, false);</code></pre><p>Let&#39;s go ahead and plot the final reward trajectory for our stochastic and mean policies to see how we did:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_reward] lg[:algstate][:stoctraj_reward]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Reward&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip3500">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip3500)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip3501">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip3500)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip3502">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1504.1 2352.76,1504.1 
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1050.35 2352.76,1050.35 
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,596.608 2352.76,596.608 
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,142.864 2352.76,142.864 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1504.1 114.181,1504.1 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1050.35 114.181,1050.35 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,596.608 114.181,596.608 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,142.864 114.181,142.864 
  "/>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1521.6)" x="62.9921" y="1521.6">0</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1067.85)" x="62.9921" y="1067.85">1000</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 614.108)" x="62.9921" y="614.108">2000</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 160.364)" x="62.9921" y="160.364">3000</text>
</g>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Reward</text>
</g>
<polyline clip-path="url(#clip3502)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1478.23 172.6,1471.45 183.341,1468.65 194.083,1428.81 204.824,1412.2 215.565,1422.23 226.306,1412.26 237.048,1396.78 247.789,1383.41 
  258.53,1376.67 269.272,1370.18 280.013,1301.76 290.754,1352.98 301.495,1362.95 312.237,1389.53 322.978,1393.89 333.719,1389.75 344.46,1385.04 355.202,1332.58 
  365.943,1053.33 376.684,942.707 387.425,937.463 398.167,1388.69 408.908,1388.01 419.649,1397.08 430.391,1392.23 441.132,1390.39 451.873,1387.35 462.614,1388.02 
  473.356,1258.5 484.097,1278.29 494.838,1450.14 505.579,441.176 516.321,959.904 527.062,821.994 537.803,1088.11 548.545,420.428 559.286,384.548 570.027,351.106 
  580.768,276.937 591.51,297.306 602.251,296.993 612.992,286.497 623.733,267.327 634.475,267.292 645.216,278.14 655.957,258.443 666.699,233.243 677.44,228.213 
  688.181,175.946 698.922,130.861 709.664,135.66 720.405,193.815 731.146,209.146 741.887,197.985 752.629,194.704 763.37,193.83 774.111,189.547 784.853,197.42 
  795.594,206.342 806.335,191.593 817.076,169.038 827.818,200.651 838.559,161.905 849.3,1446.39 860.041,159.623 870.783,187.009 881.524,224.742 892.265,210.211 
  903.007,230.37 913.748,301.463 924.489,326.954 935.23,375.394 945.972,348.681 956.713,348.108 967.454,360.589 978.195,1444.6 988.937,358.677 999.678,349.43 
  1010.42,371.26 1021.16,451.131 1031.9,473.641 1042.64,490.62 1053.38,486.793 1064.13,488.79 1074.87,475.762 1085.61,455.542 1096.35,443.659 1107.09,457.454 
  1117.83,456.086 1128.57,424.578 1139.31,417.822 1150.06,399.81 1160.8,394.455 1171.54,434.677 1182.28,402.892 1193.02,386.084 1203.76,401.31 1214.5,412.623 
  1225.24,410.283 1235.99,404.053 1246.73,387.116 1257.47,373.758 1268.21,343.484 1278.95,358.664 1289.69,370.826 1300.43,364.321 1311.17,377.26 1321.92,410.812 
  1332.66,1063.86 1343.4,358.253 1354.14,359.935 1364.88,848.04 1375.62,363.388 1386.36,360.237 1397.1,357.592 1407.85,369.328 1418.59,362.758 1429.33,346.456 
  1440.07,326.835 1450.81,332.805 1461.55,364.611 1472.29,360.054 1483.04,376.267 1493.78,356.203 1504.52,337.161 1515.26,359.653 1526,371.945 1536.74,359.626 
  1547.48,347.023 1558.22,346.565 1568.97,324.761 1579.71,326.577 1590.45,309.948 1601.19,306.924 1611.93,302.128 1622.67,296.382 1633.41,287.057 1644.15,260.878 
  1654.9,247.201 1665.64,245.729 1676.38,229.209 1687.12,571.125 1697.86,245.701 1708.6,226.535 1719.34,499.442 1730.08,201.866 1740.83,203.123 1751.57,209.046 
  1762.31,231.722 1773.05,235.474 1783.79,239.295 1794.53,253.287 1805.27,257.425 1816.01,252.172 1826.76,277.007 1837.5,286.899 1848.24,268.515 1858.98,266.838 
  1869.72,246.556 1880.46,267.905 1891.2,254.284 1901.94,1187.09 1912.69,1341.98 1923.43,1102.99 1934.17,509.864 1944.91,173.372 1955.65,170.324 1966.39,227.504 
  1977.13,175.475 1987.87,1168.58 1998.62,210.771 2009.36,191.559 2020.1,172.96 2030.84,181.863 2041.58,157.215 2052.32,141.075 2063.06,140.243 2073.81,151.122 
  2084.55,110.931 2095.29,128.321 2106.03,143.52 2116.77,117.474 2127.51,136.959 2138.25,159.1 2148.99,104.257 2159.74,118.835 2170.48,140.107 2181.22,119.1 
  2191.96,136.961 2202.7,140.81 2213.44,712.878 2224.18,169.612 2234.92,145.844 2245.67,149.432 2256.41,164.052 2267.15,166.389 2277.89,169.652 2288.63,133.739 
  
  "/>
<polyline clip-path="url(#clip3502)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.61 161.859,1477.55 172.6,1474.83 183.341,1469.35 194.083,1460.6 204.824,1444.55 215.565,1433.24 226.306,1421.2 237.048,1411.77 247.789,1395.17 
  258.53,1390.05 269.272,1393.74 280.013,1372.91 290.754,1363.11 301.495,1358.77 312.237,1351.97 322.978,1363.93 333.719,1341.86 344.46,1322.68 355.202,1289.13 
  365.943,1273.83 376.684,1237.22 387.425,1198.84 398.167,1126.69 408.908,1171.5 419.649,1120.4 430.391,1025.1 441.132,895.972 451.873,953.482 462.614,838.496 
  473.356,986.867 484.097,961.982 494.838,846.403 505.579,673.669 516.321,626.048 527.062,779.683 537.803,560.266 548.545,356.643 559.286,462.509 570.027,326.103 
  580.768,387.973 591.51,466.696 602.251,464.658 612.992,466.984 623.733,284.13 634.475,384.724 645.216,389.35 655.957,388.695 666.699,255.564 677.44,422.99 
  688.181,426.198 698.922,541.413 709.664,416.542 720.405,497.917 731.146,432.92 741.887,449.734 752.629,262.415 763.37,267.679 774.111,523.415 784.853,641.884 
  795.594,575.902 806.335,944.256 817.076,1086.2 827.818,1007.69 838.559,624.035 849.3,1149.73 860.041,943.1 870.783,580.086 881.524,417.624 892.265,432.066 
  903.007,637.177 913.748,671.402 924.489,558.002 935.23,693.211 945.972,965.097 956.713,954.205 967.454,963.793 978.195,1042.86 988.937,805.43 999.678,348.545 
  1010.42,482.358 1021.16,649.384 1031.9,657.648 1042.64,444.598 1053.38,542.492 1064.13,459.716 1074.87,525.32 1085.61,593.156 1096.35,511.566 1107.09,509.624 
  1117.83,422.884 1128.57,535.272 1139.31,678.734 1150.06,609.124 1160.8,599.59 1171.54,441.776 1182.28,509.452 1193.02,511.953 1203.76,432.182 1214.5,525.15 
  1225.24,524.37 1235.99,527.358 1246.73,409.176 1257.47,498.026 1268.21,569.129 1278.95,391.645 1289.69,412.932 1300.43,391.034 1311.17,400.995 1321.92,576.985 
  1332.66,511.114 1343.4,393.729 1354.14,493.943 1364.88,706.659 1375.62,703.107 1386.36,808.035 1397.1,568.084 1407.85,487.822 1418.59,702.734 1429.33,644.822 
  1440.07,476.02 1450.81,698.321 1461.55,478.591 1472.29,640.165 1483.04,654.92 1493.78,395.683 1504.52,392.624 1515.26,390.51 1526,388.098 1536.74,395.559 
  1547.48,388.699 1558.22,382.768 1568.97,386.54 1579.71,377.951 1590.45,365.316 1601.19,373.347 1611.93,359.688 1622.67,350.682 1633.41,341.673 1644.15,331.871 
  1654.9,320.53 1665.64,302.901 1676.38,366.663 1687.12,296.304 1697.86,301.634 1708.6,464.36 1719.34,444.412 1730.08,287.438 1740.83,281.233 1751.57,283.634 
  1762.31,282.014 1773.05,286.941 1783.79,290.11 1794.53,309.249 1805.27,482.244 1816.01,393.02 1826.76,303.043 1837.5,306.325 1848.24,281.132 1858.98,275.773 
  1869.72,275.062 1880.46,256.868 1891.2,453.715 1901.94,755.885 1912.69,832.047 1923.43,860.629 1934.17,969.06 1944.91,411.918 1955.65,575.032 1966.39,522.913 
  1977.13,780.537 1987.87,749.584 1998.62,642.408 2009.36,327.296 2020.1,331.453 2030.84,328.394 2041.58,221.434 2052.32,425.896 2063.06,684.501 2073.81,502.05 
  2084.55,412.743 2095.29,776.765 2106.03,317.988 2116.77,312.942 2127.51,489.505 2138.25,202.929 2148.99,566.176 2159.74,679.492 2170.48,318.305 2181.22,776.618 
  2191.96,570.897 2202.7,687.571 2213.44,823.458 2224.18,695.223 2234.92,428.104 2245.67,434.245 2256.41,239.008 2267.15,348.349 2277.89,348.287 2288.63,514.303 
  
  "/>
<path clip-path="url(#clip3500)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip3500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip3500)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip3500)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip3500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>We&#39;ll also plot the evaluations:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_eval] lg[:algstate][:stoctraj_eval]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Eval&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip4100">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip4100)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip4101">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip4100)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip4102">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1480.11 2352.76,1480.11 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1131.57 2352.76,1131.57 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,783.024 2352.76,783.024 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,434.481 2352.76,434.481 
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,85.9371 2352.76,85.9371 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1480.11 114.181,1480.11 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1131.57 114.181,1131.57 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,783.024 114.181,783.024 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,434.481 114.181,434.481 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,85.9371 114.181,85.9371 
  "/>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1497.61)" x="62.9921" y="1497.61">0</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1149.07)" x="62.9921" y="1149.07">2000</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 800.524)" x="62.9921" y="800.524">4000</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 451.981)" x="62.9921" y="451.981">6000</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 103.437)" x="62.9921" y="103.437">8000</text>
</g>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Eval</text>
</g>
<polyline clip-path="url(#clip4102)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1479.69 172.6,1479.45 183.341,1479.32 194.083,1475.79 204.824,1474.79 215.565,1475.39 226.306,1474.38 237.048,1472.73 247.789,1471.02 
  258.53,1469.48 269.272,1468.61 280.013,1447.98 290.754,1464.94 301.495,1466.42 312.237,1471.63 322.978,1472.23 333.719,1471.68 344.46,1470.62 355.202,1461.06 
  365.943,1311.91 376.684,1210.36 387.425,1252.73 398.167,1470.02 408.908,1470.44 419.649,1471.52 430.391,1470.79 441.132,1470.6 451.873,1470.14 462.614,1470.22 
  473.356,1432.87 484.097,1436.61 494.838,1461.32 505.579,559.668 516.321,1121.81 527.062,1015.19 537.803,1367.65 548.545,546.95 559.286,505.361 570.027,457.651 
  580.768,357.354 591.51,379.711 602.251,384.773 612.992,361.338 623.733,330.2 634.475,328.857 645.216,343.317 655.957,317.848 666.699,296.204 677.44,284.468 
  688.181,217.213 698.922,163.386 709.664,167.189 720.405,243.927 731.146,266.098 741.887,242.196 752.629,239.379 763.37,245.254 774.111,248.049 784.853,255.746 
  795.594,255.151 806.335,244.788 817.076,224.647 827.818,256.206 838.559,236.625 849.3,1477.89 860.041,220.294 870.783,262.741 881.524,316.276 892.265,285.914 
  903.007,307.399 913.748,398.714 924.489,425.834 935.23,498.212 945.972,436.684 956.713,436.92 967.454,458.505 978.195,1477.82 988.937,454.898 999.678,440.985 
  1010.42,469.661 1021.16,559.886 1031.9,595.407 1042.64,622.468 1053.38,613.462 1064.13,614.172 1074.87,595.252 1085.61,558.821 1096.35,547.357 1107.09,559.949 
  1117.83,567.97 1128.57,525.857 1139.31,507.576 1150.06,501.657 1160.8,492.008 1171.54,587.285 1182.28,541.124 1193.02,524.573 1203.76,560.998 1214.5,570.623 
  1225.24,571.441 1235.99,552.487 1246.73,517.697 1257.47,501.654 1268.21,436.599 1278.95,449.413 1289.69,499.925 1300.43,489.696 1311.17,514.942 1321.92,582.013 
  1332.66,1196.67 1343.4,480.161 1354.14,509.844 1364.88,1002.89 1375.62,522.036 1386.36,516.027 1397.1,503.326 1407.85,515.148 1418.59,499.881 1429.33,463.955 
  1440.07,451.783 1450.81,475.375 1461.55,508.415 1472.29,512.07 1483.04,533.518 1493.78,516.041 1504.52,451.919 1515.26,507.729 1526,530.658 1536.74,500.816 
  1547.48,487.496 1558.22,487.41 1568.97,454.254 1579.71,449.935 1590.45,425.951 1601.19,420.758 1611.93,408.91 1622.67,407.831 1633.41,391.773 1644.15,351.832 
  1654.9,330.416 1665.64,333.477 1676.38,315.76 1687.12,707.754 1697.86,338.366 1708.6,300.104 1719.34,624.19 1730.08,276.969 1740.83,268.587 1751.57,288.166 
  1762.31,307.843 1773.05,311.182 1783.79,312.604 1794.53,326.117 1805.27,334.048 1816.01,322.683 1826.76,374.129 1837.5,389.194 1848.24,358.82 1858.98,357.915 
  1869.72,313.964 1880.46,354.45 1891.2,343.808 1901.94,1252.84 1912.69,1412.4 1923.43,1189.68 1934.17,583.586 1944.91,222.458 1955.65,217.466 1966.39,337.486 
  1977.13,235.067 1987.87,1255.68 1998.62,300.956 2009.36,268.55 2020.1,235.343 2030.84,240.606 2041.58,210.266 2052.32,180.492 2063.06,193.254 2073.81,193.169 
  2084.55,118.683 2095.29,138.417 2106.03,161.737 2116.77,129.198 2127.51,170.154 2138.25,183.542 2148.99,104.257 2159.74,123.95 2170.48,147.241 2181.22,123.144 
  2191.96,146.953 2202.7,155.756 2213.44,800.501 2224.18,179.385 2234.92,154.791 2245.67,166.314 2256.41,185.676 2267.15,183.059 2277.89,185.89 2288.63,151.465 
  
  "/>
<polyline clip-path="url(#clip4102)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.69 161.859,1479.62 172.6,1479.53 183.341,1479.3 194.083,1478.6 204.824,1477.28 215.565,1476.29 226.306,1475.03 237.048,1473.83 247.789,1471.99 
  258.53,1471.3 269.272,1471.55 280.013,1468.7 290.754,1466.59 301.495,1465.32 312.237,1464.22 322.978,1466.98 333.719,1462.62 344.46,1457.68 355.202,1450.22 
  365.943,1443.99 376.684,1428.04 387.425,1413.55 398.167,1377.13 408.908,1380.73 419.649,1343.36 430.391,1278.04 441.132,1125.66 451.873,1197.32 462.614,1004.14 
  473.356,1184.15 484.097,1142.28 494.838,1013.47 505.579,842.782 516.321,883.948 527.062,1044.09 537.803,755.322 548.545,455.15 559.286,577.626 570.027,412.268 
  580.768,536.448 591.51,646.944 602.251,635.737 612.992,574.309 623.733,391.195 634.475,513.843 645.216,518.439 655.957,541.229 666.699,347.4 677.44,582.813 
  688.181,595.48 698.922,819.606 709.664,583.162 720.405,739.095 731.146,620.38 741.887,579.362 752.629,353.641 763.37,333.523 774.111,621.015 784.853,765.788 
  795.594,646.918 806.335,1017.07 817.076,1161.61 827.818,1167.91 838.559,756.6 849.3,1232.88 860.041,1073.09 870.783,662.443 881.524,589.719 892.265,589.671 
  903.007,763.006 913.748,765.18 924.489,672.728 935.23,797.231 945.972,1097.94 956.713,1117.1 967.454,1083.81 978.195,1125.09 988.937,904.958 999.678,445.531 
  1010.42,568.233 1021.16,766.819 1031.9,731.162 1042.64,563.73 1053.38,641.157 1064.13,603.27 1074.87,617.946 1085.61,724.185 1096.35,636.75 1107.09,642.436 
  1117.83,527.227 1128.57,681.961 1139.31,815.041 1150.06,731.121 1160.8,739.427 1171.54,572.211 1182.28,646.346 1193.02,691.36 1203.76,560.198 1214.5,665.656 
  1225.24,682.12 1235.99,663.215 1246.73,561.047 1257.47,662.415 1268.21,710.56 1278.95,488.525 1289.69,552.591 1300.43,524.895 1311.17,517.361 1321.92,709.497 
  1332.66,626.099 1343.4,503.05 1354.14,641.541 1364.88,841.02 1375.62,887.406 1386.36,996.439 1397.1,760.136 1407.85,607.666 1418.59,865.664 1429.33,792.159 
  1440.07,672.026 1450.81,864.418 1461.55,624.543 1472.29,805.908 1483.04,829.083 1493.78,539.653 1504.52,514.41 1515.26,508.602 1526,520.999 1536.74,523.921 
  1547.48,525.732 1558.22,509.639 1568.97,519.302 1579.71,495.199 1590.45,483.527 1601.19,495.519 1611.93,471.078 1622.67,464.775 1633.41,446.54 1644.15,431.943 
  1654.9,426.96 1665.64,414.515 1676.38,530.286 1687.12,389.778 1697.86,406.719 1708.6,577.848 1719.34,621.852 1730.08,374.894 1740.83,376.753 1751.57,378.983 
  1762.31,374.707 1773.05,407.518 1783.79,400.034 1794.53,410.788 1805.27,603.759 1816.01,456.724 1826.76,380.424 1837.5,390.474 1848.24,352.676 1858.98,345.576 
  1869.72,357.942 1880.46,324.081 1891.2,499.621 1901.94,826.042 1912.69,913.714 1923.43,913.013 1934.17,1039.46 1944.91,445.056 1955.65,677.701 1966.39,670.278 
  1977.13,891.084 1987.87,844.165 1998.62,739.994 2009.36,426.553 2020.1,434.036 2030.84,420.423 2041.58,281.109 2052.32,510.444 2063.06,772.086 2073.81,565.947 
  2084.55,457.695 2095.29,826.812 2106.03,340.17 2116.77,396.121 2127.51,592.05 2138.25,262.477 2148.99,657.209 2159.74,739.122 2170.48,376.901 2181.22,900.569 
  2191.96,655.334 2202.7,841.841 2213.44,882.274 2224.18,760.06 2234.92,504.465 2245.67,494.901 2256.41,297.042 2267.15,376.895 2277.89,422.264 2288.63,641.121 
  
  "/>
<path clip-path="url(#clip4100)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip4100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip4100)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip4100)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip4100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>Finally, we save the logged results to <code>exper</code> for later review:</p><pre><code class="language-julia">exper[:logs] = get(lg)
finish!(exper); # flushes everything to disk</code></pre><pre><code class="language-none">[ Info: Experiment saved to /tmp/hopper_example.jlso</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../humanoid/">« Creating a MuJoCo Environment</a><a class="docs-footer-nextpage" href="../visualize/">Using the Visualizer »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 23 January 2020 11:51">Thursday 23 January 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
