<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Learning a Control Policy · Lyceum</title><link rel="canonical" href="https://docs.lyceum.ml/dev/examples/NPG/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Lyceum</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../humanoid/">Creating a MuJoCo Environment</a></li><li class="is-active"><a class="tocitem" href>Learning a Control Policy</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#The-Code-1"><span>The Code</span></a></li></ul></li><li><a class="tocitem" href="../visualize/">Using the Visualizer</a></li></ul></li><li><span class="tocitem">LyceumBase</span><ul><li><a class="tocitem" href="../../lyceumbase/abstractenvironment/">AbstractEnvironment</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Learning a Control Policy</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Learning a Control Policy</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/docs/src/examples/NPG.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Running examples locally</header><div class="admonition-body"><p>This example and more are also available as Julia scripts and Jupyter notebooks.</p><p>See <a href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/example_howto.md">the how-to page</a> for more information.</p></div></div><h1 id="Learning-a-Control-Policy-1"><a class="docs-heading-anchor" href="#Learning-a-Control-Policy-1">Learning a Control Policy</a><a class="docs-heading-anchor-permalink" href="#Learning-a-Control-Policy-1" title="Permalink"></a></h1><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>In this example we walk through the process of setting up an experiment that runs <a href="https://papers.nips.cc/paper/2073-a-natural-policy-gradient.pdf">Natural Policy Gradient</a> (or more recently <a href="https://arxiv.org/pdf/1703.02660.pdf">in this work</a>). This is an on-policy reinforcement learning method that is comparable to TRPO, PPO, and other policy gradient methods. See the documentation for <code>NaturalPolicyGradient</code> for full implementation details.</p><h2 id="The-Code-1"><a class="docs-heading-anchor" href="#The-Code-1">The Code</a><a class="docs-heading-anchor-permalink" href="#The-Code-1" title="Permalink"></a></h2><p>First, let&#39;s go head and grab all the dependencies:</p><pre><code class="language-julia">using LinearAlgebra, Random, Statistics # From Stdlib
using LyceumAI                          # For the NPG controller
using LyceumMuJoCo                      # For the Hopper environment
using LyceumBase.Tools                  # For the ControllerIterator discussed below
using Flux                              # For our neural networks needs
using UniversalLogger                   # For logging experiment data
using Plots                             # For plotting the results</code></pre><p>We first instantiate a <code>HopperV2</code> environment to grab useful environment-specific values, such as the size of the observation and action vectors:</p><pre><code class="language-julia">env = LyceumMuJoCo.HopperV2();
dobs, dact = length(obsspace(env)), length(actionspace(env));</code></pre><p>We&#39;ll also seed the per-thread global RNGs:</p><pre><code class="language-julia">seed_threadrngs!(1)</code></pre><pre><code class="language-none">1-element Array{Random.MersenneTwister,1}:
 Random.MersenneTwister(UInt32[0x00000001], Random.DSFMT.DSFMT_state(Int32[1749029653, 1072851681, 1610647787, 1072862326, 1841712345, 1073426746, -198061126, 1073322060, -156153802, 1073567984  …  1977574422, 1073209915, 278919868, 1072835605, 1290372147, 18858467, 1815133874, -1716870370, 382, 0]), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], UInt128[0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000  …  0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000], 1002, 0)</code></pre><h3 id="Policy-Gradient-Components-1"><a class="docs-heading-anchor" href="#Policy-Gradient-Components-1">Policy Gradient Components</a><a class="docs-heading-anchor-permalink" href="#Policy-Gradient-Components-1" title="Permalink"></a></h3><p>Policy Gradient methods require a policy: a function that takes in the state/observations of the agent, and outputs an action i.e. <code>action = π(obs)</code>. In much of Deep RL, the policy takes the form of a neural network which can be built on top of the <a href="https://github.com/FluxML/Flux.jl">Flux.jl</a> library. We utilize a stochastic policy in this example. Specifically, our policy is represented as a multivariate Gaussian distribution of the form:</p><div>\[\pi(a | s) = \mathcal{N}(\mu_{\theta_1}(\text{obs}), \Sigma_{\theta_2})\]</div><p>where <span>$\mu_{\theta_1}$</span> is a neural network, parameterized by <span>$\theta_1$</span>, that maps an observation <code>obs</code> to a mean action and <span>$\Sigma_{\theta_2}$</span> is a diagonal covariance matrix parameterized by <span>$\theta_2$</span>, the diagonal entries of the matrix. For <span>$\mu_{\theta_1}$</span> we utilize a 2-layer neural network, where each layer has a &quot;width&quot; of 32. We use tanh activations for each hidden layer and initialize the network weights with Glorot Uniform initializations. Rather than tracking <span>$\Sigma_{\theta_2}$</span> directly, we track the log standard deviations, which are easier to learn. We initialize <span>$\log \text{diag}(\Sigma_{\theta_2})$</span> as <code>zeros(dact)</code>, i.e. a <code>Vector</code> of length <code>dact</code>, initialized to 0. Both <span>$\theta_1$</span> and <span>$\theta_2$</span> are learned in this example. Note that <span>$\mu_{\theta_1}$</span> is a <em>state-dependent</em> mean while <span>$\Sigma_{\theta_2}$</span> is a <em>global</em> covariance.</p><pre><code class="language-julia">const policy = DiagGaussianPolicy(
    multilayer_perceptron(
        dobs,
        32,
        32,
        dact;
        σ = tanh,
        initb = Flux.glorot_uniform,
        initb_final = Flux.glorot_uniform,
        dtype = Float32,
    ),
    zeros(Float32, dact),
);</code></pre><p>This NPG implementation uses <a href="https://arxiv.org/pdf/1506.02438.pdf">Generalized Advantaged Estimation</a>, which requires an estimate of the value function, <code>value(state)</code>, which we represent using a 2-layer, feedforward neural network where each layer has a width of 128 and uses the ReLU activation function. The model weights are initialized using Glorot Uniform initialization as above.</p><pre><code class="language-julia">const value = multilayer_perceptron(
    dobs,
    128,
    128,
    1;
    σ = Flux.relu,
    initb = Flux.glorot_uniform,
    initb_final = Flux.glorot_uniform,
    dtype = Float32,
);</code></pre><p>Next, we set up the optimization pipeline for <code>value</code>. We use a mini-batch size of 64 and the <a href="https://arxiv.org/pdf/1412.6980.pdf">ADAM</a> optimizer. <code>FluxTrainer</code> is an iterator that loops on the model provided, performing a single step of gradient descent at each iteration. The result at each loop is passed to <code>stopcb</code> below, so you can quit after a number of epochs, convergence, or other criteria; here it&#39;s capped at two epochs. See the documentation for <code>FluxTrainer</code> for more information.</p><pre><code class="language-julia">valueloss(bl, X, Y) = Flux.mse(vec(bl(X)), vec(Y))
stopcb(x) = x.nepochs &gt; 2
const valuetrainer = FluxTrainer(
    optimiser = ADAM(1e-3),
    szbatch = 64,
    lossfn = valueloss,
    stopcb = stopcb
);</code></pre><p>The <code>NaturalPolicyGradient</code> iterator is a type that pre-allocates all necesary data structures and performs one gradient update to <code>policy</code> at each iteration. We first pass in a constructor that given <code>n</code> returns <code>n</code> instances of <code>LyceumMuJoCo.HopperV2</code>, all sharing the same <code>jlModel</code>, to allow <code>NaturalPolicyGradient</code> to allocate per-thread environments and enable performant, parallel sampling from <code>policy</code>. We then pass in the <code>policy</code>, <code>value</code>, and <code>valuetrainer</code> instances constructed above and override a few of the default <code>NaturalPolicyGradient</code> parameters: <code>gamma</code>, <code>gaelambda</code>, and <code>norm_step_size</code>. Finally, we set the max trajectory length <code>Hmax</code> and total number of samples per iteration, <code>N</code>. Under the hood, <code>NaturalPolicyGradient</code> will use approximately <code>div(N, Hmax)</code> threads to perform the sampling.</p><pre><code class="language-julia">const npg = NaturalPolicyGradient(
    n -&gt; tconstruct(LyceumMuJoCo.HopperV2, n),
    policy,
    value,
    valuetrainer;
    gamma = 0.995,
    gaelambda = 0.97,
    norm_step_size = 0.05,
    Hmax = 1000,
    N = 10240,
);</code></pre><h3 id="Running-Experiments-1"><a class="docs-heading-anchor" href="#Running-Experiments-1">Running Experiments</a><a class="docs-heading-anchor-permalink" href="#Running-Experiments-1" title="Permalink"></a></h3><p>Finally, let&#39;s spin on our iterator 200 times, plotting every 20 iterations. This lets us break out of the loop if certain conditions are met, or re-start training manually if needed. We of course wish to track results, so we create a <code>ULogger</code> and <code>Experiment</code> to which we can save data. We also have useful timing information displayed every 20 iterations to better understand the performance of our algorithm and identify any potential bottlenecks. Rather than iterating on <code>npg</code> at the global scope, we&#39;ll do it inside of a function to avoid the performance issues associated with global variables as discussed in the <a href="https://docs.julialang.org/en/v1/manual/performance-tips/">Julia performance tips</a>. Note, to keep the Markdown version of this tutorial readable, we skip the plots and performance statistics. To enable them, simply call <code>hopper_NPG(npg, true)</code>.</p><pre><code class="language-julia">function hopper_NPG(npg::NaturalPolicyGradient, plot::Bool)
    exper = Experiment(&quot;/tmp/hopper_example.jlso&quot;, overwrite = true)
    # Walks, talks, and acts like a Julia logger. See the UniversalLogger.jl docs for more info.
    lg = ULogger()
    for (i, state) in enumerate(npg)
        if i &gt; 200
            # serialize some stuff and quit
            exper[:policy] = npg.policy
            exper[:value] = npg.value
            exper[:etype] = LyceumMuJoCo.HopperV2
            exper[:meanstates] = state.meanbatch
            exper[:stocstates] = state.stocbatch
            break
        end

        # log everything in `state` except meanbatch and stocbatch
        push!(lg, :algstate, filter_nt(state, exclude = (:meanbatch, :stocbatch)))

        if plot &amp;&amp; mod(i, 20) == 0
            x = lg[:algstate]
            # The following are helper functions for plotting to the terminal.
            # The first plot displays the `geteval` function for our stochastic
            # and mean policy rollouts.
            display(expplot(
                Line(x[:stocterminal_eval], &quot;StocLastE&quot;),
                Line(x[:meanterminal_eval], &quot;MeanLastE&quot;),
                title = &quot;Evaluation Score, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))
            # While the second one similarly plots `getreward`.
            display(expplot(
                Line(x[:stoctraj_reward], &quot;StocR&quot;),
                Line(x[:meantraj_reward], &quot;MeanR&quot;),
                title = &quot;Reward, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))

            # The following are timing values for various parts of the Natural Policy Gradient
            # algorithm at the last iteration, useful for finding performance bottlenecks
            # in the algorithm.
            println(&quot;elapsed_sampled  = &quot;, state.elapsed_sampled)
            println(&quot;elapsed_gradll   = &quot;, state.elapsed_gradll)
            println(&quot;elapsed_vpg      = &quot;, state.elapsed_vpg)
            println(&quot;elapsed_cg       = &quot;, state.elapsed_cg)
            println(&quot;elapsed_valuefit = &quot;, state.elapsed_valuefit)
        end
    end
    exper, lg
end
exper, lg = hopper_NPG(npg, false);</code></pre><p>Let&#39;s go ahead and plot the final reward trajectory for our stochastic and mean policies to see how we did:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_reward] lg[:algstate][:stoctraj_reward]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Reward&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip0400">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip0400)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0401">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip0400)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0402">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.41 2352.76,1505.41 
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1028.34 2352.76,1028.34 
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,551.273 2352.76,551.273 
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,74.2023 2352.76,74.2023 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.41 114.181,1505.41 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1028.34 114.181,1028.34 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,551.273 114.181,551.273 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,74.2023 114.181,74.2023 
  "/>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1522.91)" x="62.9921" y="1522.91">0</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1045.84)" x="62.9921" y="1045.84">1000</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 568.773)" x="62.9921" y="568.773">2000</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 91.7023)" x="62.9921" y="91.7023">3000</text>
</g>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Reward</text>
</g>
<polyline clip-path="url(#clip0402)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1476.78 172.6,1473.22 183.341,1470.16 194.083,1447.77 204.824,1447.01 215.565,1445.05 226.306,1416.93 237.048,1413.3 247.789,1413.75 
  258.53,1413.25 269.272,1406.56 280.013,1399.38 290.754,1401.26 301.495,1404.29 312.237,1403.89 322.978,1337.62 333.719,1307.52 344.46,1335.61 355.202,1371.04 
  365.943,1359.77 376.684,1221.8 387.425,1328.32 398.167,1210.36 408.908,1294.54 419.649,1281.36 430.391,1231.48 441.132,1180.4 451.873,1170.55 462.614,972.071 
  473.356,1086.1 484.097,1047.77 494.838,669.251 505.579,794.718 516.321,258.359 527.062,276.066 537.803,275.695 548.545,490.756 559.286,605.621 570.027,538.751 
  580.768,356.858 591.51,574.709 602.251,414.832 612.992,388.655 623.733,439.462 634.475,367.909 645.216,467.963 655.957,441.362 666.699,416.529 677.44,414.144 
  688.181,408.269 698.922,392.69 709.664,279.975 720.405,329.956 731.146,390.5 741.887,403.551 752.629,468.363 763.37,488.186 774.111,471.885 784.853,454.295 
  795.594,388.881 806.335,421.398 817.076,427.612 827.818,383.391 838.559,392.092 849.3,388.986 860.041,381.372 870.783,381.6 881.524,374.016 892.265,372.795 
  903.007,353.562 913.748,367.824 924.489,389.237 935.23,303.057 945.972,317.958 956.713,341.603 967.454,364.616 978.195,375.06 988.937,424.526 999.678,431.533 
  1010.42,450.922 1021.16,466.945 1031.9,436.648 1042.64,422.568 1053.38,434.486 1064.13,326.939 1074.87,328.766 1085.61,335.622 1096.35,348.46 1107.09,362.09 
  1117.83,371.453 1128.57,357.894 1139.31,340.287 1150.06,330.26 1160.8,314.738 1171.54,281.593 1182.28,289.684 1193.02,293.813 1203.76,340.358 1214.5,320.38 
  1225.24,357.092 1235.99,365.989 1246.73,345.954 1257.47,320.56 1268.21,286.988 1278.95,541.788 1289.69,317.861 1300.43,1069.23 1311.17,848.437 1321.92,288.365 
  1332.66,257.927 1343.4,241.415 1354.14,373.697 1364.88,521.898 1375.62,687.572 1386.36,690.563 1397.1,591.947 1407.85,280.228 1418.59,286.105 1429.33,286.493 
  1440.07,287.016 1450.81,297.805 1461.55,299.482 1472.29,291.379 1483.04,265.913 1493.78,834.84 1504.52,246.983 1515.26,253.346 1526,271.909 1536.74,281.662 
  1547.48,281.157 1558.22,272.044 1568.97,271.821 1579.71,256.441 1590.45,228.95 1601.19,203.918 1611.93,260.529 1622.67,198.756 1633.41,229.388 1644.15,235.689 
  1654.9,117.286 1665.64,216.93 1676.38,154.684 1687.12,146.952 1697.86,410.489 1708.6,219.929 1719.34,135.095 1730.08,199.321 1740.83,203.824 1751.57,214.277 
  1762.31,203.194 1773.05,236.262 1783.79,429.535 1794.53,497.859 1805.27,505.928 1816.01,497.121 1826.76,345.269 1837.5,424.13 1848.24,497.261 1858.98,554.601 
  1869.72,482.737 1880.46,498.85 1891.2,638.21 1901.94,686.117 1912.69,509.111 1923.43,244.459 1934.17,209.977 1944.91,261.78 1955.65,226.515 1966.39,291.74 
  1977.13,258.804 1987.87,263.731 1998.62,277.474 2009.36,328.778 2020.1,322.007 2030.84,287.766 2041.58,282.833 2052.32,444.04 2063.06,608.642 2073.81,449.105 
  2084.55,456.429 2095.29,373.676 2106.03,348.95 2116.77,155.786 2127.51,114.967 2138.25,213.351 2148.99,235.375 2159.74,279.784 2170.48,247.402 2181.22,210.424 
  2191.96,165.254 2202.7,135.749 2213.44,239.296 2224.18,141.894 2234.92,239.395 2245.67,173.259 2256.41,175.659 2267.15,155.72 2277.89,104.257 2288.63,255.18 
  
  "/>
<polyline clip-path="url(#clip0402)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1478.57 161.859,1477.13 172.6,1474.35 183.341,1465.11 194.083,1460.73 204.824,1453.2 215.565,1451.76 226.306,1440.52 237.048,1430.28 247.789,1423.83 
  258.53,1424.31 269.272,1416.91 280.013,1415.7 290.754,1408.07 301.495,1408.64 312.237,1399.38 322.978,1388.66 333.719,1386.39 344.46,1368.23 355.202,1369.2 
  365.943,1359.79 376.684,1337.32 387.425,1336.2 398.167,1312.29 408.908,1297.81 419.649,1309.64 430.391,1268.69 441.132,1218.08 451.873,1248.85 462.614,1221.74 
  473.356,1170.37 484.097,1127.7 494.838,1095.6 505.579,1082.84 516.321,1041.57 527.062,980.154 537.803,918.796 548.545,1005.53 559.286,885.907 570.027,815.592 
  580.768,890.691 591.51,947.521 602.251,860.744 612.992,865.051 623.733,905.592 634.475,914.501 645.216,504.434 655.957,678.698 666.699,582.97 677.44,710.028 
  688.181,621.918 698.922,612.037 709.664,833.545 720.405,767.896 731.146,595.888 741.887,608.584 752.629,609.477 763.37,507.196 774.111,501.287 784.853,571.585 
  795.594,805.797 806.335,635.912 817.076,676.217 827.818,619.743 838.559,457.155 849.3,523.357 860.041,628.791 870.783,381.934 881.524,546.24 892.265,929.718 
  903.007,459.262 913.748,311.901 924.489,407.871 935.23,503.549 945.972,411.573 956.713,384.027 967.454,265.043 978.195,308.161 988.937,369.729 999.678,374.91 
  1010.42,447.556 1021.16,387.386 1031.9,377.108 1042.64,362.024 1053.38,423.464 1064.13,290.867 1074.87,382.929 1085.61,436.505 1096.35,368.76 1107.09,394.178 
  1117.83,323.174 1128.57,328.016 1139.31,308.661 1150.06,303.333 1160.8,386.31 1171.54,239.023 1182.28,333.802 1193.02,270.775 1203.76,300.835 1214.5,472.044 
  1225.24,392.433 1235.99,502.214 1246.73,392.083 1257.47,321.031 1268.21,373.539 1278.95,375.462 1289.69,381.215 1300.43,394.553 1311.17,297.606 1321.92,396.715 
  1332.66,356.663 1343.4,449.856 1354.14,723.868 1364.88,768.104 1375.62,886.463 1386.36,694.381 1397.1,588.583 1407.85,520.248 1418.59,257.641 1429.33,266.64 
  1440.07,360.314 1450.81,245.569 1461.55,279.774 1472.29,607.226 1483.04,507.164 1493.78,743.676 1504.52,927.485 1515.26,342.577 1526,348.527 1536.74,335.238 
  1547.48,247.669 1558.22,251.763 1568.97,368.666 1579.71,329.933 1590.45,561.219 1601.19,286.939 1611.93,532.062 1622.67,300.354 1633.41,449.546 1644.15,585.989 
  1654.9,517.107 1665.64,276.792 1676.38,354.013 1687.12,535.254 1697.86,730.816 1708.6,648.305 1719.34,377.588 1730.08,396.48 1740.83,298.526 1751.57,206.133 
  1762.31,178.657 1773.05,368.06 1783.79,456.54 1794.53,451.233 1805.27,476.079 1816.01,358.755 1826.76,445.647 1837.5,367.571 1848.24,517.369 1858.98,572.531 
  1869.72,580.155 1880.46,743.043 1891.2,907.007 1901.94,747.274 1912.69,538.812 1923.43,563.725 1934.17,318.954 1944.91,273.225 1955.65,693.851 1966.39,287.344 
  1977.13,283.984 1987.87,536.316 1998.62,257.521 2009.36,413.117 2020.1,276.622 2030.84,283.206 2041.58,430.464 2052.32,560.806 2063.06,607.629 2073.81,485.964 
  2084.55,676.74 2095.29,556.357 2106.03,549.827 2116.77,324.908 2127.51,376.647 2138.25,302.101 2148.99,236.755 2159.74,381.617 2170.48,338.273 2181.22,290.324 
  2191.96,393.447 2202.7,388.629 2213.44,467.89 2224.18,545.897 2234.92,355.378 2245.67,421.021 2256.41,291.08 2267.15,308.584 2277.89,384.695 2288.63,531.622 
  
  "/>
<path clip-path="url(#clip0400)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip0400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip0400)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip0400)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip0400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>We&#39;ll also plot the evaluations:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_eval] lg[:algstate][:stoctraj_eval]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Eval&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip1000">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip1000)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip1001">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip1000)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip1002">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1480.18 2352.76,1480.18 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1274.62 2352.76,1274.62 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1069.05 2352.76,1069.05 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,863.491 2352.76,863.491 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,657.927 2352.76,657.927 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,452.363 2352.76,452.363 
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,246.799 2352.76,246.799 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1480.18 114.181,1480.18 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1274.62 114.181,1274.62 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1069.05 114.181,1069.05 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,863.491 114.181,863.491 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,657.927 114.181,657.927 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,452.363 114.181,452.363 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,246.799 114.181,246.799 
  "/>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1497.68)" x="62.9921" y="1497.68">0</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1292.12)" x="62.9921" y="1292.12">1000</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1086.55)" x="62.9921" y="1086.55">2000</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 880.991)" x="62.9921" y="880.991">3000</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 675.427)" x="62.9921" y="675.427">4000</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 469.863)" x="62.9921" y="469.863">5000</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 264.299)" x="62.9921" y="264.299">6000</text>
</g>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Eval</text>
</g>
<polyline clip-path="url(#clip1002)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1479.62 172.6,1479.46 183.341,1479.32 194.083,1478 204.824,1477.98 215.565,1477.96 226.306,1475.39 237.048,1474.89 247.789,1475.02 
  258.53,1474.97 269.272,1473.27 280.013,1471.86 290.754,1472.21 301.495,1472.79 312.237,1473.11 322.978,1460.11 333.719,1455.3 344.46,1460.51 355.202,1466.26 
  365.943,1464.24 376.684,1428.2 387.425,1455.6 398.167,1423.41 408.908,1450.18 419.649,1445.27 430.391,1430.59 441.132,1412.51 451.873,1409.07 462.614,1304.3 
  473.356,1370.08 484.097,1336.64 494.838,769.841 505.579,1125.09 516.321,195.32 527.062,421.819 537.803,343.49 548.545,606.863 559.286,694.317 570.027,622.885 
  580.768,557.799 591.51,913.072 602.251,489.811 612.992,439.324 623.733,704.628 634.475,375.125 645.216,509.028 655.957,471.821 666.699,431.914 677.44,429.19 
  688.181,434.734 698.922,402.851 709.664,235.434 720.405,310.797 731.146,405.308 741.887,422.157 752.629,508.069 763.37,523.634 774.111,506.136 784.853,486.825 
  795.594,402.32 806.335,445.497 817.076,453.976 827.818,388.101 838.559,399.687 849.3,385.739 860.041,372.065 870.783,385.271 881.524,382.509 892.265,387.836 
  903.007,366.847 913.748,375.926 924.489,422.846 935.23,311.696 945.972,317.076 956.713,351.04 967.454,377.329 978.195,388.972 988.937,461.559 999.678,480.535 
  1010.42,496.414 1021.16,511.918 1031.9,469.896 1042.64,450.556 1053.38,457.4 1064.13,319.563 1074.87,317.503 1085.61,335.473 1096.35,357.85 1107.09,367.938 
  1117.83,386.801 1128.57,369.92 1139.31,341.783 1150.06,315.524 1160.8,295.5 1171.54,248.085 1182.28,274.778 1193.02,277.439 1203.76,350.875 1214.5,327.84 
  1225.24,384.565 1235.99,387.283 1246.73,382.835 1257.47,270.503 1268.21,219.245 1278.95,619.198 1289.69,348.943 1300.43,1266.73 1311.17,998.735 1321.92,259.283 
  1332.66,190.564 1343.4,186.264 1354.14,485.438 1364.88,736.13 1375.62,953.536 1386.36,956.335 1397.1,820.639 1407.85,231.478 1418.59,244.839 1429.33,245.671 
  1440.07,248.223 1450.81,268.747 1461.55,269.241 1472.29,254.59 1483.04,211.04 1493.78,926.055 1504.52,167.606 1515.26,179.101 1526,206.006 1536.74,224.568 
  1547.48,230.418 1558.22,214.931 1568.97,218.264 1579.71,202.711 1590.45,153.092 1601.19,116.897 1611.93,272.682 1622.67,113.101 1633.41,266.365 1644.15,307.338 
  1654.9,159.995 1665.64,152.105 1676.38,110.104 1687.12,109.793 1697.86,675.349 1708.6,274.425 1719.34,104.257 1730.08,135.633 1740.83,136.852 1751.57,157.569 
  1762.31,158.476 1773.05,393.531 1783.79,686.671 1794.53,778.156 1805.27,782.727 1816.01,764.352 1826.76,551.013 1837.5,657.24 1848.24,802.316 1858.98,854.767 
  1869.72,745.645 1880.46,810.232 1891.2,966.9 1901.94,989.204 1912.69,822.639 1923.43,321.014 1934.17,186.237 1944.91,259.013 1955.65,212.394 1966.39,362.947 
  1977.13,270.279 1987.87,282.08 1998.62,279.951 2009.36,377.956 2020.1,357.496 2030.84,318.253 2041.58,483.685 2052.32,702.392 2063.06,945.216 2073.81,733.177 
  2084.55,744.835 2095.29,555.96 2106.03,537.136 2116.77,166.385 2127.51,147.63 2138.25,177.018 2148.99,205.963 2159.74,286.172 2170.48,238.817 2181.22,206.184 
  2191.96,164.668 2202.7,163.87 2213.44,322.471 2224.18,196.36 2234.92,367.476 2245.67,145.832 2256.41,136.911 2267.15,113.499 2277.89,134.803 2288.63,218.707 
  
  "/>
<polyline clip-path="url(#clip1002)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.66 161.859,1479.55 172.6,1479.44 183.341,1479.03 194.083,1478.71 204.824,1478.12 215.565,1477.85 226.306,1477.03 237.048,1476.13 247.789,1475.63 
  258.53,1475.57 269.272,1474.8 280.013,1474.54 290.754,1473.65 301.495,1473.7 312.237,1472.18 322.978,1469.59 333.719,1469.54 344.46,1465.8 355.202,1465.75 
  365.943,1463.9 376.684,1459.06 387.425,1457.95 398.167,1452.84 408.908,1449.34 419.649,1451.85 430.391,1440.59 441.132,1422.59 451.873,1432.01 462.614,1424.43 
  473.356,1403.39 484.097,1380.59 494.838,1359.59 505.579,1360.51 516.321,1321.29 527.062,1295.47 537.803,1247.31 548.545,1291.08 559.286,1131.93 570.027,1067.64 
  580.768,1180.47 591.51,1251.5 602.251,1126.3 612.992,1157.77 623.733,1194.39 634.475,1162.33 645.216,631.507 655.957,825.718 666.699,720.061 677.44,914.257 
  688.181,781.517 698.922,790.631 709.664,1123.56 720.405,1034.13 731.146,819.706 741.887,854.936 752.629,819.008 763.37,656.021 774.111,634.52 784.853,800.873 
  795.594,1088.88 806.335,825.027 817.076,913.573 827.818,868.422 838.559,592.306 849.3,602.977 860.041,758.395 870.783,478.206 881.524,647.604 892.265,1111.79 
  903.007,499.37 913.748,351.991 924.489,489.271 935.23,724.712 945.972,572.59 956.713,500.697 967.454,299.844 978.195,326.159 988.937,387.241 999.678,394.497 
  1010.42,488.992 1021.16,423.991 1031.9,354.647 1042.64,346.999 1053.38,441.347 1064.13,262.444 1074.87,442.482 1085.61,533.787 1096.35,438.095 1107.09,399.388 
  1117.83,309.13 1128.57,306.897 1139.31,268.989 1150.06,266.644 1160.8,411.285 1171.54,282.755 1182.28,448.011 1193.02,298.49 1203.76,256.916 1214.5,568.417 
  1225.24,455.065 1235.99,597.633 1246.73,451.909 1257.47,356.01 1268.21,425.315 1278.95,430.499 1289.69,370.482 1300.43,432.463 1311.17,315.421 1321.92,456.143 
  1332.66,452.918 1343.4,521.149 1354.14,986.038 1364.88,1002.67 1375.62,1131.93 1386.36,933.651 1397.1,707.461 1407.85,686.106 1418.59,261.929 1429.33,291.983 
  1440.07,393.748 1450.81,277.255 1461.55,221.78 1472.29,688.191 1483.04,552.336 1493.78,878.712 1504.52,1040.25 1515.26,348.851 1526,311.8 1536.74,359.118 
  1547.48,199.054 1558.22,198.75 1568.97,387.251 1579.71,390.598 1590.45,657.687 1601.19,358.727 1611.93,697.705 1622.67,393.124 1633.41,629.361 1644.15,748.341 
  1654.9,739.192 1665.64,376.685 1676.38,519.906 1687.12,734.674 1697.86,1009.28 1708.6,879.687 1719.34,534.675 1730.08,465.825 1740.83,287.355 1751.57,196.501 
  1762.31,155.891 1773.05,572.784 1783.79,697.727 1794.53,624.506 1805.27,642.175 1816.01,552.473 1826.76,663.542 1837.5,549.77 1848.24,756.314 1858.98,793.128 
  1869.72,798.313 1880.46,925.731 1891.2,1145.84 1901.94,1043.72 1912.69,816.15 1923.43,709.804 1934.17,393.766 1944.91,316.26 1955.65,792.494 1966.39,285.677 
  1977.13,288.15 1987.87,600.598 1998.62,328.801 2009.36,422.579 2020.1,356.422 2030.84,380.367 2041.58,564.66 2052.32,836.953 2063.06,793.691 2073.81,688.61 
  2084.55,888.629 2095.29,705.045 2106.03,727.673 2116.77,438.932 2127.51,450.611 2138.25,349.857 2148.99,308.636 2159.74,418.403 2170.48,401.802 2181.22,398.377 
  2191.96,525.452 2202.7,515.688 2213.44,589.81 2224.18,713.126 2234.92,454.344 2245.67,522.136 2256.41,324.135 2267.15,340.855 2277.89,429.234 2288.63,609.02 
  
  "/>
<path clip-path="url(#clip1000)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip1000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip1000)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip1000)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip1000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>Finally, we save the logged results to <code>exper</code> for later review:</p><pre><code class="language-julia">exper[:logs] = get(lg)
finish!(exper); # flushes everything to disk</code></pre><pre><code class="language-none">[ Info: Experiment saved to /tmp/hopper_example.jlso</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../humanoid/">« Creating a MuJoCo Environment</a><a class="docs-footer-nextpage" href="../visualize/">Using the Visualizer »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 21 January 2020 00:37">Tuesday 21 January 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
