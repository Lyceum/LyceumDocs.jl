<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Learning a Control Policy · Lyceum</title><link rel="canonical" href="https://docs.lyceum.ml/dev/examples/NPG/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Lyceum logo"/></a><div class="docs-package-name"><span class="docs-autofit">Lyceum</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">LyceumBase</span><ul><li><a class="tocitem" href="../../lyceumbase/abstractenvironment/">AbstractEnvironment</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../example_howto/">Running Examples Locally</a></li><li><a class="tocitem" href="../humanoid/">Creating a MuJoCo Environment</a></li><li class="is-active"><a class="tocitem" href>Learning a Control Policy</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#The-Code-1"><span>The Code</span></a></li></ul></li><li><a class="tocitem" href="../visualize/">Using the Visualizer</a></li></ul></li><li><span class="tocitem">LyceumAI</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lyceumai/models/policies/">Policies</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lyceumai/algorithms/naturalpolicygradient/">Natural Policy Gradient</a></li><li><a class="tocitem" href="../../lyceumai/algorithms/mppi/">MPPI</a></li></ul></li></ul></li><li><span class="tocitem">LyceumMuJoCo</span><ul><li><a class="tocitem" href="../../lyceummujoco/lyceummujoco/">LyceumMuJoCo</a></li><li><a class="tocitem" href="../../lyceummujoco/environments/">Environments</a></li></ul></li><li><span class="tocitem">LyceumMuJoCoViz</span><ul><li><a class="tocitem" href="../../lyceummujocoviz/lyceummujocoviz/">LyceumMuJoCoViz</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Learning a Control Policy</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Learning a Control Policy</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/docs/src/examples/NPG.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Running examples locally</header><div class="admonition-body"><p>This example and more are also available as Julia scripts and Jupyter notebooks.</p><p>See <a href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/example_howto.md">the how-to page</a> for more information.</p></div></div><h1 id="Learning-a-Control-Policy-1"><a class="docs-heading-anchor" href="#Learning-a-Control-Policy-1">Learning a Control Policy</a><a class="docs-heading-anchor-permalink" href="#Learning-a-Control-Policy-1" title="Permalink"></a></h1><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>In this example we walk through the process of setting up an experiment that runs <a href="https://papers.nips.cc/paper/2073-a-natural-policy-gradient.pdf">Natural Policy Gradient</a> (or more recently <a href="https://arxiv.org/pdf/1703.02660.pdf">in this work</a>). This is an on-policy reinforcement learning method that is comparable to TRPO, PPO, and other policy gradient methods. See the documentation for <code>NaturalPolicyGradient</code> for full implementation details.</p><h2 id="The-Code-1"><a class="docs-heading-anchor" href="#The-Code-1">The Code</a><a class="docs-heading-anchor-permalink" href="#The-Code-1" title="Permalink"></a></h2><p>First, let&#39;s go head and grab all the dependencies:</p><pre><code class="language-julia">using LinearAlgebra, Random, Statistics # From Stdlib
using LyceumAI                          # For the NPG controller
using LyceumMuJoCo                      # For the Hopper environment
using Flux                              # For our neural networks needs
using UniversalLogger                   # For logging experiment data
using Plots                             # For plotting the results
using LyceumBase.Tools                  # Miscellaneous utilities</code></pre><p>We first instantiate a <code>HopperV2</code> environment to grab useful environment-specific values, such as the size of the observation and action vectors:</p><pre><code class="language-julia">env = LyceumMuJoCo.HopperV2();
dobs, dact = length(obsspace(env)), length(actionspace(env));</code></pre><p>We&#39;ll also seed the per-thread global RNGs:</p><pre><code class="language-julia">seed_threadrngs!(1)</code></pre><pre><code class="language-none">1-element Array{Random.MersenneTwister,1}:
 Random.MersenneTwister(UInt32[0x00000001], Random.DSFMT.DSFMT_state(Int32[1749029653, 1072851681, 1610647787, 1072862326, 1841712345, 1073426746, -198061126, 1073322060, -156153802, 1073567984  …  1977574422, 1073209915, 278919868, 1072835605, 1290372147, 18858467, 1815133874, -1716870370, 382, 0]), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], UInt128[0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000  …  0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000], 1002, 0)</code></pre><h3 id="Policy-Gradient-Components-1"><a class="docs-heading-anchor" href="#Policy-Gradient-Components-1">Policy Gradient Components</a><a class="docs-heading-anchor-permalink" href="#Policy-Gradient-Components-1" title="Permalink"></a></h3><p>Policy Gradient methods require a policy: a function that takes in the state/observations of the agent, and outputs an action i.e. <code>action = π(obs)</code>. In much of Deep RL, the policy takes the form of a neural network which can be built on top of the <a href="https://github.com/FluxML/Flux.jl">Flux.jl</a> library. We utilize a stochastic policy in this example. Specifically, our policy is represented as a multivariate Gaussian distribution of the form:</p><div>\[\pi(a | o) = \mathcal{N}(\mu_{\theta_1}(o), \Sigma_{\theta_2})\]</div><p>where <span>$\mu_{\theta_1}$</span> is a neural network, parameterized by <span>$\theta_1$</span>, that maps an observation to a mean action and <span>$\Sigma_{\theta_2}$</span> is a diagonal covariance matrix parameterized by <span>$\theta_2$</span>, the diagonal entries of the matrix. For <span>$\mu_{\theta_1}$</span> we utilize a 2-layer neural network, where each layer has a &quot;width&quot; of 32. We use tanh activations for each hidden layer and initialize the network weights with Glorot Uniform initializations. Rather than tracking <span>$\Sigma_{\theta_2}$</span> directly, we track the log standard deviations, which are easier to learn. We initialize <span>$\log \text{diag}(\Sigma_{\theta_2})$</span> as <code>zeros(dact)</code>, i.e. a <code>Vector</code> of length <code>dact</code>, initialized to 0. Both <span>$\theta_1$</span> and <span>$\theta_2$</span> are learned in this example. Note that <span>$\mu_{\theta_1}$</span> is a <em>state-dependent</em> mean while <span>$\Sigma_{\theta_2}$</span> is a <em>global</em> covariance.</p><pre><code class="language-julia">const policy = DiagGaussianPolicy(
    multilayer_perceptron(
        dobs,
        32,
        32,
        dact;
        σ = tanh,
        initb = Flux.glorot_uniform,
        initb_final = Flux.glorot_uniform,
        dtype = Float32,
    ),
    zeros(Float32, dact),
);</code></pre><p>This NPG implementation uses <a href="https://arxiv.org/pdf/1506.02438.pdf">Generalized Advantaged Estimation</a>, which requires an estimate of the value function, <code>value(state)</code>, which we represent using a 2-layer, feedforward neural network where each layer has a width of 128 and uses the ReLU activation function. The model weights are initialized using Glorot Uniform initialization as above.</p><pre><code class="language-julia">const value = multilayer_perceptron(
    dobs,
    128,
    128,
    1;
    σ = Flux.relu,
    initb = Flux.glorot_uniform,
    initb_final = Flux.glorot_uniform,
    dtype = Float32,
);</code></pre><p>Next, we set up the optimization pipeline for <code>value</code>. We use a mini-batch size of 64 and the <a href="https://arxiv.org/pdf/1412.6980.pdf">ADAM</a> optimizer. <code>FluxTrainer</code> is an iterator that loops on the model provided, performing a single step of gradient descent at each iteration. The result at each loop is passed to <code>stopcb</code> below, so you can quit after a number of epochs, convergence, or other criteria; here it&#39;s capped at two epochs. See the documentation for <code>FluxTrainer</code> for more information.</p><pre><code class="language-julia">valueloss(bl, X, Y) = Flux.mse(vec(bl(X)), vec(Y))
stopcb(x) = x.nepochs &gt; 2
const valuetrainer = FluxTrainer(
    optimiser = ADAM(1e-3),
    szbatch = 64,
    lossfn = valueloss,
    stopcb = stopcb
);</code></pre><p>The <code>NaturalPolicyGradient</code> iterator is a type that pre-allocates all necesary data structures and performs one gradient update to <code>policy</code> at each iteration. We first pass in a constructor that given <code>n</code> returns <code>n</code> instances of <code>LyceumMuJoCo.HopperV2</code>, all sharing the same <code>jlModel</code>, to allow <code>NaturalPolicyGradient</code> to allocate per-thread environments and enable performant, parallel sampling from <code>policy</code>. We then pass in the <code>policy</code>, <code>value</code>, and <code>valuetrainer</code> instances constructed above and override a few of the default <code>NaturalPolicyGradient</code> parameters: <code>gamma</code>, <code>gaelambda</code>, and <code>norm_step_size</code>. Finally, we set the max trajectory length <code>Hmax</code> and total number of samples per iteration, <code>N</code>. Under the hood, <code>NaturalPolicyGradient</code> will use approximately <code>div(N, Hmax)</code> threads to perform the sampling.</p><pre><code class="language-julia">const npg = NaturalPolicyGradient(
    n -&gt; tconstruct(LyceumMuJoCo.HopperV2, n),
    policy,
    value,
    valuetrainer;
    gamma = 0.995,
    gaelambda = 0.97,
    norm_step_size = 0.05,
    Hmax = 1000,
    N = 10240,
);</code></pre><h3 id="Running-Experiments-1"><a class="docs-heading-anchor" href="#Running-Experiments-1">Running Experiments</a><a class="docs-heading-anchor-permalink" href="#Running-Experiments-1" title="Permalink"></a></h3><p>Finally, let&#39;s spin on our iterator 200 times, plotting every 20 iterations. This lets us break out of the loop if certain conditions are met, or re-start training manually if needed. We of course wish to track results, so we create a <code>ULogger</code> and <code>Experiment</code> to which we can save data. We also have useful timing information displayed every 20 iterations to better understand the performance of our algorithm and identify any potential bottlenecks. Rather than iterating on <code>npg</code> at the global scope, we&#39;ll do it inside of a function to avoid the performance issues associated with global variables as discussed in the <a href="https://docs.julialang.org/en/v1/manual/performance-tips/">Julia performance tips</a>. Note, to keep the Markdown version of this tutorial readable, we skip the plots and performance statistics. To enable them, simply call <code>hopper_NPG(npg, true)</code>.</p><pre><code class="language-julia">function hopper_NPG(npg::NaturalPolicyGradient, plot::Bool)
    exper = Experiment(&quot;/tmp/hopper_example.jlso&quot;, overwrite = true)
    # Walks, talks, and acts like a Julia logger. See the UniversalLogger.jl docs for more info.
    lg = ULogger()
    for (i, state) in enumerate(npg)
        if i &gt; 200
            # serialize some stuff and quit
            exper[:policy] = npg.policy
            exper[:value] = npg.value
            exper[:etype] = LyceumMuJoCo.HopperV2
            exper[:meanstates] = state.meanbatch
            exper[:stocstates] = state.stocbatch
            break
        end

        # log everything in `state` except meanbatch and stocbatch
        push!(lg, :algstate, filter_nt(state, exclude = (:meanbatch, :stocbatch)))

        if plot &amp;&amp; mod(i, 20) == 0
            x = lg[:algstate]
            # The following are helper functions for plotting to the terminal.
            # The first plot displays the `geteval` function for our stochastic
            # and mean policy rollouts.
            display(expplot(
                Line(x[:stocterminal_eval], &quot;StocLastE&quot;),
                Line(x[:meanterminal_eval], &quot;MeanLastE&quot;),
                title = &quot;Evaluation Score, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))
            # While the second one similarly plots `getreward`.
            display(expplot(
                Line(x[:stoctraj_reward], &quot;StocR&quot;),
                Line(x[:meantraj_reward], &quot;MeanR&quot;),
                title = &quot;Reward, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))

            # The following are timing values for various parts of the Natural Policy Gradient
            # algorithm at the last iteration, useful for finding performance bottlenecks
            # in the algorithm.
            println(&quot;elapsed_sampled  = &quot;, state.elapsed_sampled)
            println(&quot;elapsed_gradll   = &quot;, state.elapsed_gradll)
            println(&quot;elapsed_vpg      = &quot;, state.elapsed_vpg)
            println(&quot;elapsed_cg       = &quot;, state.elapsed_cg)
            println(&quot;elapsed_valuefit = &quot;, state.elapsed_valuefit)
        end
    end
    exper, lg
end
exper, lg = hopper_NPG(npg, false);</code></pre><p>Let&#39;s go ahead and plot the final reward trajectory for our stochastic and mean policies to see how we did:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_reward] lg[:algstate][:stoctraj_reward]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Reward&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip2400">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip2400)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2401">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip2400)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2402">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1504.03 2352.76,1504.03 
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1051.63 2352.76,1051.63 
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,599.241 2352.76,599.241 
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,146.849 2352.76,146.849 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1504.03 114.181,1504.03 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1051.63 114.181,1051.63 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,599.241 114.181,599.241 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,146.849 114.181,146.849 
  "/>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1521.53)" x="62.9921" y="1521.53">0</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1069.13)" x="62.9921" y="1069.13">1000</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 616.741)" x="62.9921" y="616.741">2000</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 164.349)" x="62.9921" y="164.349">3000</text>
</g>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Reward</text>
</g>
<polyline clip-path="url(#clip2402)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1478.53 172.6,1468.36 183.341,1468.43 194.083,1458.23 204.824,1414.8 215.565,1465.86 226.306,1436.85 237.048,1413.65 247.789,1419.57 
  258.53,1416.92 269.272,1419.36 280.013,1415.97 290.754,1415.22 301.495,1413.83 312.237,1411.11 322.978,1410.64 333.719,1410.25 344.46,1407.02 355.202,1407.59 
  365.943,1407.58 376.684,1407.4 387.425,1407.32 398.167,1407.1 408.908,1407.11 419.649,1406.96 430.391,1406.63 441.132,1403.67 451.873,1403.54 462.614,1403.78 
  473.356,1403.23 484.097,1398.5 494.838,1392.66 505.579,1392.26 516.321,1391.5 527.062,1390.1 537.803,1389.94 548.545,1383.42 559.286,1382.38 570.027,1380.89 
  580.768,1374.15 591.51,1380.32 602.251,1312.68 612.992,1305.83 623.733,1307.16 634.475,1311.64 645.216,1220.2 655.957,1195.14 666.699,1160.32 677.44,1123.5 
  688.181,1168.6 698.922,1083.18 709.664,1046.88 720.405,1046.58 731.146,1095.18 741.887,1008.18 752.629,999.06 763.37,985.308 774.111,987.096 784.853,919.432 
  795.594,915.983 806.335,500.693 817.076,811.701 827.818,1028.48 838.559,1033.24 849.3,364.794 860.041,377.906 870.783,820.505 881.524,346.76 892.265,624.809 
  903.007,911.922 913.748,1001.19 924.489,315.15 935.23,358.908 945.972,378.853 956.713,413.141 967.454,646.009 978.195,347.171 988.937,338.285 999.678,352.038 
  1010.42,612.864 1021.16,310.023 1031.9,607.522 1042.64,322.89 1053.38,323.367 1064.13,310.886 1074.87,305.883 1085.61,292.385 1096.35,346.002 1107.09,356.607 
  1117.83,307.448 1128.57,275.944 1139.31,284.766 1150.06,280.316 1160.8,271.155 1171.54,321.98 1182.28,274.94 1193.02,599.127 1203.76,304.724 1214.5,291.023 
  1225.24,282.981 1235.99,272.433 1246.73,282.971 1257.47,296.576 1268.21,283.677 1278.95,261.411 1289.69,227.381 1300.43,514.809 1311.17,196.466 1321.92,509.946 
  1332.66,244.764 1343.4,580.037 1354.14,329.181 1364.88,235.886 1375.62,235.506 1386.36,246.326 1397.1,229.305 1407.85,273.043 1418.59,293.103 1429.33,248.684 
  1440.07,301.276 1450.81,351.192 1461.55,310.499 1472.29,299.435 1483.04,337.059 1493.78,304.726 1504.52,314.01 1515.26,306.052 1526,287.709 1536.74,301.582 
  1547.48,255.732 1558.22,240.823 1568.97,254.525 1579.71,219.276 1590.45,237.559 1601.19,261.13 1611.93,309.166 1622.67,313.795 1633.41,314.369 1644.15,299.848 
  1654.9,258.058 1665.64,233.075 1676.38,290.765 1687.12,341.034 1697.86,310.816 1708.6,305.968 1719.34,242.783 1730.08,270.474 1740.83,341.721 1751.57,304.618 
  1762.31,307.255 1773.05,249.318 1783.79,301.034 1794.53,255.685 1805.27,576.306 1816.01,572.351 1826.76,767.158 1837.5,261.513 1848.24,568.714 1858.98,226.649 
  1869.72,892.249 1880.46,754.902 1891.2,732.372 1901.94,177.589 1912.69,436.868 1923.43,462.074 1934.17,501.909 1944.91,173.278 1955.65,505.207 1966.39,213.271 
  1977.13,506.843 1987.87,178.21 1998.62,540.762 2009.36,139.274 2020.1,134.083 2030.84,130.703 2041.58,130.002 2052.32,116.72 2063.06,631.199 2073.81,438.313 
  2084.55,115.983 2095.29,109.397 2106.03,104.45 2116.77,104.257 2127.51,112.652 2138.25,118.61 2148.99,445.37 2159.74,1253.04 2170.48,1298.45 2181.22,1299.22 
  2191.96,1235.54 2202.7,972.718 2213.44,887.183 2224.18,789.183 2234.92,653.007 2245.67,639.238 2256.41,884.066 2267.15,640.604 2277.89,966.763 2288.63,967.088 
  
  "/>
<polyline clip-path="url(#clip2402)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.61 161.859,1478.02 172.6,1474.82 183.341,1466.46 194.083,1463.8 204.824,1459.56 215.565,1455.71 226.306,1443.12 237.048,1440.81 247.789,1433.71 
  258.53,1424.87 269.272,1423.94 280.013,1418.84 290.754,1420.29 301.495,1418.94 312.237,1415.57 322.978,1415.81 333.719,1415.03 344.46,1410.38 355.202,1411.42 
  365.943,1409.4 376.684,1424.07 387.425,1410.29 398.167,1411.25 408.908,1408.02 419.649,1406.73 430.391,1408.71 441.132,1407.86 451.873,1409.95 462.614,1407.57 
  473.356,1407.09 484.097,1401.46 494.838,1399.56 505.579,1395.12 516.321,1398.3 527.062,1392.83 537.803,1388.2 548.545,1382.74 559.286,1366.98 570.027,1376.36 
  580.768,1363.57 591.51,1354.68 602.251,1332.2 612.992,1326.75 623.733,1307.42 634.475,1290.86 645.216,1261.15 655.957,1260.77 666.699,1237.94 677.44,1231.69 
  688.181,1214.29 698.922,1198.51 709.664,1199.56 720.405,1165.78 731.146,1143.33 741.887,1171.38 752.629,1134.43 763.37,1115.88 774.111,1097.28 784.853,1052.24 
  795.594,1082.72 806.335,1098.23 817.076,979.115 827.818,932.463 838.559,825.258 849.3,792.296 860.041,884.223 870.783,869.497 881.524,737.61 892.265,836.712 
  903.007,854.208 913.748,788.171 924.489,799.285 935.23,773.521 945.972,762.204 956.713,596.134 967.454,751.097 978.195,792.194 988.937,515.002 999.678,653.292 
  1010.42,683.856 1021.16,697.603 1031.9,690.981 1042.64,523.475 1053.38,606.87 1064.13,659.286 1074.87,570.109 1085.61,697.702 1096.35,595.207 1107.09,659.217 
  1117.83,512.674 1128.57,647.037 1139.31,650.329 1150.06,515.194 1160.8,592.511 1171.54,626.224 1182.28,787.473 1193.02,703.778 1203.76,495.704 1214.5,607.68 
  1225.24,743.715 1235.99,946.686 1246.73,743.419 1257.47,410.035 1268.21,633.441 1278.95,379.123 1289.69,586.808 1300.43,772.22 1311.17,562.751 1321.92,651.094 
  1332.66,585.539 1343.4,516.945 1354.14,529.731 1364.88,753.795 1375.62,586.414 1386.36,503.301 1397.1,573.704 1407.85,466.3 1418.59,393.84 1429.33,664.217 
  1440.07,535.963 1450.81,447.101 1461.55,469.307 1472.29,390.265 1483.04,488.778 1493.78,351.479 1504.52,490.601 1515.26,534.526 1526,468.322 1536.74,427.842 
  1547.48,631.35 1558.22,717.793 1568.97,505.145 1579.71,671.595 1590.45,836.075 1601.19,703.753 1611.93,640.295 1622.67,431.63 1633.41,430.262 1644.15,513.491 
  1654.9,696.741 1665.64,576.677 1676.38,576.944 1687.12,539.649 1697.86,441.055 1708.6,332.832 1719.34,517.761 1730.08,741.575 1740.83,416.659 1751.57,435.293 
  1762.31,554.595 1773.05,550.12 1783.79,398.367 1794.53,485.505 1805.27,558.74 1816.01,554.285 1826.76,517.731 1837.5,586.643 1848.24,554.683 1858.98,966.552 
  1869.72,638.444 1880.46,823.367 1891.2,546.447 1901.94,828.881 1912.69,514.464 1923.43,717.108 1934.17,587.738 1944.91,659.71 1955.65,350.604 1966.39,797.43 
  1977.13,363.725 1987.87,448.022 1998.62,523.446 2009.36,646.067 2020.1,861.082 2030.84,635.599 2041.58,636.941 2052.32,410.102 2063.06,619.294 2073.81,495.162 
  2084.55,551.49 2095.29,817.197 2106.03,490.578 2116.77,574.117 2127.51,501.113 2138.25,632.726 2148.99,995.621 2159.74,976.911 2170.48,925.351 2181.22,796.744 
  2191.96,1173.92 2202.7,963.255 2213.44,958.183 2224.18,634.526 2234.92,573.578 2245.67,731.657 2256.41,499.123 2267.15,420.859 2277.89,656.625 2288.63,673.256 
  
  "/>
<path clip-path="url(#clip2400)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip2400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip2400)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip2400)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip2400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>We&#39;ll also plot the evaluations:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_eval] lg[:algstate][:stoctraj_eval]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Eval&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip3000">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip3000)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip3001">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip3000)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip3002">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1480.1 2352.76,1480.1 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1139.02 2352.76,1139.02 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,797.931 2352.76,797.931 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,456.844 2352.76,456.844 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,115.757 2352.76,115.757 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1480.1 114.181,1480.1 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1139.02 114.181,1139.02 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,797.931 114.181,797.931 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,456.844 114.181,456.844 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,115.757 114.181,115.757 
  "/>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1497.6)" x="62.9921" y="1497.6">0</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1156.52)" x="62.9921" y="1156.52">2000</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 815.431)" x="62.9921" y="815.431">4000</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 474.344)" x="62.9921" y="474.344">6000</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 133.257)" x="62.9921" y="133.257">8000</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Eval</text>
</g>
<polyline clip-path="url(#clip3002)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1479.7 172.6,1479.31 183.341,1479.29 194.083,1478.74 204.824,1475.52 215.565,1479.15 226.306,1476.64 237.048,1475.37 247.789,1476.05 
  258.53,1475.84 269.272,1475.98 280.013,1475.82 290.754,1475.72 301.495,1475.48 312.237,1475.37 322.978,1475.32 333.719,1475.06 344.46,1474.89 355.202,1474.88 
  365.943,1474.84 376.684,1474.8 387.425,1474.77 398.167,1474.76 408.908,1474.75 419.649,1474.74 430.391,1474.66 441.132,1474.45 451.873,1474.41 462.614,1474.42 
  473.356,1474.23 484.097,1473.81 494.838,1473.19 505.579,1473.15 516.321,1473.01 527.062,1472.88 537.803,1472.84 548.545,1472.28 559.286,1472.23 570.027,1472.01 
  580.768,1471.02 591.51,1471.9 602.251,1458.82 612.992,1457.9 623.733,1457.54 634.475,1458.26 645.216,1430.23 655.957,1421.39 666.699,1411.01 677.44,1393.56 
  688.181,1411.8 698.922,1369.92 709.664,1358.5 720.405,1343.87 731.146,1380.2 741.887,1309.55 752.629,1291.97 763.37,1295.66 774.111,1303.76 784.853,1255.89 
  795.594,1241.65 806.335,723.595 817.076,1011.21 827.818,1283.56 838.559,1228.71 849.3,467.431 860.041,483.557 870.783,1090.84 881.524,441.068 892.265,817.83 
  903.007,1139.28 913.748,1170.32 924.489,399.255 935.23,472.899 945.972,490.982 956.713,531.579 967.454,846.7 978.195,484.876 988.937,453.292 999.678,478.762 
  1010.42,798.471 1021.16,430.876 1031.9,747.057 1042.64,439.435 1053.38,427.252 1064.13,407.588 1074.87,393.458 1085.61,379.907 1096.35,479.351 1107.09,468.525 
  1117.83,389.438 1128.57,349.496 1139.31,361.592 1150.06,352.923 1160.8,345.886 1171.54,397.837 1182.28,337.067 1193.02,790.038 1203.76,390.515 1214.5,372.376 
  1225.24,358.298 1235.99,349.261 1246.73,360.661 1257.47,385.355 1268.21,353.642 1278.95,329.811 1289.69,276.974 1300.43,704.525 1311.17,246.321 1321.92,719.733 
  1332.66,305.878 1343.4,765.953 1354.14,401.295 1364.88,280.058 1375.62,297.062 1386.36,304.479 1397.1,285.426 1407.85,339.212 1418.59,362.48 1429.33,302.349 
  1440.07,351.677 1450.81,399.089 1461.55,355.751 1472.29,351.207 1483.04,390.985 1493.78,360.275 1504.52,371.59 1515.26,359.533 1526,335.16 1536.74,350.726 
  1547.48,301.647 1558.22,280.723 1568.97,298.395 1579.71,257.083 1590.45,280.156 1601.19,300.826 1611.93,341.401 1622.67,353.133 1633.41,359.482 1644.15,342.765 
  1654.9,287.054 1665.64,268.495 1676.38,337.949 1687.12,377.667 1697.86,336.969 1708.6,335.919 1719.34,290.643 1730.08,310.36 1740.83,392.546 1751.57,348.457 
  1762.31,330.874 1773.05,278.17 1783.79,339.401 1794.53,294.088 1805.27,737.626 1816.01,727.11 1826.76,932.418 1837.5,274.287 1848.24,723.993 1858.98,226.708 
  1869.72,1144.89 1880.46,1015.08 1891.2,985.861 1901.94,152.627 1912.69,487.386 1923.43,536.336 1934.17,623.211 1944.91,173.317 1955.65,577.723 1966.39,224.262 
  1977.13,653.532 1987.87,185.324 1998.62,606.347 2009.36,144.413 2020.1,133.406 2030.84,132.962 2041.58,137.362 2052.32,124.167 2063.06,912.819 2073.81,619.905 
  2084.55,115.009 2095.29,111.461 2106.03,111.549 2116.77,104.257 2127.51,123.069 2138.25,124.925 2148.99,629.694 2159.74,1426.77 2170.48,1454.43 2181.22,1454.51 
  2191.96,1424.68 2202.7,1287.16 2213.44,1241.79 2224.18,1048.67 2234.92,805.602 2245.67,937.382 2256.41,1204.77 2267.15,948.245 2277.89,1299.2 2288.63,1308.62 
  
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.69 161.859,1479.66 172.6,1479.52 183.341,1479.23 194.083,1479.02 204.824,1478.62 215.565,1478.29 226.306,1477.46 237.048,1477.37 247.789,1476.89 
  258.53,1476.31 269.272,1476.25 280.013,1475.88 290.754,1475.98 301.495,1475.88 312.237,1475.64 322.978,1475.66 333.719,1475.5 344.46,1475.17 355.202,1475.21 
  365.943,1475.04 376.684,1475.96 387.425,1475.12 398.167,1475.18 408.908,1474.94 419.649,1474.84 430.391,1474.93 441.132,1474.8 451.873,1474.91 462.614,1474.62 
  473.356,1474.53 484.097,1473.96 494.838,1473.65 505.579,1473.24 516.321,1473.38 527.062,1472.62 537.803,1472.24 548.545,1471.28 559.286,1468.75 570.027,1469.9 
  580.768,1468.01 591.51,1466.09 602.251,1462.61 612.992,1461.12 623.733,1456.55 634.475,1451.69 645.216,1444.65 655.957,1442.45 666.699,1438.26 677.44,1433.68 
  688.181,1428.77 698.922,1424.07 709.664,1418.58 720.405,1409.2 731.146,1399.04 741.887,1408.69 752.629,1393.81 763.37,1378.87 774.111,1368.89 784.853,1341.87 
  795.594,1362.47 806.335,1350.41 817.076,1253.27 827.818,1225.31 838.559,1125.95 849.3,1046.26 860.041,1117.69 870.783,1132.29 881.524,929.734 892.265,1080.03 
  903.007,1038.23 913.748,1022.12 924.489,1037.3 935.23,987.62 945.972,940.536 956.713,814.818 967.454,922.873 978.195,976.369 988.937,687.442 999.678,836.297 
  1010.42,917.602 1021.16,915.842 1031.9,869.644 1042.64,690.962 1053.38,782.854 1064.13,855.16 1074.87,791.802 1085.61,878.592 1096.35,759.224 1107.09,843.878 
  1117.83,655.121 1128.57,789.293 1139.31,823.138 1150.06,651.416 1160.8,734.897 1171.54,753.989 1182.28,905.551 1193.02,851.361 1203.76,634.266 1214.5,759.389 
  1225.24,925.133 1235.99,1096.18 1246.73,902.41 1257.47,521.719 1268.21,730.344 1278.95,482.52 1289.69,733.285 1300.43,1023.42 1311.17,765.669 1321.92,869.271 
  1332.66,796.724 1343.4,735.962 1354.14,673.246 1364.88,990.523 1375.62,753.984 1386.36,649.411 1397.1,730.444 1407.85,566.855 1418.59,477.211 1429.33,822.836 
  1440.07,638.749 1450.81,527.14 1461.55,597.656 1472.29,487.467 1483.04,624.873 1493.78,465.061 1504.52,605.97 1515.26,622.631 1526,594.49 1536.74,546.251 
  1547.48,833.127 1558.22,884.634 1568.97,610.895 1579.71,856.632 1590.45,984.765 1601.19,818.902 1611.93,768.485 1622.67,526.174 1633.41,524.407 1644.15,630.652 
  1654.9,779.205 1665.64,690.075 1676.38,755.689 1687.12,581.663 1697.86,563.509 1708.6,411.355 1719.34,647.361 1730.08,863.331 1740.83,519.165 1751.57,544.073 
  1762.31,703.34 1773.05,705.155 1783.79,503.257 1794.53,617.002 1805.27,737.306 1816.01,685.314 1826.76,603.902 1837.5,685.035 1848.24,688.365 1858.98,1205.06 
  1869.72,765.073 1880.46,1010.91 1891.2,708.924 1901.94,997.028 1912.69,698.014 1923.43,992.864 1934.17,723.107 1944.91,780.514 1955.65,461.899 1966.39,941.649 
  1977.13,447.387 1987.87,583.2 1998.62,665.962 2009.36,730.963 2020.1,963.674 2030.84,803.036 2041.58,829.029 2052.32,581.946 2063.06,839.485 2073.81,634.812 
  2084.55,750.034 2095.29,959.52 2106.03,645.275 2116.77,658.514 2127.51,591.436 2138.25,780.435 2148.99,1149.15 2159.74,1138.04 2170.48,1094.74 2181.22,973.232 
  2191.96,1291.17 2202.7,1053.22 2213.44,1070.72 2224.18,799.863 2234.92,697.417 2245.67,884.757 2256.41,559.461 2267.15,565.159 2277.89,843.517 2288.63,822.865 
  
  "/>
<path clip-path="url(#clip3000)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip3000)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>Finally, we save the logged results to <code>exper</code> for later review:</p><pre><code class="language-julia">exper[:logs] = get(lg)
finish!(exper); # flushes everything to disk</code></pre><pre><code class="language-none">[ Info: Experiment saved to /tmp/hopper_example.jlso</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../humanoid/">« Creating a MuJoCo Environment</a><a class="docs-footer-nextpage" href="../visualize/">Using the Visualizer »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 24 January 2020 05:54">Friday 24 January 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
