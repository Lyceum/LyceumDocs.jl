<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Learning a control policy · Lyceum</title><link rel="canonical" href="https://docs.lyceum.ml/dev/examples/NPG/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Lyceum</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Learning a control policy</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#The-Code-1"><span>The Code</span></a></li></ul></li><li><a class="tocitem" href="../humanoid/">Creating a MuJoCo Environment</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Learning a control policy</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Learning a control policy</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/docs/src/examples/NPG.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Running examples locally</header><div class="admonition-body"><p>This example and more are also available as Julia scripts and Jupyter notebooks.</p><p>See <a href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/example_howto.md">the how-to page</a> for more information.</p></div></div><h1 id="Learning-a-control-policy-1"><a class="docs-heading-anchor" href="#Learning-a-control-policy-1">Learning a control policy</a><a class="docs-heading-anchor-permalink" href="#Learning-a-control-policy-1" title="Permalink"></a></h1><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>In this example we walk through the process of setting up an experiment that runs <a href="https://papers.nips.cc/paper/2073-a-natural-policy-gradient.pdf">Natural Policy Gradient</a> (or more recently <a href="https://arxiv.org/pdf/1703.02660.pdf">in this work</a>). This is an on-policy reinforcement learning method that is comparable to TRPO, PPO, and other policy gradient methods. See the documentation for <code>NaturalPolicyGradient</code> for full implementation details.</p><h2 id="The-Code-1"><a class="docs-heading-anchor" href="#The-Code-1">The Code</a><a class="docs-heading-anchor-permalink" href="#The-Code-1" title="Permalink"></a></h2><p>First, let&#39;s go head and grab all the dependencies:</p><pre><code class="language-julia">using LinearAlgebra, Random, Statistics # From Stdlib
using LyceumAI                          # For the NPG controller
using LyceumMuJoCo                      # For the Hopper environment
using LyceumBase.Tools                  # For the ControllerIterator discussed below
using Flux                              # For our neural networks needs
using UniversalLogger                   # For logging experiment data
using Plots                             # For plotting the results</code></pre><p>We first instantiate a <code>HopperV2</code> environment to grab useful environment-specific values, such as the size of the observation and action vectors:</p><pre><code class="language-julia">env = LyceumMuJoCo.HopperV2();
dobs, dact = length(obsspace(env)), length(actionspace(env));</code></pre><h3 id="Policy-Gradient-Components-1"><a class="docs-heading-anchor" href="#Policy-Gradient-Components-1">Policy Gradient Components</a><a class="docs-heading-anchor-permalink" href="#Policy-Gradient-Components-1" title="Permalink"></a></h3><p>Policy Gradient methods require a policy: a function that takes in the state/observations of the agent, and outputs an action i.e. <code>action = π(obs)</code>. In much of Deep RL, the policy takes the form of a neural network which can be built on top of the <a href="https://github.com/FluxML/Flux.jl">Flux.jl</a> library. We utilize a stochastic policy in this example. Specifically, our policy is represented as a multivariate Gaussian distribution of the form:</p><div>\[\pi(a | s) = \mathcal{N}(\mu_{\theta_1}(\text{obs}), \Sigma_{\theta_2})\]</div><p>where <span>$\mu_{\theta_1}$</span> is a neural network, parameterized by <span>$\theta_1$</span>, that maps an observation <code>obs</code> to a mean action and <span>$\Sigma_{\theta_2}$</span> is a diagonal covariance matrix parameterized by <span>$\theta_2$</span>, the diagonal entries of the matrix. For <span>$\mu_{\theta_1}$</span> we utilize a 2-layer neural network, where each layer has a &quot;width&quot; of 32. We use tanh activations for each hidden layer and initialize the network weights with Glorot Uniform initializations. Rather than tracking <span>$\Sigma_{\theta_2}$</span> directly, we track the log standard deviations, which are easier to learn. We initialize <span>$\log \text{diag}(\Sigma_{\theta_2})$</span> as <code>zeros(dact)</code>, i.e. a <code>Vector</code> of length <code>dact</code>, initialized to 0. Both <span>$\theta_1$</span> and <span>$\theta_2$</span> are learned in this example. Note that <span>$\mu_{\theta_1}$</span> is a <em>state-dependent</em> mean while <span>$\Sigma_{\theta_2}$</span> is a <em>global</em> covariance.</p><pre><code class="language-julia">policy = DiagGaussianPolicy(
    multilayer_perceptron(
        dobs,
        32,
        32,
        dact;
        σ = tanh,
        initb = Flux.glorot_uniform,
        initb_final = Flux.glorot_uniform,
        dtype = Float32
    ),
    zeros(Float32, dact),
);</code></pre><p>This NPG implementation uses <a href="https://arxiv.org/pdf/1506.02438.pdf">Generalized Advantaged Estimation</a>, which requires an estimate of the value function, <code>value(state)</code>, which we represent using a 2-layer, feedforward neural network where each layer has a width of 128 and uses the ReLU activation function. The model weights are initialized using Glorot Uniform initialization as above.</p><pre><code class="language-julia">value = multilayer_perceptron(
    dobs,
    128,
    128,
    1;
    σ = Flux.relu,
    initb = Flux.glorot_uniform,
    initb_final = Flux.glorot_uniform,
    dtype = Float32
);</code></pre><p>Next, we set up the optimization pipeline for <code>value</code>. We use a mini-batch size of 64 and the <a href="https://arxiv.org/pdf/1412.6980.pdf">ADAM</a> optimizer. <code>FluxTrainer</code> is an iterator that loops on the model provided, performing a single step of gradient descent at each iteration. The result at each loop is passed to <code>stopcb</code> below, so you can quit after a number of epochs, convergence, or other criteria; here it&#39;s capped at two epochs using an anonymous function. See the documentation for <code>FluxTrainer</code> for more information.</p><pre><code class="language-julia">valueloss(bl, X, Y) = Flux.mse(vec(bl(X)), vec(Y))
valuetrainer = FluxTrainer(
    optimiser = ADAM(1e-3),
    szbatch = 64,
    lossfn = valueloss,
    stopcb = x -&gt; x.nepochs &gt; 2,
);</code></pre><p>The <code>NaturalPolicyGradient</code> iterator is a type that pre-allocates all necesary data structures and performs one gradient update to <code>policy</code> at each iteration. We first pass in a constructor that given <code>n</code> returns <code>n</code> instances of <code>LyceumMuJoCo.HopperV2</code>, all sharing the same <code>jlModel</code>, to allow <code>NaturalPolicyGradient</code> to allocate per-thread environments and enable performant, parallel sampling from <code>policy</code>. We then pass in the <code>policy</code>, <code>value</code>, and <code>valuetrainer</code> instances constructed above and override a few of the default <code>NaturalPolicyGradient</code> parameters: <code>gamma</code>, <code>gaelambda</code>, and <code>norm_step_size</code>. Finally, we set the max trajectory length <code>Hmax</code> and total number of samples per iteration, <code>N</code>. Under the hood, <code>NaturalPolicyGradient</code> will use approximately <code>div(N, Hmax)</code> threads to perform the sampling.</p><pre><code class="language-julia">npg = NaturalPolicyGradient(
    n -&gt; tconstruct(LyceumMuJoCo.HopperV2, n),
    policy,
    value,
    valuetrainer;
    gamma = 0.995,
    gaelambda = 0.97,
    norm_step_size = 0.05,
    Hmax = 1000,
    N = 10240,
);</code></pre><h3 id="Running-Experiments-1"><a class="docs-heading-anchor" href="#Running-Experiments-1">Running Experiments</a><a class="docs-heading-anchor-permalink" href="#Running-Experiments-1" title="Permalink"></a></h3><p>Finally, let&#39;s spin on our iterator 200 times, plotting every 20 iterations. This lets us break out of the loop if certain conditions are met, or re-start training manually if needed. We of course wish to track results, so we create a <code>ULogger</code> and <code>Experiment</code> to which we can save data. We also have useful timing information displayed every 20 iterations to better understand the performance of our algorithm and identify any potential bottlenecks. Rather than iterating on <code>npg</code> at the global scope, we&#39;ll do it inside of a function to avoid the performance issues associated with global variables as discussed in the <a href="https://docs.julialang.org/en/v1/manual/performance-tips/">Julia performance tips</a>. Note, to keep the Markdown version of this tutorial readable, we skip the plots and performance statistics. To enable them, simply call <code>hopper_NPG(npg, true)</code>.</p><pre><code class="language-julia">function hopper_NPG(npg::NaturalPolicyGradient, plot::Bool)
    exper = Experiment(&quot;/tmp/hopper_example.jlso&quot;, overwrite = true)
    # Walks, talks, and acts like a Julia logger. See the UniversalLogger.jl docs for more info.
    lg = ULogger()
    for (i, state) in enumerate(npg)
        if i &gt; 200
            # serialize some stuff and quit
            exper[:policy] = npg.policy
            exper[:value] = npg.value
            exper[:etype] = LyceumMuJoCo.HopperV2
            exper[:meanstates] = state.meanbatch
            exper[:stocstates] = state.stocbatch
            break
        end

        # log everything in `state` except meanbatch and stocbatch
        push!(lg, :algstate, filter_nt(state, exclude = (:meanbatch, :stocbatch)))

        if plot &amp;&amp; mod(i, 20) == 0
            x = lg[:algstate]
            # The following are helper functions for plotting to the terminal.
            # The first plot displays the `geteval` function for our stochastic
            # and mean policy rollouts.
            display(expplot(
                Line(x[:stocterminal_eval], &quot;StocLastE&quot;),
                Line(x[:meanterminal_eval], &quot;MeanLastE&quot;),
                title = &quot;Evaluation Score, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))
            # While the second one similarly plots `getreward`.
            display(expplot(
                Line(x[:stoctraj_reward], &quot;StocR&quot;),
                Line(x[:meantraj_reward], &quot;MeanR&quot;),
                title = &quot;Reward, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))

            # The following are timing values for various parts of the Natural Policy Gradient
            # algorithm at the last iteration, useful for finding performance bottlenecks
            # in the algorithm.
            println(&quot;elapsed_sampled  = &quot;, state.elapsed_sampled)
            println(&quot;elapsed_gradll   = &quot;, state.elapsed_gradll)
            println(&quot;elapsed_vpg      = &quot;, state.elapsed_vpg)
            println(&quot;elapsed_cg       = &quot;, state.elapsed_cg)
            println(&quot;elapsed_valuefit = &quot;, state.elapsed_valuefit)
        end
    end
    exper, lg
end
# Seed the per-thread global RNGs
seed_threadrngs!(1)
exper, lg = hopper_NPG(npg, false);</code></pre><p>Let&#39;s go ahead and plot the final reward trajectory for our stochastic and mean policies to see how we did:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_reward] lg[:algstate][:stoctraj_reward]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Reward&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip4600">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip4600)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip4601">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip4600)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip4602">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1483.58 2352.76,1483.58 
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1055.77 2352.76,1055.77 
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,627.958 2352.76,627.958 
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,200.147 2352.76,200.147 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1483.58 114.181,1483.58 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1055.77 114.181,1055.77 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,627.958 114.181,627.958 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,200.147 114.181,200.147 
  "/>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1501.08)" x="62.9921" y="1501.08">0</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1073.27)" x="62.9921" y="1073.27">500</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 645.458)" x="62.9921" y="645.458">1000</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 217.647)" x="62.9921" y="217.647">1500</text>
</g>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Reward</text>
</g>
<polyline clip-path="url(#clip4602)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1479.15 172.6,1478.56 183.341,1477.48 194.083,1476.22 204.824,1473.91 215.565,1468.53 226.306,1397.81 237.048,1217.98 247.789,1362.06 
  258.53,1354.41 269.272,1343.69 280.013,1281.94 290.754,1268.52 301.495,1248.79 312.237,1255.26 322.978,1237.15 333.719,1225.9 344.46,1236.18 355.202,1204.24 
  365.943,1206.07 376.684,1154.67 387.425,1148.64 398.167,1149.71 408.908,1116.89 419.649,648.137 430.391,648.697 441.132,648.971 451.873,650.868 462.614,651.614 
  473.356,651.407 484.097,653.026 494.838,1450.51 505.579,654.254 516.321,654.912 527.062,654.851 537.803,655.547 548.545,656.582 559.286,657.146 570.027,656.838 
  580.768,657.078 591.51,656.922 602.251,657.551 612.992,656.75 623.733,656.471 634.475,654.661 645.216,654.078 655.957,653.311 666.699,651.897 677.44,651.488 
  688.181,650.577 698.922,649.883 709.664,649.842 720.405,649.306 731.146,648.521 741.887,647.365 752.629,647.047 763.37,646.974 774.111,646.811 784.853,645.869 
  795.594,645.556 806.335,645.175 817.076,645.274 827.818,645.422 838.559,644.895 849.3,644.353 860.041,644.477 870.783,644.848 881.524,645.299 892.265,644.376 
  903.007,643.706 913.748,644.105 924.489,646.201 935.23,644.592 945.972,644.565 956.713,645.176 967.454,646.129 978.195,644.52 988.937,644.927 999.678,647.315 
  1010.42,648.546 1021.16,648.848 1031.9,648.647 1042.64,648.781 1053.38,648.716 1064.13,647.421 1074.87,646.238 1085.61,646.557 1096.35,961.746 1107.09,1023.97 
  1117.83,988.446 1128.57,1217.52 1139.31,1237.57 1150.06,983.242 1160.8,1011.03 1171.54,1233.32 1182.28,1000.09 1193.02,974.116 1203.76,1187.22 1214.5,1144.29 
  1225.24,979.863 1235.99,1155.81 1246.73,1187.11 1257.47,1181.53 1268.21,1189.91 1278.95,1189.02 1289.69,1155.75 1300.43,1100.08 1311.17,1122.61 1321.92,1117.38 
  1332.66,842.777 1343.4,965.874 1354.14,858.492 1364.88,949.564 1375.62,639.553 1386.36,840.3 1397.1,440.481 1407.85,794.901 1418.59,960.188 1429.33,558.34 
  1440.07,547.231 1450.81,560.954 1461.55,517.824 1472.29,543.656 1483.04,700.132 1493.78,996.205 1504.52,934.741 1515.26,988.615 1526,962.355 1536.74,535.91 
  1547.48,529.376 1558.22,514.508 1568.97,495.651 1579.71,480.22 1590.45,475.648 1601.19,904.486 1611.93,492.401 1622.67,504.196 1633.41,497.171 1644.15,492.775 
  1654.9,479.655 1665.64,477.757 1676.38,479.018 1687.12,461.781 1697.86,463.471 1708.6,459.905 1719.34,454.472 1730.08,442.591 1740.83,424.507 1751.57,956.574 
  1762.31,424.922 1773.05,426.535 1783.79,426.206 1794.53,411.868 1805.27,397.918 1816.01,382.319 1826.76,390.834 1837.5,361.326 1848.24,354.305 1858.98,334.404 
  1869.72,342.052 1880.46,347.866 1891.2,326.95 1901.94,312.037 1912.69,327.666 1923.43,320.477 1934.17,894.647 1944.91,705.957 1955.65,253.762 1966.39,288.708 
  1977.13,299.319 1987.87,299.584 1998.62,280.837 2009.36,287.244 2020.1,267.919 2030.84,722.055 2041.58,113.299 2052.32,764.523 2063.06,521.839 2073.81,240.576 
  2084.55,239.859 2095.29,264.748 2106.03,104.257 2116.77,699.519 2127.51,897.006 2138.25,781.721 2148.99,779.918 2159.74,870.456 2170.48,650.515 2181.22,813.996 
  2191.96,980.28 2202.7,651.24 2213.44,899.58 2224.18,956.093 2234.92,752.605 2245.67,733.311 2256.41,775.319 2267.15,735.516 2277.89,989.806 2288.63,761.978 
  
  "/>
<polyline clip-path="url(#clip4602)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1478.84 161.859,1478.38 172.6,1477.7 183.341,1476.84 194.083,1475.61 204.824,1473.81 215.565,1468.82 226.306,1452.49 237.048,1404.53 247.789,1377.84 
  258.53,1352.77 269.272,1341.09 280.013,1314.3 290.754,1312.85 301.495,1269.34 312.237,1262.4 322.978,1272.95 333.719,1244.38 344.46,1265.53 355.202,1220.89 
  365.943,1217.95 376.684,1155.15 387.425,1136.28 398.167,1130.71 408.908,1046.43 419.649,833.002 430.391,870.353 441.132,705.307 451.873,648.986 462.614,652.028 
  473.356,651.283 484.097,779.361 494.838,1417.25 505.579,1205.33 516.321,720.548 527.062,650.144 537.803,1190.55 548.545,1018.63 559.286,969.36 570.027,1020.23 
  580.768,658.07 591.51,844.761 602.251,718.967 612.992,718.695 623.733,877.357 634.475,803.463 645.216,828.615 655.957,649.715 666.699,696.008 677.44,907.006 
  688.181,930.392 698.922,891.086 709.664,733.369 720.405,860.135 731.146,979.718 741.887,959.402 752.629,992.127 763.37,1030.2 774.111,996.481 784.853,985.933 
  795.594,830.916 806.335,1020.64 817.076,1077.87 827.818,976.059 838.559,998.893 849.3,984.192 860.041,1017.17 870.783,973.796 881.524,1050.89 892.265,1048.31 
  903.007,1040.46 913.748,1048.02 924.489,1028.06 935.23,1032.59 945.972,1044.38 956.713,1047.02 967.454,1054.26 978.195,1061.3 988.937,1054.67 999.678,1036.84 
  1010.42,1066.31 1021.16,1074.86 1031.9,1036.84 1042.64,1036.01 1053.38,1029.42 1064.13,1005.74 1074.87,1027.1 1085.61,1006.24 1096.35,1022.74 1107.09,1034.63 
  1117.83,1044.96 1128.57,1043.04 1139.31,1046.98 1150.06,1034.35 1160.8,1028.33 1171.54,1013.97 1182.28,1033.1 1193.02,1055.29 1203.76,1060.49 1214.5,1085.94 
  1225.24,1033.75 1235.99,1047.01 1246.73,1022.88 1257.47,1006.88 1268.21,1019.64 1278.95,1009.37 1289.69,1005.02 1300.43,989.028 1311.17,987.107 1321.92,1000.35 
  1332.66,1057.01 1343.4,1004.56 1354.14,977.557 1364.88,941.473 1375.62,928.754 1386.36,917.369 1397.1,947.68 1407.85,901.212 1418.59,901.096 1429.33,1014.02 
  1440.07,936.355 1450.81,857.451 1461.55,955.356 1472.29,915.79 1483.04,921.5 1493.78,928.6 1504.52,911.122 1515.26,956.545 1526,909.993 1536.74,935.02 
  1547.48,908.351 1558.22,839.832 1568.97,789.34 1579.71,949.035 1590.45,892.047 1601.19,904.015 1611.93,938.718 1622.67,785.773 1633.41,681.382 1644.15,904.275 
  1654.9,819.169 1665.64,803.468 1676.38,769.839 1687.12,780.869 1697.86,769.633 1708.6,719.605 1719.34,759.438 1730.08,854.236 1740.83,860.812 1751.57,1018.57 
  1762.31,903.216 1773.05,697.676 1783.79,825.522 1794.53,651.669 1805.27,716.527 1816.01,701.502 1826.76,628.995 1837.5,680.641 1848.24,593.046 1858.98,585.071 
  1869.72,732.769 1880.46,686.547 1891.2,719.151 1901.94,775.613 1912.69,795.988 1923.43,807.051 1934.17,607.436 1944.91,850.451 1955.65,971.101 1966.39,761.879 
  1977.13,831.914 1987.87,748.745 1998.62,777.047 2009.36,639.602 2020.1,698.135 2030.84,715.085 2041.58,710.161 2052.32,945.389 2063.06,831.32 2073.81,694.306 
  2084.55,708.105 2095.29,615.233 2106.03,582.492 2116.77,704.96 2127.51,763.501 2138.25,767.249 2148.99,699.634 2159.74,677.82 2170.48,640.306 2181.22,653.679 
  2191.96,706.272 2202.7,628.167 2213.44,655.521 2224.18,695.215 2234.92,599.931 2245.67,656.077 2256.41,688.052 2267.15,737.661 2277.89,738.092 2288.63,759.748 
  
  "/>
<path clip-path="url(#clip4600)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip4600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip4600)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip4600)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip4600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>We&#39;ll also plot the evaluations:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_eval] lg[:algstate][:stoctraj_eval]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Eval&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip5200">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip5200)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip5201">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip5200)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip5202">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1478.94 2352.76,1478.94 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1161.72 2352.76,1161.72 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,844.5 2352.76,844.5 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,527.281 2352.76,527.281 
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,210.062 2352.76,210.062 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1478.94 114.181,1478.94 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1161.72 114.181,1161.72 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,844.5 114.181,844.5 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,527.281 114.181,527.281 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,210.062 114.181,210.062 
  "/>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1496.44)" x="62.9921" y="1496.44">0</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1179.22)" x="62.9921" y="1179.22">500</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 862)" x="62.9921" y="862">1000</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 544.781)" x="62.9921" y="544.781">1500</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 227.562)" x="62.9921" y="227.562">2000</text>
</g>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Eval</text>
</g>
<polyline clip-path="url(#clip5202)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1478.97 161.859,1478.98 172.6,1478.97 183.341,1478.97 194.083,1478.96 204.824,1478.96 215.565,1478.94 226.306,1479.74 237.048,1448.91 247.789,1469.36 
  258.53,1468.24 269.272,1467.27 280.013,1459.99 290.754,1453.39 301.495,1448.67 312.237,1448.44 322.978,1443.14 333.719,1438.71 344.46,1440.56 355.202,1432.45 
  365.943,1433.27 376.684,1420.13 387.425,1416.31 398.167,1415.6 408.908,1406.87 419.649,1279.84 430.391,1285.56 441.132,1285.65 451.873,1293.25 462.614,1299.66 
  473.356,1299.15 484.097,1304.43 494.838,1478.46 505.579,1309.13 516.321,1312.94 527.062,1315.41 537.803,1317.18 548.545,1321.11 559.286,1323 570.027,1320.51 
  580.768,1321.25 591.51,1319.2 602.251,1320.69 612.992,1319.06 623.733,1317.3 634.475,1311.42 645.216,1309.41 655.957,1305.45 666.699,1298.99 677.44,1297.18 
  688.181,1293.58 698.922,1289.5 709.664,1289.55 720.405,1287.08 731.146,1282.61 741.887,1276.99 752.629,1275.26 763.37,1274.8 774.111,1273.53 784.853,1269.34 
  795.594,1267.68 806.335,1265.07 817.076,1264.04 827.818,1264.65 838.559,1263.01 849.3,1260.07 860.041,1259.61 870.783,1262.75 881.524,1265.29 892.265,1261.81 
  903.007,1259.27 913.748,1261.25 924.489,1269.57 935.23,1260.91 945.972,1261.17 956.713,1262.86 967.454,1266.87 978.195,1260.17 988.937,1261.79 999.678,1272.47 
  1010.42,1277.27 1021.16,1278.45 1031.9,1278.53 1042.64,1279.42 1053.38,1280.13 1064.13,1273.77 1074.87,1269.38 1085.61,1270.29 1096.35,1352.31 1107.09,1371.56 
  1117.83,1358.12 1128.57,1430.71 1139.31,1436.8 1150.06,1357.03 1160.8,1364.37 1171.54,1436.02 1182.28,1362.28 1193.02,1354.18 1203.76,1422.91 1214.5,1405.38 
  1225.24,1356.04 1235.99,1409.86 1246.73,1423.95 1257.47,1422.43 1268.21,1423.72 1278.95,1424.2 1289.69,1411.62 1300.43,1392.48 1311.17,1398.92 1321.92,1392.75 
  1332.66,1291.93 1343.4,1315.32 1354.14,1294.34 1364.88,1337.98 1375.62,1142.34 1386.36,1273.09 1397.1,975.058 1407.85,1240.49 1418.59,1337.61 1429.33,1020.51 
  1440.07,988.358 1450.81,1026.56 1461.55,986.977 1472.29,974.608 1483.04,1169.36 1493.78,1352.04 1504.52,1311.77 1515.26,1345.8 1526,1328.01 1536.74,951.655 
  1547.48,938.226 1558.22,878.727 1568.97,842.08 1579.71,808.918 1590.45,780.673 1601.19,1236.02 1611.93,836.222 1622.67,869.515 1633.41,819.309 1644.15,818.811 
  1654.9,792.813 1665.64,793.821 1676.38,799.257 1687.12,757.543 1697.86,759.6 1708.6,737.578 1719.34,747.877 1730.08,735.078 1740.83,662.957 1751.57,1313.33 
  1762.31,667.907 1773.05,670.469 1783.79,664.825 1794.53,638.214 1805.27,602.774 1816.01,560.851 1826.76,591.031 1837.5,506.898 1848.24,495.599 1858.98,443.836 
  1869.72,497.378 1880.46,511.471 1891.2,453.497 1901.94,424.136 1912.69,454.863 1923.43,412.788 1934.17,1296.88 1944.91,1040.1 1955.65,265.491 1966.39,323.964 
  1977.13,371.368 1987.87,365.675 1998.62,344.013 2009.36,323.672 2020.1,260.71 2030.84,1132.5 2041.58,238.682 2052.32,1160.31 2063.06,891.008 2073.81,217.756 
  2084.55,151.116 2095.29,246.426 2106.03,104.257 2116.77,1088.44 2127.51,1272.41 2138.25,1175.38 2148.99,1179.69 2159.74,1262.76 2170.48,967.478 2181.22,1187.39 
  2191.96,1331.93 2202.7,1065.86 2213.44,1274.07 2224.18,1328.92 2234.92,1164.89 2245.67,1139.72 2256.41,1180.96 2267.15,1141.41 2277.89,1341.16 2288.63,1164.91 
  
  "/>
<polyline clip-path="url(#clip5202)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1478.98 161.859,1478.98 172.6,1478.98 183.341,1478.98 194.083,1478.98 204.824,1478.99 215.565,1478.89 226.306,1477.95 237.048,1474.24 247.789,1471.92 
  258.53,1469.04 269.272,1466.91 280.013,1461.08 290.754,1460.06 301.495,1450.34 312.237,1448.11 322.978,1449.1 333.719,1441.45 344.46,1445.95 355.202,1435.31 
  365.943,1435.86 376.684,1418.8 387.425,1410.7 398.167,1408.78 408.908,1385.35 419.649,1330.15 430.391,1338.88 441.132,1291.95 451.873,1283.96 462.614,1295.65 
  473.356,1291.36 484.097,1326.79 494.838,1472.62 505.579,1428.14 516.321,1312.9 527.062,1302 537.803,1427.32 548.545,1395.38 559.286,1383.66 570.027,1390.07 
  580.768,1312.93 591.51,1350.43 602.251,1322.83 612.992,1322.1 623.733,1351.91 634.475,1330.68 645.216,1335.51 655.957,1284.83 666.699,1288.21 677.44,1349.91 
  688.181,1352.8 698.922,1344.29 709.664,1294 720.405,1328.36 731.146,1363.08 741.887,1355 752.629,1364.33 763.37,1376.7 774.111,1364.61 784.853,1361.46 
  795.594,1307.18 806.335,1369.96 817.076,1388.79 827.818,1356.25 838.559,1363.62 849.3,1356.59 860.041,1368.64 870.783,1354.35 881.524,1380.91 892.265,1379.74 
  903.007,1376.26 913.748,1380.03 924.489,1373.25 935.23,1372.71 945.972,1376.48 956.713,1377.17 967.454,1378.99 978.195,1382.49 988.937,1379.89 999.678,1373 
  1010.42,1380.62 1021.16,1384.14 1031.9,1375.42 1042.64,1375.21 1053.38,1372.06 1064.13,1365.24 1074.87,1372.69 1085.61,1365.12 1096.35,1368.8 1107.09,1373.74 
  1117.83,1377.12 1128.57,1376.34 1139.31,1375.47 1150.06,1372.21 1160.8,1368.61 1171.54,1364.75 1182.28,1372.07 1193.02,1377.53 1203.76,1380.66 1214.5,1386.68 
  1225.24,1369.62 1235.99,1374.37 1246.73,1367.31 1257.47,1362.28 1268.21,1366.72 1278.95,1360.01 1289.69,1357.8 1300.43,1352.98 1311.17,1348.47 1321.92,1347.99 
  1332.66,1365.33 1343.4,1349.09 1354.14,1342.51 1364.88,1329.03 1375.62,1314.14 1386.36,1307.92 1397.1,1323.86 1407.85,1294.29 1418.59,1304.44 1429.33,1348.96 
  1440.07,1291.05 1450.81,1265.26 1461.55,1327.05 1472.29,1302.82 1483.04,1294.89 1493.78,1305.05 1504.52,1293.42 1515.26,1319.6 1526,1290.39 1536.74,1296.11 
  1547.48,1268.96 1558.22,1219.36 1568.97,1161.17 1579.71,1258.07 1590.45,1246.24 1601.19,1269.6 1611.93,1291.22 1622.67,1200.47 1633.41,1086.05 1644.15,1240.29 
  1654.9,1179.24 1665.64,1139.6 1676.38,1114.96 1687.12,1133.74 1697.86,1131.91 1708.6,1116.46 1719.34,1128.41 1730.08,1156.32 1740.83,1129.25 1751.57,1249.32 
  1762.31,1211.74 1773.05,1090.52 1783.79,1192.36 1794.53,986.476 1805.27,1036.3 1816.01,1004.87 1826.76,951.156 1837.5,979.751 1848.24,974.239 1858.98,924.958 
  1869.72,1088.19 1880.46,1053.89 1891.2,1052.39 1901.94,1088.97 1912.69,1098.64 1923.43,1159.57 1934.17,940.155 1944.91,1171.01 1955.65,1215.23 1966.39,1112.78 
  1977.13,1154.7 1987.87,1149.63 1998.62,1164.21 2009.36,1004.74 2020.1,1003.18 2030.84,1078.13 2041.58,1032.13 2052.32,1235.58 2063.06,1147.57 2073.81,1062.68 
  2084.55,1101.93 2095.29,956.96 2106.03,924.587 2116.77,1069.55 2127.51,1086.13 2138.25,1075.61 2148.99,1027.84 2159.74,1033.82 2170.48,938.728 2181.22,982.856 
  2191.96,1093.57 2202.7,996.996 2213.44,1051.61 2224.18,1110.31 2234.92,965.391 2245.67,1044.81 2256.41,1060.03 2267.15,1134.28 2277.89,1145.22 2288.63,1171.59 
  
  "/>
<path clip-path="url(#clip5200)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip5200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip5200)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip5200)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip5200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>Finally, we save the logged results to <code>exper</code> for later review:</p><pre><code class="language-julia">exper[:logs] = get(lg)
finish!(exper); # flushes everything to disk</code></pre><pre><code class="language-none">[ Info: Experiment saved to /tmp/hopper_example.jlso</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../humanoid/">Creating a MuJoCo Environment »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 15 January 2020 01:27">Wednesday 15 January 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
