<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Learning a control policy · Lyceum</title><link rel="canonical" href="https://docs.lyceum.ml/dev/examples/NPG/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Lyceum</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../humanoid/">Creating a MuJoCo Environment</a></li><li class="is-active"><a class="tocitem" href>Learning a control policy</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#The-Code-1"><span>The Code</span></a></li></ul></li><li><a class="tocitem" href="../visualize/">Using the visualizer</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Learning a control policy</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Learning a control policy</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/docs/src/examples/NPG.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Running examples locally</header><div class="admonition-body"><p>This example and more are also available as Julia scripts and Jupyter notebooks.</p><p>See <a href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/example_howto.md">the how-to page</a> for more information.</p></div></div><h1 id="Learning-a-control-policy-1"><a class="docs-heading-anchor" href="#Learning-a-control-policy-1">Learning a control policy</a><a class="docs-heading-anchor-permalink" href="#Learning-a-control-policy-1" title="Permalink"></a></h1><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>In this example we walk through the process of setting up an experiment that runs <a href="https://papers.nips.cc/paper/2073-a-natural-policy-gradient.pdf">Natural Policy Gradient</a> (or more recently <a href="https://arxiv.org/pdf/1703.02660.pdf">in this work</a>). This is an on-policy reinforcement learning method that is comparable to TRPO, PPO, and other policy gradient methods. See the documentation for <code>NaturalPolicyGradient</code> for full implementation details.</p><h2 id="The-Code-1"><a class="docs-heading-anchor" href="#The-Code-1">The Code</a><a class="docs-heading-anchor-permalink" href="#The-Code-1" title="Permalink"></a></h2><p>First, let&#39;s go head and grab all the dependencies:</p><pre><code class="language-julia">using LinearAlgebra, Random, Statistics # From Stdlib
using LyceumAI                          # For the NPG controller
using LyceumMuJoCo                      # For the Hopper environment
using LyceumBase.Tools                  # For the ControllerIterator discussed below
using Flux                              # For our neural networks needs
using UniversalLogger                   # For logging experiment data
using Plots                             # For plotting the results</code></pre><p>We first instantiate a <code>HopperV2</code> environment to grab useful environment-specific values, such as the size of the observation and action vectors:</p><pre><code class="language-julia">env = LyceumMuJoCo.HopperV2();
dobs, dact = length(obsspace(env)), length(actionspace(env));</code></pre><h3 id="Policy-Gradient-Components-1"><a class="docs-heading-anchor" href="#Policy-Gradient-Components-1">Policy Gradient Components</a><a class="docs-heading-anchor-permalink" href="#Policy-Gradient-Components-1" title="Permalink"></a></h3><p>Policy Gradient methods require a policy: a function that takes in the state/observations of the agent, and outputs an action i.e. <code>action = π(obs)</code>. In much of Deep RL, the policy takes the form of a neural network which can be built on top of the <a href="https://github.com/FluxML/Flux.jl">Flux.jl</a> library. We utilize a stochastic policy in this example. Specifically, our policy is represented as a multivariate Gaussian distribution of the form:</p><div>\[\pi(a | s) = \mathcal{N}(\mu_{\theta_1}(\text{obs}), \Sigma_{\theta_2})\]</div><p>where <span>$\mu_{\theta_1}$</span> is a neural network, parameterized by <span>$\theta_1$</span>, that maps an observation <code>obs</code> to a mean action and <span>$\Sigma_{\theta_2}$</span> is a diagonal covariance matrix parameterized by <span>$\theta_2$</span>, the diagonal entries of the matrix. For <span>$\mu_{\theta_1}$</span> we utilize a 2-layer neural network, where each layer has a &quot;width&quot; of 32. We use tanh activations for each hidden layer and initialize the network weights with Glorot Uniform initializations. Rather than tracking <span>$\Sigma_{\theta_2}$</span> directly, we track the log standard deviations, which are easier to learn. We initialize <span>$\log \text{diag}(\Sigma_{\theta_2})$</span> as <code>zeros(dact)</code>, i.e. a <code>Vector</code> of length <code>dact</code>, initialized to 0. Both <span>$\theta_1$</span> and <span>$\theta_2$</span> are learned in this example. Note that <span>$\mu_{\theta_1}$</span> is a <em>state-dependent</em> mean while <span>$\Sigma_{\theta_2}$</span> is a <em>global</em> covariance.</p><pre><code class="language-julia">policy = DiagGaussianPolicy(
    multilayer_perceptron(
        dobs,
        32,
        32,
        dact;
        σ = tanh,
        initb = Flux.glorot_uniform,
        initb_final = Flux.glorot_uniform,
        dtype = Float32,
    ),
    zeros(Float32, dact),
);</code></pre><p>This NPG implementation uses <a href="https://arxiv.org/pdf/1506.02438.pdf">Generalized Advantaged Estimation</a>, which requires an estimate of the value function, <code>value(state)</code>, which we represent using a 2-layer, feedforward neural network where each layer has a width of 128 and uses the ReLU activation function. The model weights are initialized using Glorot Uniform initialization as above.</p><pre><code class="language-julia">value = multilayer_perceptron(
    dobs,
    128,
    128,
    1;
    σ = Flux.relu,
    initb = Flux.glorot_uniform,
    initb_final = Flux.glorot_uniform,
    dtype = Float32,
);</code></pre><p>Next, we set up the optimization pipeline for <code>value</code>. We use a mini-batch size of 64 and the <a href="https://arxiv.org/pdf/1412.6980.pdf">ADAM</a> optimizer. <code>FluxTrainer</code> is an iterator that loops on the model provided, performing a single step of gradient descent at each iteration. The result at each loop is passed to <code>stopcb</code> below, so you can quit after a number of epochs, convergence, or other criteria; here it&#39;s capped at two epochs using an anonymous function. See the documentation for <code>FluxTrainer</code> for more information.</p><pre><code class="language-julia">valueloss(bl, X, Y) = Flux.mse(vec(bl(X)), vec(Y))
valuetrainer = FluxTrainer(
    optimiser = ADAM(1e-3),
    szbatch = 64,
    lossfn = valueloss,
    stopcb = x -&gt; x.nepochs &gt; 2,
);</code></pre><p>The <code>NaturalPolicyGradient</code> iterator is a type that pre-allocates all necesary data structures and performs one gradient update to <code>policy</code> at each iteration. We first pass in a constructor that given <code>n</code> returns <code>n</code> instances of <code>LyceumMuJoCo.HopperV2</code>, all sharing the same <code>jlModel</code>, to allow <code>NaturalPolicyGradient</code> to allocate per-thread environments and enable performant, parallel sampling from <code>policy</code>. We then pass in the <code>policy</code>, <code>value</code>, and <code>valuetrainer</code> instances constructed above and override a few of the default <code>NaturalPolicyGradient</code> parameters: <code>gamma</code>, <code>gaelambda</code>, and <code>norm_step_size</code>. Finally, we set the max trajectory length <code>Hmax</code> and total number of samples per iteration, <code>N</code>. Under the hood, <code>NaturalPolicyGradient</code> will use approximately <code>div(N, Hmax)</code> threads to perform the sampling.</p><pre><code class="language-julia">npg = NaturalPolicyGradient(
    n -&gt; tconstruct(LyceumMuJoCo.HopperV2, n),
    policy,
    value,
    valuetrainer;
    gamma = 0.995,
    gaelambda = 0.97,
    norm_step_size = 0.05,
    Hmax = 1000,
    N = 10240,
);</code></pre><h3 id="Running-Experiments-1"><a class="docs-heading-anchor" href="#Running-Experiments-1">Running Experiments</a><a class="docs-heading-anchor-permalink" href="#Running-Experiments-1" title="Permalink"></a></h3><p>Finally, let&#39;s spin on our iterator 200 times, plotting every 20 iterations. This lets us break out of the loop if certain conditions are met, or re-start training manually if needed. We of course wish to track results, so we create a <code>ULogger</code> and <code>Experiment</code> to which we can save data. We also have useful timing information displayed every 20 iterations to better understand the performance of our algorithm and identify any potential bottlenecks. Rather than iterating on <code>npg</code> at the global scope, we&#39;ll do it inside of a function to avoid the performance issues associated with global variables as discussed in the <a href="https://docs.julialang.org/en/v1/manual/performance-tips/">Julia performance tips</a>. Note, to keep the Markdown version of this tutorial readable, we skip the plots and performance statistics. To enable them, simply call <code>hopper_NPG(npg, true)</code>.</p><pre><code class="language-julia">function hopper_NPG(npg::NaturalPolicyGradient, plot::Bool)
    exper = Experiment(&quot;/tmp/hopper_example.jlso&quot;, overwrite = true)
    # Walks, talks, and acts like a Julia logger. See the UniversalLogger.jl docs for more info.
    lg = ULogger()
    for (i, state) in enumerate(npg)
        if i &gt; 200
            # serialize some stuff and quit
            exper[:policy] = npg.policy
            exper[:value] = npg.value
            exper[:etype] = LyceumMuJoCo.HopperV2
            exper[:meanstates] = state.meanbatch
            exper[:stocstates] = state.stocbatch
            break
        end

        # log everything in `state` except meanbatch and stocbatch
        push!(lg, :algstate, filter_nt(state, exclude = (:meanbatch, :stocbatch)))

        if plot &amp;&amp; mod(i, 20) == 0
            x = lg[:algstate]
            # The following are helper functions for plotting to the terminal.
            # The first plot displays the `geteval` function for our stochastic
            # and mean policy rollouts.
            display(expplot(
                Line(x[:stocterminal_eval], &quot;StocLastE&quot;),
                Line(x[:meanterminal_eval], &quot;MeanLastE&quot;),
                title = &quot;Evaluation Score, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))
            # While the second one similarly plots `getreward`.
            display(expplot(
                Line(x[:stoctraj_reward], &quot;StocR&quot;),
                Line(x[:meantraj_reward], &quot;MeanR&quot;),
                title = &quot;Reward, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))

            # The following are timing values for various parts of the Natural Policy Gradient
            # algorithm at the last iteration, useful for finding performance bottlenecks
            # in the algorithm.
            println(&quot;elapsed_sampled  = &quot;, state.elapsed_sampled)
            println(&quot;elapsed_gradll   = &quot;, state.elapsed_gradll)
            println(&quot;elapsed_vpg      = &quot;, state.elapsed_vpg)
            println(&quot;elapsed_cg       = &quot;, state.elapsed_cg)
            println(&quot;elapsed_valuefit = &quot;, state.elapsed_valuefit)
        end
    end
    exper, lg
end
# Seed the per-thread global RNGs
seed_threadrngs!(1)
exper, lg = hopper_NPG(npg, false);</code></pre><p>Let&#39;s go ahead and plot the final reward trajectory for our stochastic and mean policies to see how we did:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_reward] lg[:algstate][:stoctraj_reward]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Reward&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip7700">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip7700)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip7701">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip7700)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip7702">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1483.08 2352.76,1483.08 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1203.25 2352.76,1203.25 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,923.424 2352.76,923.424 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,643.594 2352.76,643.594 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,363.764 2352.76,363.764 
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,83.9335 2352.76,83.9335 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1483.08 114.181,1483.08 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1203.25 114.181,1203.25 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,923.424 114.181,923.424 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,643.594 114.181,643.594 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,363.764 114.181,363.764 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,83.9335 114.181,83.9335 
  "/>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1500.58)" x="62.9921" y="1500.58">0</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1220.75)" x="62.9921" y="1220.75">500</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 940.924)" x="62.9921" y="940.924">1000</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 661.094)" x="62.9921" y="661.094">1500</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 381.264)" x="62.9921" y="381.264">2000</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 101.434)" x="62.9921" y="101.434">2500</text>
</g>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Reward</text>
</g>
<polyline clip-path="url(#clip7702)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1479.06 172.6,1477.99 183.341,1475.19 194.083,1457.2 204.824,1458.98 215.565,1435.94 226.306,1388.1 237.048,1386.43 247.789,1383.3 
  258.53,1370.69 269.272,1364.67 280.013,1365.68 290.754,1398.58 301.495,1362.84 312.237,1346.95 322.978,1322.06 333.719,1280.93 344.46,1222.65 355.202,1052.44 
  365.943,1241.13 376.684,1157.59 387.425,1246.6 398.167,1347.77 408.908,1251.16 419.649,468.626 430.391,1341.43 441.132,1357.09 451.873,1272.9 462.614,1332.73 
  473.356,561.911 484.097,490.706 494.838,440.705 505.579,442.665 516.321,504.947 527.062,468.292 537.803,424.973 548.545,419.623 559.286,367.926 570.027,434.236 
  580.768,480.633 591.51,403.112 602.251,392.751 612.992,424.454 623.733,350.09 634.475,437.115 645.216,499.19 655.957,530.648 666.699,471.913 677.44,446.945 
  688.181,410.255 698.922,404.908 709.664,398.237 720.405,388.673 731.146,352.006 741.887,310.16 752.629,372.875 763.37,402.111 774.111,515.166 784.853,485.228 
  795.594,459.848 806.335,398.763 817.076,340.759 827.818,151.801 838.559,148.792 849.3,148.782 860.041,115.213 870.783,111.077 881.524,145.143 892.265,145.944 
  903.007,183.086 913.748,137.875 924.489,124.846 935.23,159.129 945.972,110.903 956.713,113.711 967.454,142.563 978.195,151.688 988.937,209.622 999.678,199.731 
  1010.42,213.992 1021.16,141.67 1031.9,104.257 1042.64,169.372 1053.38,158.624 1064.13,205.76 1074.87,195.907 1085.61,227.952 1096.35,196.973 1107.09,249.042 
  1117.83,269.975 1128.57,273.503 1139.31,199.053 1150.06,249.741 1160.8,261.47 1171.54,164.625 1182.28,165.381 1193.02,254.518 1203.76,275.891 1214.5,270.822 
  1225.24,220.352 1235.99,209.32 1246.73,246.614 1257.47,228.453 1268.21,187.217 1278.95,179.852 1289.69,211.856 1300.43,1376.68 1311.17,1347.19 1321.92,1359.17 
  1332.66,1347.91 1343.4,1341.74 1354.14,251.589 1364.88,234.802 1375.62,241.219 1386.36,248.117 1397.1,283.514 1407.85,272.417 1418.59,329.55 1429.33,324.585 
  1440.07,311.038 1450.81,302.852 1461.55,296.122 1472.29,1332.72 1483.04,1330.45 1493.78,1330.91 1504.52,1330.33 1515.26,243.117 1526,246.557 1536.74,234.164 
  1547.48,224.818 1558.22,224.275 1568.97,246.759 1579.71,206.403 1590.45,198.583 1601.19,235.047 1611.93,245.951 1622.67,276.498 1633.41,264.243 1644.15,244.611 
  1654.9,229.961 1665.64,235.937 1676.38,206.789 1687.12,206.72 1697.86,194.777 1708.6,207.262 1719.34,194.702 1730.08,209.861 1740.83,176.114 1751.57,179.761 
  1762.31,233.625 1773.05,226.538 1783.79,239.484 1794.53,260.365 1805.27,252.466 1816.01,264.574 1826.76,291.481 1837.5,292.352 1848.24,308.306 1858.98,307.302 
  1869.72,315.093 1880.46,303.666 1891.2,309.674 1901.94,308.207 1912.69,308.718 1923.43,307.735 1934.17,304.46 1944.91,301.035 1955.65,302.518 1966.39,280.683 
  1977.13,308.513 1987.87,274.201 1998.62,291.725 2009.36,287.164 2020.1,260.384 2030.84,245.727 2041.58,262.124 2052.32,275.102 2063.06,281.832 2073.81,291.668 
  2084.55,280.93 2095.29,305.679 2106.03,289.866 2116.77,314.892 2127.51,310.763 2138.25,291.022 2148.99,277.578 2159.74,264.606 2170.48,294.847 2181.22,300.409 
  2191.96,298.543 2202.7,305.144 2213.44,303.309 2224.18,311.513 2234.92,325.01 2245.67,334.452 2256.41,342.998 2267.15,340.831 2277.89,350.631 2288.63,337.119 
  
  "/>
<polyline clip-path="url(#clip7702)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1478.63 161.859,1477.71 172.6,1476.2 183.341,1470.8 194.083,1462.09 204.824,1447.34 215.565,1432.9 226.306,1408.29 237.048,1392.57 247.789,1381.81 
  258.53,1374.28 269.272,1371.08 280.013,1361.88 290.754,1378.28 301.495,1348.13 312.237,1342.1 322.978,1325.81 333.719,1296.26 344.46,1280.36 355.202,1263.31 
  365.943,1226.75 376.684,1248.99 387.425,1259.56 398.167,1228.84 408.908,1219.11 419.649,1149.59 430.391,1232.73 441.132,1219.26 451.873,1074.09 462.614,1045.09 
  473.356,1125.36 484.097,1082.94 494.838,1000.28 505.579,1002.65 516.321,1077.45 527.062,888.027 537.803,954.747 548.545,872.298 559.286,855.34 570.027,663.223 
  580.768,744.686 591.51,738.469 602.251,719.421 612.992,847.507 623.733,803.566 634.475,700.105 645.216,778.947 655.957,575.929 666.699,813.042 677.44,595.365 
  688.181,621.799 698.922,582.693 709.664,454.427 720.405,566.526 731.146,425.955 741.887,557.059 752.629,480.667 763.37,547.612 774.111,750.697 784.853,556.465 
  795.594,465.804 806.335,702.176 817.076,595.126 827.818,498.546 838.559,522.406 849.3,307.343 860.041,198.539 870.783,548.696 881.524,296.94 892.265,632.021 
  903.007,526.238 913.748,595.203 924.489,386.536 935.23,652.208 945.972,298.288 956.713,470.889 967.454,458.527 978.195,298.312 988.937,572.633 999.678,402.562 
  1010.42,215.003 1021.16,268.163 1031.9,395.114 1042.64,611.15 1053.38,462.943 1064.13,579.386 1074.87,493.33 1085.61,480.991 1096.35,232.009 1107.09,427.736 
  1117.83,412.011 1128.57,740.719 1139.31,478.171 1150.06,330.401 1160.8,434.171 1171.54,375.393 1182.28,455.158 1193.02,491.979 1203.76,254.721 1214.5,423.403 
  1225.24,272.555 1235.99,455.164 1246.73,541.976 1257.47,531.613 1268.21,724.154 1278.95,526.866 1289.69,479.961 1300.43,247.147 1311.17,367.794 1321.92,552.31 
  1332.66,703.479 1343.4,577.182 1354.14,678.272 1364.88,246.755 1375.62,275.369 1386.36,709.814 1397.1,500.694 1407.85,469.724 1418.59,276.259 1429.33,265.587 
  1440.07,755.873 1450.81,424.786 1461.55,779.065 1472.29,714.289 1483.04,663.423 1493.78,705.007 1504.52,749.734 1515.26,675.043 1526,401.725 1536.74,594.68 
  1547.48,282.82 1558.22,532.662 1568.97,602.72 1579.71,575.978 1590.45,376.131 1601.19,295.144 1611.93,171.76 1622.67,221.717 1633.41,223.601 1644.15,318.188 
  1654.9,156.065 1665.64,395.282 1676.38,371.012 1687.12,380.043 1697.86,705.756 1708.6,455.78 1719.34,358.243 1730.08,302.052 1740.83,286.773 1751.57,291.338 
  1762.31,233.01 1773.05,215.862 1783.79,236.233 1794.53,348.488 1805.27,454.95 1816.01,273.959 1826.76,372.079 1837.5,476.233 1848.24,482.748 1858.98,397.525 
  1869.72,473.087 1880.46,373.237 1891.2,482.732 1901.94,675.508 1912.69,614.228 1923.43,547.143 1934.17,609.877 1944.91,607.846 1955.65,546.147 1966.39,366.091 
  1977.13,671.089 1987.87,802.171 1998.62,375.46 2009.36,266.017 2020.1,258.483 2030.84,517.064 2041.58,445.849 2052.32,798.433 2063.06,867.026 2073.81,466.194 
  2084.55,384.433 2095.29,483.195 2106.03,380.51 2116.77,277.95 2127.51,277.699 2138.25,260.895 2148.99,366.534 2159.74,354.261 2170.48,611.857 2181.22,548.253 
  2191.96,478.265 2202.7,558.16 2213.44,561.667 2224.18,492.781 2234.92,299.95 2245.67,429.263 2256.41,434.005 2267.15,333.279 2277.89,442.282 2288.63,337.82 
  
  "/>
<path clip-path="url(#clip7700)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip7700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip7700)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip7700)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip7700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>We&#39;ll also plot the evaluations:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_eval] lg[:algstate][:stoctraj_eval]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Eval&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip8300">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip8300)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip8301">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip8300)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip8302">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1479.72 2352.76,1479.72 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1232.66 2352.76,1232.66 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,985.597 2352.76,985.597 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,738.537 2352.76,738.537 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,491.477 2352.76,491.477 
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,244.417 2352.76,244.417 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1479.72 114.181,1479.72 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1232.66 114.181,1232.66 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,985.597 114.181,985.597 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,738.537 114.181,738.537 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,491.477 114.181,491.477 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,244.417 114.181,244.417 
  "/>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1497.22)" x="62.9921" y="1497.22">0</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1250.16)" x="62.9921" y="1250.16">1000</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1003.1)" x="62.9921" y="1003.1">2000</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 756.037)" x="62.9921" y="756.037">3000</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 508.977)" x="62.9921" y="508.977">4000</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 261.917)" x="62.9921" y="261.917">5000</text>
</g>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Eval</text>
</g>
<polyline clip-path="url(#clip8302)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1479.74 172.6,1479.73 183.341,1479.72 194.083,1479.4 204.824,1479.45 215.565,1478.22 226.306,1473.57 237.048,1473.54 247.789,1473.21 
  258.53,1471.39 269.272,1470.75 280.013,1471.14 290.754,1475.22 301.495,1470.47 312.237,1467.33 322.978,1463.6 333.719,1454.08 344.46,1442.73 355.202,1378.94 
  365.943,1443.19 376.684,1417.34 387.425,1448.16 398.167,1470.43 408.908,1447.64 419.649,671.259 430.391,1467.74 441.132,1470.15 451.873,1452.09 462.614,1464.25 
  473.356,789.611 484.097,667.067 494.838,589.911 505.579,590.296 516.321,707.501 527.062,657.077 537.803,594.624 548.545,595.523 559.286,537.023 570.027,613.717 
  580.768,675.667 591.51,564.51 602.251,552.132 612.992,579.782 623.733,485.939 634.475,619.172 645.216,698.386 655.957,745.731 666.699,659.576 677.44,622.177 
  688.181,573.305 698.922,562.199 709.664,571.35 720.405,539.899 731.146,457.636 741.887,419.144 752.629,529.516 763.37,596.229 774.111,726.401 784.853,674.756 
  795.594,637.699 806.335,581.294 817.076,406.469 827.818,216.8 838.559,208.511 849.3,241.162 860.041,158.654 870.783,185.209 881.524,219.501 892.265,197.69 
  903.007,277.247 913.748,217.104 924.489,148.454 935.23,273.532 945.972,163.695 956.713,191.832 967.454,181.142 978.195,198.857 988.937,272.655 999.678,256.445 
  1010.42,248.449 1021.16,206.66 1031.9,104.257 1042.64,253.031 1053.38,259.543 1064.13,301.862 1074.87,256.186 1085.61,323.019 1096.35,313.264 1107.09,352.525 
  1117.83,376.364 1128.57,387.129 1139.31,299.539 1150.06,344.518 1160.8,344.921 1171.54,246.359 1182.28,243.101 1193.02,341.104 1203.76,347.212 1214.5,336.61 
  1225.24,277.077 1235.99,282.986 1246.73,327.406 1257.47,328.226 1268.21,279.959 1278.95,282.377 1289.69,267.926 1300.43,1472.65 1311.17,1467.19 1321.92,1469.97 
  1332.66,1467.34 1343.4,1466.47 1354.14,346.228 1364.88,334.252 1375.62,308.989 1386.36,316.169 1397.1,364.786 1407.85,347.623 1418.59,429.559 1429.33,427.485 
  1440.07,406.279 1450.81,407.616 1461.55,400.41 1472.29,1465.65 1483.04,1464.88 1493.78,1464.84 1504.52,1464.83 1515.26,320.667 1526,330.098 1536.74,318.253 
  1547.48,302.151 1558.22,311.824 1568.97,344.995 1579.71,306.042 1590.45,271.918 1601.19,315.133 1611.93,325.574 1622.67,357.978 1633.41,342.205 1644.15,320.786 
  1654.9,305.036 1665.64,310.851 1676.38,269.315 1687.12,274.887 1697.86,248.161 1708.6,271.451 1719.34,256.474 1730.08,281.274 1740.83,246.669 1751.57,243.347 
  1762.31,314.544 1773.05,301.036 1783.79,320.823 1794.53,345.616 1805.27,312.935 1816.01,338.047 1826.76,389.718 1837.5,364.581 1848.24,422.735 1858.98,407.749 
  1869.72,433.894 1880.46,407.652 1891.2,413.452 1901.94,412.485 1912.69,407.891 1923.43,404.487 1934.17,398.446 1944.91,393.18 1955.65,398.114 1966.39,351.209 
  1977.13,417.13 1987.87,339.461 1998.62,379.337 2009.36,358.99 2020.1,319.888 2030.84,313.319 2041.58,333.545 2052.32,366.478 2063.06,377.045 2073.81,391.672 
  2084.55,350.304 2095.29,423.563 2106.03,385.589 2116.77,437.461 2127.51,435.341 2138.25,399.172 2148.99,371.6 2159.74,346.592 2170.48,400.448 2181.22,409.974 
  2191.96,402.564 2202.7,416.257 2213.44,408.226 2224.18,411.176 2234.92,425.278 2245.67,435.379 2256.41,440.844 2267.15,428.125 2277.89,446.718 2288.63,431.43 
  
  "/>
<polyline clip-path="url(#clip8302)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1479.74 172.6,1479.73 183.341,1479.61 194.083,1479.35 204.824,1478.76 215.565,1477.74 226.306,1475.54 237.048,1474.14 247.789,1472.91 
  258.53,1471.92 269.272,1471.53 280.013,1470.32 290.754,1472.24 301.495,1467.78 312.237,1466.88 322.978,1464.38 333.719,1458.08 344.46,1452.95 355.202,1447.43 
  365.943,1434.99 376.684,1438.64 387.425,1441.65 398.167,1435.33 408.908,1429.39 419.649,1397.52 430.391,1428.27 441.132,1419.76 451.873,1346.91 462.614,1324.31 
  473.356,1365.07 484.097,1354.89 494.838,1283.03 505.579,1283 516.321,1365.2 527.062,1201.66 537.803,1233.61 548.545,1161.89 559.286,1155.3 570.027,957.471 
  580.768,1080.11 591.51,1060.79 602.251,943.424 612.992,1147.3 623.733,1075.1 634.475,971.841 645.216,1055.35 655.957,900.254 666.699,1130.52 677.44,907.813 
  688.181,952.055 698.922,823.591 709.664,698.265 720.405,744.249 731.146,598.334 741.887,736.026 752.629,680.688 763.37,706.594 774.111,989.481 784.853,792.642 
  795.594,713.282 806.335,897.445 817.076,829.71 827.818,686.203 838.559,662.859 849.3,471.562 860.041,282.936 870.783,746.865 881.524,472.528 892.265,862.819 
  903.007,739.911 913.748,786.955 924.489,583.694 935.23,830.389 945.972,420.107 956.713,673.884 967.454,686.809 978.195,502.181 988.937,836.594 999.678,542.659 
  1010.42,345.038 1021.16,388.198 1031.9,535.697 1042.64,737.975 1053.38,579.416 1064.13,692.094 1074.87,585.207 1085.61,603.458 1096.35,339.147 1107.09,563.551 
  1117.83,547.735 1128.57,840.273 1139.31,595.577 1150.06,460.034 1160.8,577.808 1171.54,594.911 1182.28,662.433 1193.02,651.152 1203.76,342.114 1214.5,479.983 
  1225.24,420.396 1235.99,694.214 1246.73,738.711 1257.47,717.78 1268.21,853.481 1278.95,680.59 1289.69,607.705 1300.43,361.494 1311.17,465.095 1321.92,674.782 
  1332.66,823.158 1343.4,692.966 1354.14,823.457 1364.88,409.221 1375.62,344.335 1386.36,818.275 1397.1,581.638 1407.85,579.852 1418.59,393.052 1429.33,377.557 
  1440.07,845.527 1450.81,490.266 1461.55,852.564 1472.29,821.859 1483.04,802.438 1493.78,821.131 1504.52,876.847 1515.26,810.362 1526,497.29 1536.74,721.147 
  1547.48,432.691 1558.22,685.365 1568.97,727.085 1579.71,732.7 1590.45,539.279 1601.19,434.811 1611.93,269.338 1622.67,297.689 1633.41,355.823 1644.15,432.8 
  1654.9,308.602 1665.64,484.036 1676.38,514.796 1687.12,480.595 1697.86,851.342 1708.6,594.661 1719.34,530.099 1730.08,405.688 1740.83,424.389 1751.57,399.429 
  1762.31,314.845 1773.05,295.223 1783.79,322.43 1794.53,420.886 1805.27,568.307 1816.01,370.904 1826.76,437.163 1837.5,586.261 1848.24,610.635 1858.98,486.671 
  1869.72,590.357 1880.46,480.259 1891.2,616.488 1901.94,850.418 1912.69,761.816 1923.43,652.68 1934.17,773.191 1944.91,763.555 1955.65,724.799 1966.39,473.282 
  1977.13,846.693 1987.87,963.288 1998.62,496.829 2009.36,342.947 2020.1,349.717 2030.84,679.856 2041.58,594.847 2052.32,1003.69 2063.06,1030.22 2073.81,631.842 
  2084.55,469.42 2095.29,651.887 2106.03,549.026 2116.77,376.138 2127.51,380.511 2138.25,384.127 2148.99,504.298 2159.74,452.868 2170.48,769.444 2181.22,705.926 
  2191.96,651.853 2202.7,734.856 2213.44,742.146 2224.18,606.968 2234.92,396.762 2245.67,568.98 2256.41,573.617 2267.15,455.967 2277.89,569.635 2288.63,452.161 
  
  "/>
<path clip-path="url(#clip8300)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip8300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip8300)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip8300)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip8300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>Finally, we save the logged results to <code>exper</code> for later review:</p><pre><code class="language-julia">exper[:logs] = get(lg)
finish!(exper); # flushes everything to disk</code></pre><pre><code class="language-none">[ Info: Experiment saved to /tmp/hopper_example.jlso</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../humanoid/">« Creating a MuJoCo Environment</a><a class="docs-footer-nextpage" href="../visualize/">Using the visualizer »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 15 January 2020 02:31">Wednesday 15 January 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
