<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Learning a control policy · Lyceum</title><link rel="canonical" href="https://docs.lyceum.ml/dev/examples/NPG/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Lyceum</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../humanoid/">Creating a MuJoCo Environment</a></li><li class="is-active"><a class="tocitem" href>Learning a control policy</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#The-Code-1"><span>The Code</span></a></li></ul></li><li><a class="tocitem" href="../visualize/">Using the visualizer</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Learning a control policy</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Learning a control policy</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/docs/src/examples/NPG.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Running examples locally</header><div class="admonition-body"><p>This example and more are also available as Julia scripts and Jupyter notebooks.</p><p>See <a href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/example_howto.md">the how-to page</a> for more information.</p></div></div><h1 id="Learning-a-control-policy-1"><a class="docs-heading-anchor" href="#Learning-a-control-policy-1">Learning a control policy</a><a class="docs-heading-anchor-permalink" href="#Learning-a-control-policy-1" title="Permalink"></a></h1><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>In this example we walk through the process of setting up an experiment that runs <a href="https://papers.nips.cc/paper/2073-a-natural-policy-gradient.pdf">Natural Policy Gradient</a> (or more recently <a href="https://arxiv.org/pdf/1703.02660.pdf">in this work</a>). This is an on-policy reinforcement learning method that is comparable to TRPO, PPO, and other policy gradient methods. See the documentation for <code>NaturalPolicyGradient</code> for full implementation details.</p><h2 id="The-Code-1"><a class="docs-heading-anchor" href="#The-Code-1">The Code</a><a class="docs-heading-anchor-permalink" href="#The-Code-1" title="Permalink"></a></h2><p>First, let&#39;s go head and grab all the dependencies:</p><pre><code class="language-julia">using LinearAlgebra, Random, Statistics # From Stdlib
using LyceumAI                          # For the NPG controller
using LyceumMuJoCo                      # For the Hopper environment
using LyceumBase.Tools                  # For the ControllerIterator discussed below
using Flux                              # For our neural networks needs
using UniversalLogger                   # For logging experiment data
using Plots                             # For plotting the results</code></pre><p>We first instantiate a <code>HopperV2</code> environment to grab useful environment-specific values, such as the size of the observation and action vectors:</p><pre><code class="language-julia">env = LyceumMuJoCo.HopperV2();
dobs, dact = length(obsspace(env)), length(actionspace(env));</code></pre><h3 id="Policy-Gradient-Components-1"><a class="docs-heading-anchor" href="#Policy-Gradient-Components-1">Policy Gradient Components</a><a class="docs-heading-anchor-permalink" href="#Policy-Gradient-Components-1" title="Permalink"></a></h3><p>Policy Gradient methods require a policy: a function that takes in the state/observations of the agent, and outputs an action i.e. <code>action = π(obs)</code>. In much of Deep RL, the policy takes the form of a neural network which can be built on top of the <a href="https://github.com/FluxML/Flux.jl">Flux.jl</a> library. We utilize a stochastic policy in this example. Specifically, our policy is represented as a multivariate Gaussian distribution of the form:</p><div>\[\pi(a | s) = \mathcal{N}(\mu_{\theta_1}(\text{obs}), \Sigma_{\theta_2})\]</div><p>where <span>$\mu_{\theta_1}$</span> is a neural network, parameterized by <span>$\theta_1$</span>, that maps an observation <code>obs</code> to a mean action and <span>$\Sigma_{\theta_2}$</span> is a diagonal covariance matrix parameterized by <span>$\theta_2$</span>, the diagonal entries of the matrix. For <span>$\mu_{\theta_1}$</span> we utilize a 2-layer neural network, where each layer has a &quot;width&quot; of 32. We use tanh activations for each hidden layer and initialize the network weights with Glorot Uniform initializations. Rather than tracking <span>$\Sigma_{\theta_2}$</span> directly, we track the log standard deviations, which are easier to learn. We initialize <span>$\log \text{diag}(\Sigma_{\theta_2})$</span> as <code>zeros(dact)</code>, i.e. a <code>Vector</code> of length <code>dact</code>, initialized to 0. Both <span>$\theta_1$</span> and <span>$\theta_2$</span> are learned in this example. Note that <span>$\mu_{\theta_1}$</span> is a <em>state-dependent</em> mean while <span>$\Sigma_{\theta_2}$</span> is a <em>global</em> covariance.</p><pre><code class="language-julia">policy = DiagGaussianPolicy(
    multilayer_perceptron(
        dobs,
        32,
        32,
        dact;
        σ = tanh,
        initb = Flux.glorot_uniform,
        initb_final = Flux.glorot_uniform,
        dtype = Float32,
    ),
    zeros(Float32, dact),
);</code></pre><p>This NPG implementation uses <a href="https://arxiv.org/pdf/1506.02438.pdf">Generalized Advantaged Estimation</a>, which requires an estimate of the value function, <code>value(state)</code>, which we represent using a 2-layer, feedforward neural network where each layer has a width of 128 and uses the ReLU activation function. The model weights are initialized using Glorot Uniform initialization as above.</p><pre><code class="language-julia">value = multilayer_perceptron(
    dobs,
    128,
    128,
    1;
    σ = Flux.relu,
    initb = Flux.glorot_uniform,
    initb_final = Flux.glorot_uniform,
    dtype = Float32,
);</code></pre><p>Next, we set up the optimization pipeline for <code>value</code>. We use a mini-batch size of 64 and the <a href="https://arxiv.org/pdf/1412.6980.pdf">ADAM</a> optimizer. <code>FluxTrainer</code> is an iterator that loops on the model provided, performing a single step of gradient descent at each iteration. The result at each loop is passed to <code>stopcb</code> below, so you can quit after a number of epochs, convergence, or other criteria; here it&#39;s capped at two epochs using an anonymous function. See the documentation for <code>FluxTrainer</code> for more information.</p><pre><code class="language-julia">valueloss(bl, X, Y) = Flux.mse(vec(bl(X)), vec(Y))
valuetrainer = FluxTrainer(
    optimiser = ADAM(1e-3),
    szbatch = 64,
    lossfn = valueloss,
    stopcb = x -&gt; x.nepochs &gt; 2,
);</code></pre><p>The <code>NaturalPolicyGradient</code> iterator is a type that pre-allocates all necesary data structures and performs one gradient update to <code>policy</code> at each iteration. We first pass in a constructor that given <code>n</code> returns <code>n</code> instances of <code>LyceumMuJoCo.HopperV2</code>, all sharing the same <code>jlModel</code>, to allow <code>NaturalPolicyGradient</code> to allocate per-thread environments and enable performant, parallel sampling from <code>policy</code>. We then pass in the <code>policy</code>, <code>value</code>, and <code>valuetrainer</code> instances constructed above and override a few of the default <code>NaturalPolicyGradient</code> parameters: <code>gamma</code>, <code>gaelambda</code>, and <code>norm_step_size</code>. Finally, we set the max trajectory length <code>Hmax</code> and total number of samples per iteration, <code>N</code>. Under the hood, <code>NaturalPolicyGradient</code> will use approximately <code>div(N, Hmax)</code> threads to perform the sampling.</p><pre><code class="language-julia">npg = NaturalPolicyGradient(
    n -&gt; tconstruct(LyceumMuJoCo.HopperV2, n),
    policy,
    value,
    valuetrainer;
    gamma = 0.995,
    gaelambda = 0.97,
    norm_step_size = 0.05,
    Hmax = 1000,
    N = 10240,
);</code></pre><h3 id="Running-Experiments-1"><a class="docs-heading-anchor" href="#Running-Experiments-1">Running Experiments</a><a class="docs-heading-anchor-permalink" href="#Running-Experiments-1" title="Permalink"></a></h3><p>Finally, let&#39;s spin on our iterator 200 times, plotting every 20 iterations. This lets us break out of the loop if certain conditions are met, or re-start training manually if needed. We of course wish to track results, so we create a <code>ULogger</code> and <code>Experiment</code> to which we can save data. We also have useful timing information displayed every 20 iterations to better understand the performance of our algorithm and identify any potential bottlenecks. Rather than iterating on <code>npg</code> at the global scope, we&#39;ll do it inside of a function to avoid the performance issues associated with global variables as discussed in the <a href="https://docs.julialang.org/en/v1/manual/performance-tips/">Julia performance tips</a>. Note, to keep the Markdown version of this tutorial readable, we skip the plots and performance statistics. To enable them, simply call <code>hopper_NPG(npg, true)</code>.</p><pre><code class="language-julia">function hopper_NPG(npg::NaturalPolicyGradient, plot::Bool)
    exper = Experiment(&quot;/tmp/hopper_example.jlso&quot;, overwrite = true)
    # Walks, talks, and acts like a Julia logger. See the UniversalLogger.jl docs for more info.
    lg = ULogger()
    for (i, state) in enumerate(npg)
        if i &gt; 200
            # serialize some stuff and quit
            exper[:policy] = npg.policy
            exper[:value] = npg.value
            exper[:etype] = LyceumMuJoCo.HopperV2
            exper[:meanstates] = state.meanbatch
            exper[:stocstates] = state.stocbatch
            break
        end

        # log everything in `state` except meanbatch and stocbatch
        push!(lg, :algstate, filter_nt(state, exclude = (:meanbatch, :stocbatch)))

        if plot &amp;&amp; mod(i, 20) == 0
            x = lg[:algstate]
            # The following are helper functions for plotting to the terminal.
            # The first plot displays the `geteval` function for our stochastic
            # and mean policy rollouts.
            display(expplot(
                Line(x[:stocterminal_eval], &quot;StocLastE&quot;),
                Line(x[:meanterminal_eval], &quot;MeanLastE&quot;),
                title = &quot;Evaluation Score, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))
            # While the second one similarly plots `getreward`.
            display(expplot(
                Line(x[:stoctraj_reward], &quot;StocR&quot;),
                Line(x[:meantraj_reward], &quot;MeanR&quot;),
                title = &quot;Reward, Iter=$i&quot;,
                width = 60,
                height = 8,
            ))

            # The following are timing values for various parts of the Natural Policy Gradient
            # algorithm at the last iteration, useful for finding performance bottlenecks
            # in the algorithm.
            println(&quot;elapsed_sampled  = &quot;, state.elapsed_sampled)
            println(&quot;elapsed_gradll   = &quot;, state.elapsed_gradll)
            println(&quot;elapsed_vpg      = &quot;, state.elapsed_vpg)
            println(&quot;elapsed_cg       = &quot;, state.elapsed_cg)
            println(&quot;elapsed_valuefit = &quot;, state.elapsed_valuefit)
        end
    end
    exper, lg
end
# Seed the per-thread global RNGs
seed_threadrngs!(1)
exper, lg = hopper_NPG(npg, false);</code></pre><p>Let&#39;s go ahead and plot the final reward trajectory for our stochastic and mean policies to see how we did:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_reward] lg[:algstate][:stoctraj_reward]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Reward&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip6000">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip6000)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6001">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip6000)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6002">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1499.55 2352.76,1499.55 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1251.64 2352.76,1251.64 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1003.73 2352.76,1003.73 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,755.825 2352.76,755.825 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,507.918 2352.76,507.918 
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,260.011 2352.76,260.011 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1499.55 114.181,1499.55 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1251.64 114.181,1251.64 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1003.73 114.181,1003.73 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,755.825 114.181,755.825 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,507.918 114.181,507.918 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,260.011 114.181,260.011 
  "/>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1517.05)" x="62.9921" y="1517.05">0</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1269.14)" x="62.9921" y="1269.14">50</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1021.23)" x="62.9921" y="1021.23">100</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 773.325)" x="62.9921" y="773.325">150</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 525.418)" x="62.9921" y="525.418">200</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 277.511)" x="62.9921" y="277.511">250</text>
</g>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Reward</text>
</g>
<polyline clip-path="url(#clip6002)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1478.76 172.6,1476.45 183.341,1469.9 194.083,1303.16 204.824,1304.18 215.565,1299.45 226.306,1279.03 237.048,1110.25 247.789,1003.66 
  258.53,713.405 269.272,597.487 280.013,550.879 290.754,441.302 301.495,435.368 312.237,416.842 322.978,417.328 333.719,416.504 344.46,424.381 355.202,429.232 
  365.943,460.711 376.684,470.504 387.425,464.645 398.167,475.718 408.908,370.017 419.649,371.247 430.391,370.522 441.132,368.929 451.873,352.518 462.614,349.741 
  473.356,359.787 484.097,358.224 494.838,344.493 505.579,329.321 516.321,326.333 527.062,305.199 537.803,285.333 548.545,266.38 559.286,275.862 570.027,260.791 
  580.768,282.133 591.51,263.228 602.251,236.414 612.992,280.684 623.733,248.096 634.475,233.341 645.216,238.448 655.957,246.128 666.699,232.878 677.44,222.717 
  688.181,211.968 698.922,226.587 709.664,253.391 720.405,242.197 731.146,224.445 741.887,217.302 752.629,229.308 763.37,223.651 774.111,212.221 784.853,207.564 
  795.594,212.549 806.335,223.708 817.076,211.537 827.818,202.819 838.559,202.033 849.3,196.36 860.041,214.94 870.783,208.457 881.524,218.713 892.265,216.132 
  903.007,201.652 913.748,187.674 924.489,191.042 935.23,187.436 945.972,187.232 956.713,189.662 967.454,178.428 978.195,176.473 988.937,146.447 999.678,144.685 
  1010.42,163.697 1021.16,183.23 1031.9,161.635 1042.64,146.151 1053.38,150.388 1064.13,176.437 1074.87,147.441 1085.61,156.355 1096.35,165.251 1107.09,113.833 
  1117.83,175.054 1128.57,115.351 1139.31,159.506 1150.06,134.797 1160.8,175.348 1171.54,163.204 1182.28,181.86 1193.02,177.419 1203.76,180.94 1214.5,158.725 
  1225.24,137.708 1235.99,133.647 1246.73,115.888 1257.47,104.257 1268.21,118.86 1278.95,134.993 1289.69,172.633 1300.43,172.978 1311.17,142.864 1321.92,162.825 
  1332.66,159.179 1343.4,151.2 1354.14,173.45 1364.88,134.064 1375.62,142.9 1386.36,141.363 1397.1,122.036 1407.85,113.575 1418.59,146.587 1429.33,145.622 
  1440.07,171.368 1450.81,160.017 1461.55,175.146 1472.29,145.153 1483.04,147.903 1493.78,157.252 1504.52,182.976 1515.26,149.031 1526,141.699 1536.74,122.218 
  1547.48,143.394 1558.22,120.802 1568.97,126.589 1579.71,137.539 1590.45,151.974 1601.19,135.034 1611.93,138.712 1622.67,114.037 1633.41,161.038 1644.15,181.581 
  1654.9,170.49 1665.64,182.876 1676.38,174.322 1687.12,128.118 1697.86,131.662 1708.6,125.053 1719.34,160.821 1730.08,124.805 1740.83,128.574 1751.57,135.313 
  1762.31,137.684 1773.05,148.689 1783.79,167.308 1794.53,183.075 1805.27,171.511 1816.01,160.107 1826.76,157.83 1837.5,145.213 1848.24,159.605 1858.98,173.152 
  1869.72,158.609 1880.46,159.758 1891.2,159.843 1901.94,155.535 1912.69,177.371 1923.43,177.302 1934.17,163.043 1944.91,168.078 1955.65,161.272 1966.39,163.506 
  1977.13,161.142 1987.87,160.404 1998.62,147.163 2009.36,171.381 2020.1,167.897 2030.84,156.163 2041.58,147.258 2052.32,159.661 2063.06,162.071 2073.81,156.07 
  2084.55,170.072 2095.29,142.218 2106.03,153.844 2116.77,124.784 2127.51,146.09 2138.25,130.218 2148.99,124.8 2159.74,143.15 2170.48,129.669 2181.22,126.712 
  2191.96,109.793 2202.7,113.128 2213.44,117.122 2224.18,109.3 2234.92,137.797 2245.67,149.634 2256.41,138.563 2267.15,135.832 2277.89,108.329 2288.63,130.987 
  
  "/>
<polyline clip-path="url(#clip6002)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1474.3 161.859,1472.27 172.6,1465.24 183.341,1432.92 194.083,1387.29 204.824,1316.8 215.565,1276.76 226.306,1234.98 237.048,1126.85 247.789,980.785 
  258.53,830.865 269.272,693.32 280.013,686.59 290.754,614.392 301.495,511.032 312.237,483.381 322.978,485.783 333.719,504.761 344.46,472.386 355.202,473.81 
  365.943,466.736 376.684,470.735 387.425,446.044 398.167,435.992 408.908,431.182 419.649,428.355 430.391,443.726 441.132,433.531 451.873,418.56 462.614,411.111 
  473.356,408.436 484.097,397.25 494.838,383.089 505.579,370.565 516.321,372.627 527.062,356.585 537.803,345.106 548.545,370.388 559.286,333.763 570.027,326.999 
  580.768,325.176 591.51,328.006 602.251,347.386 612.992,318.458 623.733,300.183 634.475,321.999 645.216,334.261 655.957,289.946 666.699,272.081 677.44,337.115 
  688.181,393.219 698.922,255.874 709.664,280.062 720.405,265.252 731.146,277.884 741.887,287.874 752.629,282.168 763.37,278.356 774.111,280.951 784.853,272.11 
  795.594,281.04 806.335,257.464 817.076,247.177 827.818,308.02 838.559,271.884 849.3,234.122 860.041,249.005 870.783,250.439 881.524,244.546 892.265,226.224 
  903.007,261.858 913.748,243.111 924.489,222.071 935.23,220.142 945.972,221.965 956.713,220.775 967.454,225.213 978.195,227.319 988.937,271.123 999.678,256.335 
  1010.42,197.053 1021.16,208.27 1031.9,204.85 1042.64,192.814 1053.38,195.405 1064.13,192.474 1074.87,194.564 1085.61,186.357 1096.35,213.921 1107.09,249.803 
  1117.83,184.472 1128.57,209.371 1139.31,197.473 1150.06,257.992 1160.8,227.344 1171.54,218.717 1182.28,189.382 1193.02,187.044 1203.76,194.482 1214.5,191.618 
  1225.24,214.43 1235.99,251.062 1246.73,256.659 1257.47,226.733 1268.21,214.034 1278.95,167.034 1289.69,166.262 1300.43,161.392 1311.17,176.984 1321.92,240.296 
  1332.66,176.615 1343.4,177.81 1354.14,167.595 1364.88,172.735 1375.62,187.915 1386.36,182.051 1397.1,180.953 1407.85,202.938 1418.59,223.477 1429.33,217.215 
  1440.07,166.824 1450.81,196.108 1461.55,207.853 1472.29,222.835 1483.04,245.853 1493.78,220.092 1504.52,190.314 1515.26,193.133 1526,174.49 1536.74,212.919 
  1547.48,176.917 1558.22,177.188 1568.97,187.428 1579.71,233.057 1590.45,231.593 1601.19,175.372 1611.93,205.675 1622.67,264.143 1633.41,194.889 1644.15,195.267 
  1654.9,179.971 1665.64,182.401 1676.38,171.734 1687.12,199.939 1697.86,236.848 1708.6,236.03 1719.34,256.29 1730.08,265.779 1740.83,318.081 1751.57,275.933 
  1762.31,281.526 1773.05,240.82 1783.79,187.457 1794.53,209.816 1805.27,234.087 1816.01,255.878 1826.76,307.282 1837.5,257.758 1848.24,270.408 1858.98,248.621 
  1869.72,181.562 1880.46,195.987 1891.2,192.732 1901.94,239.981 1912.69,223.303 1923.43,205.512 1934.17,205.978 1944.91,228.405 1955.65,198.221 1966.39,192.634 
  1977.13,196.279 1987.87,182.677 1998.62,177 2009.36,160.963 2020.1,175.513 2030.84,201.927 2041.58,173.057 2052.32,171.49 2063.06,167.718 2073.81,164.334 
  2084.55,162.299 2095.29,188.565 2106.03,178.931 2116.77,164.784 2127.51,164.461 2138.25,171.979 2148.99,168.989 2159.74,144.118 2170.48,170.427 2181.22,150.552 
  2191.96,150.561 2202.7,151.62 2213.44,174.233 2224.18,153.37 2234.92,143.677 2245.67,141.194 2256.41,143.419 2267.15,125.485 2277.89,156.656 2288.63,136.33 
  
  "/>
<path clip-path="url(#clip6000)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip6000)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip6000)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip6000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>We&#39;ll also plot the evaluations:</p><pre><code class="language-julia">plot(
    [lg[:algstate][:meantraj_eval] lg[:algstate][:stoctraj_eval]],
    labels = [&quot;Mean Policy&quot; &quot;Stochastic Policy&quot;],
    title = &quot;HopperV2 Eval&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip6600">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip6600)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6601">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip6600)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6602">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1478.45 2352.76,1478.45 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1268.05 2352.76,1268.05 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1057.65 2352.76,1057.65 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,847.255 2352.76,847.255 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,636.856 2352.76,636.856 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,426.458 2352.76,426.458 
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,216.06 2352.76,216.06 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1478.45 114.181,1478.45 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1268.05 114.181,1268.05 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1057.65 114.181,1057.65 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,847.255 114.181,847.255 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,636.856 114.181,636.856 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,426.458 114.181,426.458 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,216.06 114.181,216.06 
  "/>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1495.95)" x="62.9921" y="1495.95">0</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1285.55)" x="62.9921" y="1285.55">10</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1075.15)" x="62.9921" y="1075.15">20</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 864.755)" x="62.9921" y="864.755">30</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 654.356)" x="62.9921" y="654.356">40</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 443.958)" x="62.9921" y="443.958">50</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 233.56)" x="62.9921" y="233.56">60</text>
</g>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">HopperV2 Eval</text>
</g>
<polyline clip-path="url(#clip6602)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.74 161.859,1479.63 172.6,1479.41 183.341,1479.36 194.083,1450.06 204.824,1449.85 215.565,1446.84 226.306,1440.01 237.048,1361.57 247.789,1285.64 
  258.53,1028.49 269.272,893.425 280.013,821.077 290.754,699.379 301.495,691.424 312.237,666.501 322.978,663.908 333.719,660.45 344.46,670.352 355.202,676.199 
  365.943,720.944 376.684,732.18 387.425,725.818 398.167,741.775 408.908,568.46 419.649,564.123 430.391,563.411 441.132,568.732 451.873,539.738 462.614,525.759 
  473.356,548.308 484.097,552.342 494.838,537.763 505.579,508.837 516.321,504.835 527.062,465.039 537.803,442.613 548.545,397.338 559.286,416.717 570.027,394.896 
  580.768,440.181 591.51,408.543 602.251,358.25 612.992,431.001 623.733,379.061 634.475,357.265 645.216,365.745 655.957,382.197 666.699,356.868 677.44,341.574 
  688.181,314.69 698.922,351.276 709.664,396.133 720.405,374.687 731.146,351.309 741.887,338.623 752.629,351.571 763.37,351.088 774.111,328.92 784.853,306.704 
  795.594,329.837 806.335,337.21 817.076,315.518 827.818,308.512 838.559,297.284 849.3,298.865 860.041,323.328 870.783,312.561 881.524,332.48 892.265,330.134 
  903.007,294.557 913.748,266.408 924.489,267.311 935.23,276.555 945.972,264.88 956.713,279.594 967.454,246.002 978.195,246.507 988.937,189.175 999.678,182.125 
  1010.42,211.885 1021.16,247.878 1031.9,211.392 1042.64,194.062 1053.38,200.665 1064.13,239.649 1074.87,196.875 1085.61,204.405 1096.35,231.876 1107.09,131.502 
  1117.83,247.214 1128.57,120.213 1139.31,231.879 1150.06,184.078 1160.8,251.335 1171.54,233.973 1182.28,263.351 1193.02,266.113 1203.76,275.037 1214.5,228.138 
  1225.24,173.491 1235.99,171.782 1246.73,131.475 1257.47,111.259 1268.21,125.923 1278.95,171.874 1289.69,246.828 1300.43,259.719 1311.17,203.846 1321.92,229.709 
  1332.66,234.944 1343.4,206.618 1354.14,251.908 1364.88,180.241 1375.62,187.986 1386.36,182.015 1397.1,148.548 1407.85,128.62 1418.59,209.274 1429.33,205.731 
  1440.07,245.303 1450.81,220.483 1461.55,261.2 1472.29,204.717 1483.04,201.377 1493.78,228.831 1504.52,275.341 1515.26,191.595 1526,177.128 1536.74,149.365 
  1547.48,181.342 1558.22,148.254 1568.97,159.046 1579.71,183.699 1590.45,201.991 1601.19,180.547 1611.93,176.621 1622.67,128.581 1633.41,227.268 1644.15,256.155 
  1654.9,232.768 1665.64,269.473 1676.38,241.602 1687.12,149.513 1697.86,153.917 1708.6,150.113 1719.34,223.238 1730.08,151.65 1740.83,154.498 1751.57,160.869 
  1762.31,163.078 1773.05,194.376 1783.79,216.729 1794.53,251.069 1805.27,231.84 1816.01,210.538 1826.76,213.661 1837.5,188.098 1848.24,204.913 1858.98,233.98 
  1869.72,216.275 1880.46,206.394 1891.2,214.789 1901.94,193.339 1912.69,234.725 1923.43,235.508 1934.17,211.931 1944.91,219.776 1955.65,215.992 1966.39,217.694 
  1977.13,194.868 1987.87,204.244 1998.62,189.189 2009.36,224.906 2020.1,230.049 2030.84,206.545 2041.58,189.206 2052.32,201.866 2063.06,204.832 2073.81,194.136 
  2084.55,219.466 2095.29,175.282 2106.03,199.035 2116.77,145.605 2127.51,171.164 2138.25,142.238 2148.99,142.54 2159.74,173.951 2170.48,138.368 2181.22,133.607 
  2191.96,108.918 2202.7,106.143 2213.44,104.257 2224.18,111.786 2234.92,167.968 2245.67,184.087 2256.41,155.398 2267.15,152.701 2277.89,106.503 2288.63,141.206 
  
  "/>
<polyline clip-path="url(#clip6602)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.65 161.859,1479.6 172.6,1479.12 183.341,1474.4 194.083,1466.33 204.824,1452.22 215.565,1442.14 226.306,1423.06 237.048,1350.2 247.789,1241.18 
  258.53,1115.45 269.272,976.804 280.013,978.898 290.754,908.073 301.495,793.26 312.237,751.698 322.978,747.407 333.719,763.729 344.46,737.704 355.202,735.332 
  365.943,726.197 376.684,732.673 387.425,701.806 398.167,682.285 408.908,663.905 419.649,653.27 430.391,686.737 441.132,673.194 451.873,646.184 462.614,632.098 
  473.356,633.574 484.097,607.889 494.838,589.115 505.579,579.939 516.321,571.505 527.062,560.661 537.803,539.86 548.545,565.169 559.286,517.905 570.027,503.34 
  580.768,509.202 591.51,507.142 602.251,526.235 612.992,494.579 623.733,478.681 634.475,497.718 645.216,493.864 655.957,444.783 666.699,424.064 677.44,496.1 
  688.181,555.263 698.922,395.933 709.664,428.886 720.405,413.653 731.146,432.118 741.887,437.693 752.629,435.446 763.37,426.125 774.111,428.404 784.853,410.989 
  795.594,427.247 806.335,400.423 817.076,385.461 827.818,454.035 838.559,413.628 849.3,363.935 860.041,384.559 870.783,380.871 881.524,368.027 892.265,350.111 
  903.007,381.38 913.748,355.018 924.489,333.204 935.23,337.721 945.972,330.568 956.713,329.286 967.454,335.393 978.195,341.194 988.937,382.437 999.678,369.588 
  1010.42,290.553 1021.16,302.611 1031.9,298.108 1042.64,281.761 1053.38,280.803 1064.13,280.284 1074.87,278.087 1085.61,265.775 1096.35,295.484 1107.09,344.469 
  1117.83,263.421 1128.57,286.081 1139.31,265.047 1150.06,344.677 1160.8,312.935 1171.54,290.888 1182.28,268.195 1193.02,273.721 1203.76,279.227 1214.5,263.486 
  1225.24,288.354 1235.99,334.563 1246.73,337.162 1257.47,300.966 1268.21,281.624 1278.95,236.013 1289.69,228.515 1300.43,234.27 1311.17,243.006 1321.92,323.369 
  1332.66,244.799 1343.4,240.457 1354.14,232.98 1364.88,242.526 1375.62,259.478 1386.36,255.541 1397.1,251.243 1407.85,282.995 1418.59,296.406 1429.33,298.165 
  1440.07,237.35 1450.81,265.823 1461.55,286.801 1472.29,306.864 1483.04,339.137 1493.78,313.602 1504.52,272.968 1515.26,279.098 1526,254.851 1536.74,297.063 
  1547.48,255.225 1558.22,256.371 1568.97,262.001 1579.71,310.448 1590.45,311.029 1601.19,242.806 1611.93,285.703 1622.67,354.107 1633.41,279.351 1644.15,289.861 
  1654.9,266.822 1665.64,267.854 1676.38,249.477 1687.12,277.937 1697.86,329.553 1708.6,331.347 1719.34,348.675 1730.08,356.216 1740.83,425.98 1751.57,376.268 
  1762.31,382.405 1773.05,332.189 1783.79,273.063 1794.53,311.449 1805.27,317.46 1816.01,343.157 1826.76,395.008 1837.5,342.418 1848.24,346.612 1858.98,329.264 
  1869.72,250.008 1880.46,265.616 1891.2,270.562 1901.94,319.085 1912.69,310.426 1923.43,283.467 1934.17,275.001 1944.91,300.998 1955.65,267.121 1966.39,261.847 
  1977.13,270.955 1987.87,242.434 1998.62,220.862 2009.36,214.349 2020.1,234.596 2030.84,258.2 2041.58,216.45 2052.32,217.083 2063.06,209.197 2073.81,210.804 
  2084.55,205.586 2095.29,234.928 2106.03,227.91 2116.77,210.999 2127.51,203.693 2138.25,203.192 2148.99,206.567 2159.74,175.853 2170.48,202.202 2181.22,177.711 
  2191.96,173.346 2202.7,177.701 2213.44,198.572 2224.18,176.298 2234.92,165.958 2245.67,174.135 2256.41,170.063 2267.15,142.745 2277.89,173.527 2288.63,146.675 
  
  "/>
<path clip-path="url(#clip6600)" d="
M1676.96 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1676.96 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6600)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1676.96,1377.01 2280.76,1377.01 2280.76,1195.57 1676.96,1195.57 1676.96,1377.01 
  "/>
<polyline clip-path="url(#clip6600)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1256.05 1844.96,1256.05 
  "/>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1273.55)" x="1868.96" y="1273.55">Mean Policy</text>
</g>
<polyline clip-path="url(#clip6600)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.96,1316.53 1844.96,1316.53 
  "/>
<g clip-path="url(#clip6600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1868.96, 1334.03)" x="1868.96" y="1334.03">Stochastic Policy</text>
</g>
</svg>
<p>Finally, we save the logged results to <code>exper</code> for later review:</p><pre><code class="language-julia">exper[:logs] = get(lg)
finish!(exper); # flushes everything to disk</code></pre><pre><code class="language-none">[ Info: Experiment saved to /tmp/hopper_example.jlso</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../humanoid/">« Creating a MuJoCo Environment</a><a class="docs-footer-nextpage" href="../visualize/">Using the visualizer »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 15 January 2020 02:34">Wednesday 15 January 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
