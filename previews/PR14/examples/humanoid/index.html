<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating a MuJoCo Environment · Lyceum</title><link rel="canonical" href="https://docs.lyceum.ml/dev/examples/humanoid/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Lyceum</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Creating a MuJoCo Environment</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#The-Code-1"><span>The Code</span></a></li></ul></li><li><a class="tocitem" href="../NPG/">Learning a control policy</a></li><li><a class="tocitem" href="../visualize/">Using the visualizer</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Creating a MuJoCo Environment</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Creating a MuJoCo Environment</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/docs/src/examples/humanoid.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Running examples locally</header><div class="admonition-body"><p>This example and more are also available as Julia scripts and Jupyter notebooks.</p><p>See <a href="https://github.com/Lyceum/LyceumDocs.jl/blob/master/example_howto.md">the how-to page</a> for more information.</p></div></div><h1 id="Creating-a-MuJoCo-Environment-1"><a class="docs-heading-anchor" href="#Creating-a-MuJoCo-Environment-1">Creating a MuJoCo Environment</a><a class="docs-heading-anchor-permalink" href="#Creating-a-MuJoCo-Environment-1" title="Permalink"></a></h1><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>Using LyceumMuJoCo, we will create the environment for a Humanoid &quot;get-up&quot; task that mostly relies on the defaults of LyceumBase and LyceumMuJoCo to propagate state, action, and observation data. We will have to implement reward and evaluation functions, of course, along with a few other parts of the <code>AbstractEnvironment</code> interface.</p><p>We then solve the &quot;get-up&quot; task using a Model-Predictive Control method called <a href="https://ieeexplore.ieee.org/iel7/7478842/7487087/07487277.pdf">&quot;Model Predictive Path Integral Control&quot;</a> or MPPI, walking through how to log experiment data and plot the results.</p><h2 id="The-Code-1"><a class="docs-heading-anchor" href="#The-Code-1">The Code</a><a class="docs-heading-anchor-permalink" href="#The-Code-1" title="Permalink"></a></h2><p>First we grab our dependencies of the Lyceum ecosystem and other helpful packages.</p><pre><code class="language-julia">using LinearAlgebra, Random, Statistics
using Plots, UnicodePlots, JLSO
using LyceumBase, LyceumBase.Tools, LyceumAI, LyceumMuJoCo, MuJoCo, UniversalLogger, Shapes</code></pre><h3 id="Humanoid-Type-1"><a class="docs-heading-anchor" href="#Humanoid-Type-1">Humanoid Type</a><a class="docs-heading-anchor-permalink" href="#Humanoid-Type-1" title="Permalink"></a></h3><p>This struct is our primary entry into the environment API. Environments utilizing the MuJoCo simulator through LyceumMuJoCo should subtype <code>AbstractMuJoCoEnvironment &lt;: AbstractEnvironment</code>. As you can see, this simple example only wraps around the underlying simulator (the <code>sim::MJSim</code> field of <code>Humanoid</code>, referred to hereafter as just <code>sim</code>). The functions of the LyceumBase API will then dispatch on this struct through Julia&#39;s <a href="https://en.wikipedia.org/wiki/Multiple_dispatch">multiple dispatch</a> mechanism. When an algorithm calls a function such as <code>getobs!(obs, env)</code>, Julia will select from all functions with that name depending on <code>typeof(obs)</code> and <code>typeof(env)</code>.</p><pre><code class="language-julia">struct Humanoid{S&lt;:MJSim} &lt;: AbstractMuJoCoEnvironment
    sim::S
end

LyceumMuJoCo.getsim(env::Humanoid) = env.sim #src (needs to be here for below example to work)</code></pre><p><code>Humanoid</code> (and all subtypes of <code>AbstractEnvironment</code>) are designed to be used in a single threaded context. To use <code>Humanoid</code> in a multi-threaded context, one could simply create <code>Threads.nthreads()</code> instances of <code>Humanoid</code>:</p><pre><code class="language-julia">modelpath = joinpath(@__DIR__, &quot;humanoid.xml&quot;)
envs = [Humanoid(MJSim(modelpath, skip = 2)) for i = 1:Threads.nthreads()]
Threads.@threads for i = 1:Threads.nthreads()
    thread_env = envs[Threads.threadid()]
    step!(thread_env)
end</code></pre><p>As <code>Humanoid</code> only ever uses its internal <code>jlModel</code> (found at <code>sim.m</code>) in a read-only fashion, we can make a performance optimization by sharing a single instance of <code>jlModel</code> across each thread, resulting in improved cache efficiency. <code>LyceumMuJoCo.tconstruct</code>, short for &quot;thread construct&quot;, helps us to do just that by providing a common interface for defining &quot;thread-aware&quot; constructors. Below, we make a call to <code>tconstruct(MJSim, n, modelpath, skip = 2)</code> which will construct <code>n</code> instances of <code>MJSim</code> constructed from <code>modelpath</code> and with a <code>skip</code> of 2, all sharing the exact same <code>jlModel</code> instance, and return <code>n</code> instances of <code>Humanoid</code>. All of the environments provided by LyceumMuJoCo feature similar definitions of <code>tconstruct</code> as found below.</p><pre><code class="language-julia">Humanoid() = first(tconstruct(Humanoid, 1))
function LyceumMuJoCo.tconstruct(::Type{Humanoid}, n::Integer)
    modelpath = joinpath(@__DIR__, &quot;humanoid.xml&quot;)
    return Tuple(Humanoid(s) for s in tconstruct(MJSim, n, modelpath, skip = 2))
end</code></pre><p>We can then use <code>tconstruct</code> as follows:</p><pre><code class="language-julia">envs = tconstruct(Humanoid, Threads.nthreads())
Threads.@threads for i = 1:Threads.nthreads()
    thread_env = envs[Threads.threadid()]
    step!(thread_env)
end</code></pre><h3 id="Utilities-1"><a class="docs-heading-anchor" href="#Utilities-1">Utilities</a><a class="docs-heading-anchor-permalink" href="#Utilities-1" title="Permalink"></a></h3><p>The following are helpers for the &quot;get-up&quot; task we&#39;d like to consider. We want the humanoid to stand up, thus we need to grab the model&#39;s height, as well as record a laying down position that we can use to set the state to. By exploring the model in the REPL or MJCF/XML file we can see that <code>sim.d.qpos[3]</code> is the index for the z-axis (height) of the root joint. The <code>LAYING_QPOS</code> data was collected externally by posing the model into a supine pose; one can either use LyceumMuJoCoViz or simulate.cpp included with a MuJoCo release to do this.</p><pre><code class="language-julia">_getheight(shapedstate::ShapedView, ::Humanoid) = shapedstate.qpos[3]
const LAYING_QPOS = [
    -0.164158,
    0.0265899,
    0.101116,
    0.684044,
    -0.160277,
    -0.70823,
    -0.0693176,
    -0.1321,
    0.0203937,
    0.298099,
    0.0873523,
    0.00634907,
    0.117343,
    -0.0320319,
    -0.619764,
    0.0204114,
    -0.157038,
    0.0512385,
    0.115817,
    -0.0320437,
    -0.617078,
    -0.00153819,
    0.13926,
    -1.01785,
    -1.57189,
    -0.0914509,
    0.708539,
    -1.57187,
];</code></pre><h3 id="The-AbstractMuJoCoEnvironment-and-AbstractEnvironment-APIs-1"><a class="docs-heading-anchor" href="#The-AbstractMuJoCoEnvironment-and-AbstractEnvironment-APIs-1">The <code>AbstractMuJoCoEnvironment</code> and <code>AbstractEnvironment</code> APIs</a><a class="docs-heading-anchor-permalink" href="#The-AbstractMuJoCoEnvironment-and-AbstractEnvironment-APIs-1" title="Permalink"></a></h3><p>LyceumMuJoCo requires access to the underlying <code>MJSim</code> simulator, thus any LyceumMuJoCo environments need to point to the correct field in the environment struct that is the simulator; in our case there&#39;s only one field: <code>sim</code>.</p><pre><code class="language-julia">LyceumMuJoCo.getsim(env::Humanoid) = env.sim</code></pre><p>Normally we could rely on MuJoCo to reset the model to the default configuration when the model XML is loaded; the humanoid.xml model, however, defaults to a vertical pose. To reset the model to our laying down or supine pose, we can copy in the data from <code>LAYING_QPOS</code> above to <code>d.qpos</code>. Calling <code>forward!</code> here is the same as <code>mj_forward(env.sim.m, env.sim.d)</code>, for a pure MuJoCo reference.</p><pre><code class="language-julia">function LyceumMuJoCo.reset!(env::Humanoid)
    reset!(env.sim)
    env.sim.d.qpos .= LAYING_QPOS
    forward!(env.sim)
    return env
end</code></pre><p>This reward function uses the <code>_getheight</code> helper function above to get the model&#39;s height when the function is called. We also specify a target height of 1.25 and penalize the agent for deviating from the target height. There is also a small penalty for using large control activations; if the coefficient is made larger, the agent may not move at all!</p><pre><code class="language-julia">function LyceumMuJoCo.getreward(state, action, obs, env::Humanoid)
    height = _getheight(statespace(env)(state), env)
    target = 1.25
    reward = 1.0
    if height &lt; target
        reward -= 2.0 * abs(target - height)
    end
    reward -= 1e-3 * norm(action)^2

    return reward
end</code></pre><p>Finally, we can specify an evaluation function. The difference between <code>geteval</code> and <code>getreward</code> is that <code>getreward</code> is the shaped reward our algorithm is optimizing for, while <code>geteval</code> lets us track a useful value for monitoring performance, such as height. Plotting this eval function will show the agent&#39;s height over time and is very useful for reviewing actual desired behavior, regardless of the reward achieved, as it can be used to diagnose reward specification problems.</p><pre><code class="language-julia">function LyceumMuJoCo.geteval(state, action, obs, env::Humanoid)
    return _getheight(statespace(env)(state), env)
end</code></pre><h3 id="Running-Experiments-1"><a class="docs-heading-anchor" href="#Running-Experiments-1">Running Experiments</a><a class="docs-heading-anchor-permalink" href="#Running-Experiments-1" title="Permalink"></a></h3><p>As discussed in the <a href="https://docs.julialang.org/en/v1/manual/performance-tips/">Julia performance tips</a>, globals can hinder performance. To avoid this, we construct the <code>MPPI</code> and <code>ControllerIterator</code> instances within a function. This also lets us easily run our experiment with different choices of parameters (e.g. <code>H</code>). Like most algorithms in <code>LyceumAI</code>, <code>MPPI</code> accepts a &quot;thread-aware&quot; environment constructor as well as any algorithm parameters. In this case, we just pass a closure around the <code>tconstruct</code> function we defined above. <code>MPPI</code>, being a single-step algorithm, is itself not iterable, so we wrap it in a <code>ControllerIterator</code> which simply calls <code>getaction!(action, state, obs, mppi::MPPI)</code> for <code>T</code> timesteps, while simultaneously plotting and logging the trajectory rollout.</p><pre><code class="language-julia">function humanoid_MPPI(etype = Humanoid; T = 200, H = 64, K = 64)
    env = etype()

    # The following parameters work well for this get-up task, and may work for
    # similar tasks, but are not invariant to the model.
    mppi = MPPI(
        env_tconstructor = n -&gt; tconstruct(etype, n),
        covar0 = Diagonal(0.05^2 * I, size(actionspace(env), 1)),
        lambda = 0.4,
        H = H,
        K = K,
        gamma = 1.0,
    )

    iter = ControllerIterator(mppi, env; T = T, plotiter = div(T, 10))

    # We can time the following loop; if it ends up less than the time the
    # MuJoCo models integrated forward in, then one could conceivably run this
    # MPPI MPC controller interactively...
    elapsed = @elapsed for (t, traj) in iter
        # If desired, one can inspect `traj`, `env`, or `mppi` at each timestep.
    end

    if elapsed &lt; time(env)
        @info &quot;We ran in real time!&quot;
    end

    # Save our experiment results to a file for later review.
    savepath = &quot;/tmp/opt_humanoid.jlso&quot;
    exper = Experiment(savepath, overwrite = true)
    exper[:etype] = etype

    for (k, v) in pairs(iter.trajectory)
        exper[k] = v
    end
    finish!(exper)

    return mppi, env, iter.trajectory
end</code></pre><pre><code class="language-none">humanoid_MPPI (generic function with 2 methods)</code></pre><h3 id="Checking-Results-1"><a class="docs-heading-anchor" href="#Checking-Results-1">Checking Results</a><a class="docs-heading-anchor-permalink" href="#Checking-Results-1" title="Permalink"></a></h3><p>The MPPI algorithm, and any that you develop, can and should use plotting tools to track progress as they go.</p><pre><code class="language-">mppi, env, traj = humanoid_MPPI();
plot(
    [traj.rewards traj.evaluations]labels = [&quot;Reward&quot; &quot;Evaluation&quot;],
    title = &quot;Humanoid Standup&quot;,
    legend = :bottomright,
)</code></pre><p>If one wanted to review the results after training, or prepare plots for presentations, one can load the data from disk instead.</p><pre><code class="language-julia">data = JLSO.load(&quot;/tmp/opt_humanoid.jlso&quot;)
plot(
    [data[&quot;rewards&quot;] data[&quot;evaluations&quot;]],
    labels = [&quot;Reward&quot; &quot;Evaluation&quot;],
    title = &quot;Humanoid Standup&quot;,
    legend = :bottomright,
)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip8900">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip8900)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip8901">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip8900)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 62.9921 L86.9921 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip8902">
    <rect x="86" y="62" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  140.376,1521.01 140.376,62.9921 
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  677.44,1521.01 677.44,62.9921 
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1214.5,1521.01 1214.5,62.9921 
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1751.57,1521.01 1751.57,62.9921 
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,62.9921 
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1262.87 2352.76,1262.87 
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,899.88 2352.76,899.88 
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,536.894 2352.76,536.894 
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,173.908 2352.76,173.908 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,62.9921 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  140.376,1521.01 140.376,1503.51 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  677.44,1521.01 677.44,1503.51 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1214.5,1521.01 1214.5,1503.51 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1751.57,1521.01 1751.57,1503.51 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1503.51 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1262.87 114.181,1262.87 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,899.88 114.181,899.88 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,536.894 114.181,536.894 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,173.908 114.181,173.908 
  "/>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 140.376, 1575.01)" x="140.376" y="1575.01">0</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 677.44, 1575.01)" x="677.44" y="1575.01">50</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1214.5, 1575.01)" x="1214.5" y="1575.01">100</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1751.57, 1575.01)" x="1751.57" y="1575.01">150</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">200</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1280.37)" x="62.9921" y="1280.37">-1.0</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 917.38)" x="62.9921" y="917.38">-0.5</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 554.394)" x="62.9921" y="554.394">0.0</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 191.408)" x="62.9921" y="191.408">0.5</text>
</g>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1219.87, 73.2)" x="1219.87" y="73.2">Humanoid Standup</text>
</g>
<polyline clip-path="url(#clip8902)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1479.05 161.859,1479.55 172.6,1479.74 183.341,1478.51 194.083,1476.59 204.824,1473.83 215.565,1467.8 226.306,1460.75 237.048,1452.03 247.789,1438.72 
  258.53,1424.45 269.272,1407.75 280.013,1391.37 290.754,1376.23 301.495,1359.57 312.237,1338.39 322.978,1313.87 333.719,1288.62 344.46,1259.81 355.202,1229.59 
  365.943,1198.59 376.684,1167.87 387.425,1138.4 398.167,1109.96 408.908,1081.48 419.649,1053.19 430.391,1024.98 441.132,999.839 451.873,976.574 462.614,955.571 
  473.356,937.024 484.097,918.045 494.838,897.522 505.579,877.176 516.321,858.615 527.062,841.911 537.803,827.545 548.545,814.798 559.286,804.831 570.027,798.121 
  580.768,790.772 591.51,781.227 602.251,774.805 612.992,770.145 623.733,765.553 634.475,762.329 645.216,760.79 655.957,761.833 666.699,765.015 677.44,769.297 
  688.181,773.97 698.922,780.221 709.664,788.478 720.405,797.729 731.146,808.42 741.887,821.257 752.629,825.785 763.37,825.635 774.111,823.275 784.853,821.096 
  795.594,817.667 806.335,814.448 817.076,811.537 827.818,810.842 838.559,808.981 849.3,806.984 860.041,806.806 870.783,805.515 881.524,804.063 892.265,802.746 
  903.007,800.882 913.748,799.18 924.489,797.008 935.23,794.435 945.972,793.185 956.713,793.525 967.454,795.258 978.195,796.839 988.937,798.108 999.678,798.982 
  1010.42,800.023 1021.16,800.867 1031.9,801.466 1042.64,801.958 1053.38,802.95 1064.13,804.608 1074.87,806.554 1085.61,808.643 1096.35,811.531 1107.09,815.332 
  1117.83,819.534 1128.57,820.498 1139.31,819.661 1150.06,818.811 1160.8,818.28 1171.54,817.647 1182.28,817.687 1193.02,817.637 1203.76,817.5 1214.5,817.312 
  1225.24,815.352 1235.99,814.605 1246.73,815.075 1257.47,816.621 1268.21,818.461 1278.95,819.402 1289.69,819.243 1300.43,818.179 1311.17,815.129 1321.92,814.094 
  1332.66,816.065 1343.4,819.626 1354.14,821.026 1364.88,820.962 1375.62,820.939 1386.36,818.817 1397.1,817.286 1407.85,817.036 1418.59,818.197 1429.33,819.051 
  1440.07,818.165 1450.81,817.519 1461.55,818.085 1472.29,819.234 1483.04,819.284 1493.78,818.97 1504.52,818.357 1515.26,817.897 1526,817.744 1536.74,817.555 
  1547.48,816.601 1558.22,815.201 1568.97,813.825 1579.71,813.943 1590.45,815.92 1601.19,820.015 1611.93,821.663 1622.67,821.399 1633.41,820.837 1644.15,820.202 
  1654.9,818.634 1665.64,817.49 1676.38,815.756 1687.12,815.27 1697.86,816.662 1708.6,818.56 1719.34,818.823 1730.08,818.826 1740.83,818.599 1751.57,818.439 
  1762.31,817.687 1773.05,815.663 1783.79,812.924 1794.53,810.524 1805.27,808.176 1816.01,805.574 1826.76,803.339 1837.5,801.605 1848.24,800.708 1858.98,800.958 
  1869.72,801.368 1880.46,802.117 1891.2,803.29 1901.94,803.73 1912.69,803.582 1923.43,802.948 1934.17,803.266 1944.91,804.643 1955.65,805.806 1966.39,807.033 
  1977.13,809.235 1987.87,813.134 1998.62,817.473 2009.36,821.127 2020.1,821.632 2030.84,821.083 2041.58,819.959 2052.32,817.796 2063.06,815.245 2073.81,813.73 
  2084.55,813.029 2095.29,812.607 2106.03,813.508 2116.77,816.473 2127.51,819.827 2138.25,820.657 2148.99,820.508 2159.74,819.944 2170.48,818.832 2181.22,817.989 
  2191.96,818.741 2202.7,819.099 2213.44,819.385 2224.18,819.003 2234.92,818.004 2245.67,817.889 2256.41,818.396 2267.15,818.382 2277.89,818.311 2288.63,818.414 
  
  "/>
<polyline clip-path="url(#clip8902)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,463.487 161.859,463.737 172.6,463.827 183.341,463.209 194.083,462.225 204.824,460.78 215.565,457.813 226.306,454.265 237.048,449.886 247.789,443.225 
  258.53,436.034 269.272,427.784 280.013,419.6 290.754,411.909 301.495,403.605 312.237,392.997 322.978,380.828 333.719,368.117 344.46,353.748 355.202,338.654 
  365.943,323.173 376.684,307.737 387.425,293.058 398.167,278.772 408.908,264.613 419.649,250.43 430.391,236.262 441.132,223.804 451.873,212.129 462.614,201.561 
  473.356,192.266 484.097,182.901 494.838,172.581 505.579,162.393 516.321,153.22 527.062,144.819 537.803,137.588 548.545,131.202 559.286,126.244 570.027,122.846 
  580.768,119.183 591.51,114.382 602.251,111.278 612.992,108.901 623.733,106.622 634.475,105.017 645.216,104.257 655.957,104.821 666.699,106.295 677.44,108.398 
  688.181,110.801 698.922,113.919 709.664,118.059 720.405,122.696 731.146,128.048 741.887,134.443 752.629,136.726 763.37,136.627 774.111,135.54 784.853,134.34 
  795.594,132.735 806.335,131.051 817.076,129.638 827.818,129.231 838.559,128.375 849.3,127.366 860.041,127.247 870.783,126.618 881.524,125.934 892.265,125.244 
  903.007,124.298 913.748,123.488 924.489,122.425 935.23,121.133 945.972,120.491 956.713,120.689 967.454,121.557 978.195,122.355 988.937,122.965 999.678,123.436 
  1010.42,123.944 1021.16,124.359 1031.9,124.669 1042.64,124.889 1053.38,125.418 1064.13,126.248 1074.87,127.22 1085.61,128.252 1096.35,129.693 1107.09,131.599 
  1117.83,133.679 1128.57,134.185 1139.31,133.764 1150.06,133.355 1160.8,133.053 1171.54,132.748 1182.28,132.782 1193.02,132.752 1203.76,132.7 1214.5,132.58 
  1225.24,131.626 1235.99,131.24 1246.73,131.477 1257.47,132.251 1268.21,133.167 1278.95,133.643 1289.69,133.538 1300.43,132.997 1311.17,131.504 1321.92,130.974 
  1332.66,131.962 1343.4,133.766 1354.14,134.458 1364.88,134.412 1375.62,134.4 1386.36,133.326 1397.1,132.563 1407.85,132.468 1418.59,133.02 1429.33,133.441 
  1440.07,133.011 1450.81,132.685 1461.55,132.963 1472.29,133.552 1483.04,133.58 1493.78,133.424 1504.52,133.11 1515.26,132.88 1526,132.813 1536.74,132.713 
  1547.48,132.234 1558.22,131.525 1568.97,130.848 1579.71,130.893 1590.45,131.876 1601.19,133.939 1611.93,134.754 1622.67,134.619 1633.41,134.366 1644.15,134.039 
  1654.9,133.253 1665.64,132.694 1676.38,131.815 1687.12,131.568 1697.86,132.266 1708.6,133.201 1719.34,133.343 1730.08,133.33 1740.83,133.246 1751.57,133.138 
  1762.31,132.769 1773.05,131.744 1783.79,130.401 1794.53,129.191 1805.27,128.015 1816.01,126.733 1826.76,125.605 1837.5,124.732 1848.24,124.289 1858.98,124.414 
  1869.72,124.621 1880.46,125.008 1891.2,125.583 1901.94,125.794 1912.69,125.718 1923.43,125.409 1934.17,125.565 1944.91,126.25 1955.65,126.849 1966.39,127.445 
  1977.13,128.538 1987.87,130.497 1998.62,132.677 2009.36,134.491 2020.1,134.753 2030.84,134.453 2041.58,133.897 2052.32,132.84 2063.06,131.542 2073.81,130.771 
  2084.55,130.442 2095.29,130.244 2106.03,130.7 2116.77,132.168 2127.51,133.849 2138.25,134.266 2148.99,134.193 2159.74,133.895 2170.48,133.314 2181.22,132.932 
  2191.96,133.307 2202.7,133.485 2213.44,133.635 2224.18,133.429 2234.92,132.954 2245.67,132.881 2256.41,133.139 2267.15,133.131 2277.89,133.093 2288.63,133.137 
  
  "/>
<path clip-path="url(#clip8900)" d="
M1816.02 1377.01 L2280.76 1377.01 L2280.76 1195.57 L1816.02 1195.57  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip8900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1816.02,1377.01 2280.76,1377.01 2280.76,1195.57 1816.02,1195.57 1816.02,1377.01 
  "/>
<polyline clip-path="url(#clip8900)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1840.02,1256.05 1984.02,1256.05 
  "/>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2008.02, 1273.55)" x="2008.02" y="1273.55">Reward</text>
</g>
<polyline clip-path="url(#clip8900)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1840.02,1316.53 1984.02,1316.53 
  "/>
<g clip-path="url(#clip8900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2008.02, 1334.03)" x="2008.02" y="1334.03">Evaluation</text>
</g>
</svg>
<hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../NPG/">Learning a control policy »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 15 January 2020 02:31">Wednesday 15 January 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
